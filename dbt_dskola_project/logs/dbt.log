[0m02:43:04.914433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A49B1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7422EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A7422AC0>]}


============================== 02:43:04.914433 | 5c896403-307d-468c-b596-81d2fcfa72b0 ==============================
[0m02:43:04.914433 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:43:04.914433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:43:04.947920 [info ] [MainThread]: dbt version: 1.8.2
[0m02:43:04.948922 [info ] [MainThread]: python version: 3.9.0
[0m02:43:04.949922 [info ] [MainThread]: python path: c:\users\acer\appdata\local\programs\python\python39\python.exe
[0m02:43:04.950932 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m02:43:05.011179 [info ] [MainThread]: Using profiles dir at ./
[0m02:43:05.011179 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m02:43:05.011179 [info ] [MainThread]: Using dbt_project.yml file at dbt_dskola_project\dbt_project.yml
[0m02:43:05.026143 [info ] [MainThread]: adapter type: postgres
[0m02:43:05.027161 [info ] [MainThread]: adapter version: 1.8.1
[0m02:43:05.033277 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:05.034277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c896403-307d-468c-b596-81d2fcfa72b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A490C970>]}
[0m02:43:05.035787 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:05.037795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c896403-307d-468c-b596-81d2fcfa72b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A490C8E0>]}
[0m02:43:05.114733 [info ] [MainThread]: Configuration:
[0m02:43:05.114733 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:43:05.114733 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:43:05.126351 [info ] [MainThread]: Required dependencies:
[0m02:43:05.126351 [debug] [MainThread]: Executing "git --help"
[0m02:43:05.175774 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:43:05.175774 [debug] [MainThread]: STDERR: "b''"
[0m02:43:05.176804 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:43:05.177785 [info ] [MainThread]: Connection:
[0m02:43:05.177785 [info ] [MainThread]:   host: localhost
[0m02:43:05.178779 [info ] [MainThread]:   port: 5432
[0m02:43:05.178779 [info ] [MainThread]:   user: postgres
[0m02:43:05.179786 [info ] [MainThread]:   database: db_project_2
[0m02:43:05.179786 [info ] [MainThread]:   schema: public
[0m02:43:05.179786 [info ] [MainThread]:   connect_timeout: 10
[0m02:43:05.179786 [info ] [MainThread]:   role: None
[0m02:43:05.181290 [info ] [MainThread]:   search_path: None
[0m02:43:05.181290 [info ] [MainThread]:   keepalives_idle: 0
[0m02:43:05.182301 [info ] [MainThread]:   sslmode: None
[0m02:43:05.182301 [info ] [MainThread]:   sslcert: None
[0m02:43:05.182301 [info ] [MainThread]:   sslkey: None
[0m02:43:05.183295 [info ] [MainThread]:   sslrootcert: None
[0m02:43:05.183295 [info ] [MainThread]:   application_name: dbt
[0m02:43:05.184085 [info ] [MainThread]:   retries: 1
[0m02:43:05.185090 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:43:05.185090 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:43:05.257272 [debug] [MainThread]: Using postgres connection "debug"
[0m02:43:05.257272 [debug] [MainThread]: On debug: select 1 as id
[0m02:43:05.257272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:05.289072 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:43:05.289072 [debug] [MainThread]: On debug: Close
[0m02:43:05.304720 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:43:05.304720 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:43:05.304720 [debug] [MainThread]: Command `dbt debug` succeeded at 02:43:05.304720 after 0.45 seconds
[0m02:43:05.304720 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:43:05.304720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A49B1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A6985A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0A740C340>]}
[0m02:43:05.309309 [debug] [MainThread]: Flushing usage events
[0m02:43:11.940153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E8220ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84C52CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84C523A0>]}


============================== 02:43:11.940153 | 282eb460-328e-4267-b7fd-09ceda285d21 ==============================
[0m02:43:11.940153 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:43:11.940153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:43:12.007553 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:12.008533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '282eb460-328e-4267-b7fd-09ceda285d21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E820D31C0>]}
[0m02:43:12.009539 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:12.009539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '282eb460-328e-4267-b7fd-09ceda285d21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E820D31F0>]}
[0m02:43:12.157762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '282eb460-328e-4267-b7fd-09ceda285d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E82B7A850>]}
[0m02:43:12.193499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '282eb460-328e-4267-b7fd-09ceda285d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84B2B070>]}
[0m02:43:12.209136 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:43:12.220097 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:43:12.315569 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:43:12.315569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '282eb460-328e-4267-b7fd-09ceda285d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E84C1E910>]}
[0m02:43:13.236951 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.stg_orders' (models\warehouse\stg_orders.sql) depends on a source named 'csv.orders' which was not found
[0m02:43:13.238694 [debug] [MainThread]: Command `dbt run` failed at 02:43:13.238694 after 1.34 seconds
[0m02:43:13.238694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E8220ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E850ABD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E82097AC0>]}
[0m02:43:13.239692 [debug] [MainThread]: Flushing usage events
[0m02:43:55.662272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D094801C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09729CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09729CD60>]}


============================== 02:43:55.665848 | d44e3600-4cb9-4f6e-8253-9e95e114cd87 ==============================
[0m02:43:55.665848 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:43:55.666964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:43:55.725849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:55.725849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0946D3160>]}
[0m02:43:55.725849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:43:55.731404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0946D3190>]}
[0m02:43:55.837236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0946C7490>]}
[0m02:43:55.885011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0967F9670>]}
[0m02:43:55.885011 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:43:55.894812 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:43:55.975862 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:43:55.976856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0972721C0>]}
[0m02:43:56.869224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m02:43:56.883216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0979D7130>]}
[0m02:43:56.977740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0979FE0D0>]}
[0m02:43:56.977740 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m02:43:56.979251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0979B3430>]}
[0m02:43:56.980265 [info ] [MainThread]: 
[0m02:43:56.981242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:43:56.986272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m02:43:57.043796 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m02:43:57.044798 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m02:43:57.044798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:57.080949 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:43:57.082954 [debug] [ThreadPool]: On list_db_project_2: Close
[0m02:43:57.083962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m02:43:57.089457 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:43:57.090462 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m02:43:57.090462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:43:57.120253 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.121278 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:43:57.121278 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:43:57.128260 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m02:43:57.128597 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m02:43:57.128597 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m02:43:57.128597 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.128597 [debug] [MainThread]: On master: BEGIN
[0m02:43:57.128597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:43:57.167915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.168914 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.168914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:43:57.176906 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:43:57.177936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0978681C0>]}
[0m02:43:57.178930 [debug] [MainThread]: On master: ROLLBACK
[0m02:43:57.179407 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.179407 [debug] [MainThread]: On master: BEGIN
[0m02:43:57.180202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.180202 [debug] [MainThread]: On master: COMMIT
[0m02:43:57.180202 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.181231 [debug] [MainThread]: On master: COMMIT
[0m02:43:57.181583 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.181583 [debug] [MainThread]: On master: Close
[0m02:43:57.181583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:43:57.182588 [info ] [MainThread]: 
[0m02:43:57.186107 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m02:43:57.187110 [info ] [Thread-1  ]: 1 of 7 START sql table model public.stg_employees .............................. [RUN]
[0m02:43:57.188110 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m02:43:57.188110 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m02:43:57.195109 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m02:43:57.196111 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m02:43:57.235702 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m02:43:57.237627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:43:57.237627 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m02:43:57.238633 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:43:57.263674 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.263674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:43:57.263674 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m02:43:57.263674 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m02:43:57.263674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:43:57.279415 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m02:43:57.279415 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:57.295480 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:43:57.295480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:43:57.295480 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:43:57.295480 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.295480 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m02:43:57.295480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:43:57.295480 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m02:43:57.295480 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:57.295480 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m02:43:57.311151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097E2C610>]}
[0m02:43:57.311151 [info ] [Thread-1  ]: 1 of 7 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.11s]
[0m02:43:57.311151 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m02:43:57.311151 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m02:43:57.314995 [info ] [Thread-1  ]: 2 of 7 START sql table model public.stg_order_details .......................... [RUN]
[0m02:43:57.316003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m02:43:57.316003 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m02:43:57.319007 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.320024 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m02:43:57.324025 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.325000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.325000 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m02:43:57.326008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.361317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.361317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.361317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m02:43:57.367340 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m02:43:57.370316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.370316 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m02:43:57.371423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:57.371423 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:43:57.371423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.371423 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:43:57.371423 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.371423 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m02:43:57.371423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:43:57.371423 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m02:43:57.371423 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:57.371423 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m02:43:57.371423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097F8DC40>]}
[0m02:43:57.371423 [info ] [Thread-1  ]: 2 of 7 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.06s]
[0m02:43:57.371423 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m02:43:57.371423 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m02:43:57.384373 [info ] [Thread-1  ]: 3 of 7 START sql table model public.stg_orders ................................. [RUN]
[0m02:43:57.385227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m02:43:57.386214 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m02:43:57.389212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m02:43:57.390212 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m02:43:57.393212 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m02:43:57.395721 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:43:57.395721 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m02:43:57.396722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.434729 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.434729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:43:57.434729 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m02:43:57.444195 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m02:43:57.447196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:43:57.448265 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:43:57.448265 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:57.448265 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:43:57.448265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:43:57.448265 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:43:57.448265 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.448265 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m02:43:57.455795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:43:57.455795 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m02:43:57.455795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:57.455795 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m02:43:57.455795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097F95250>]}
[0m02:43:57.455795 [info ] [Thread-1  ]: 3 of 7 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m02:43:57.455795 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m02:43:57.455795 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m02:43:57.455795 [info ] [Thread-1  ]: 4 of 7 START sql table model public.stg_products ............................... [RUN]
[0m02:43:57.462995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m02:43:57.462995 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m02:43:57.466001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m02:43:57.467022 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m02:43:57.471007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m02:43:57.472008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:43:57.472008 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m02:43:57.472008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.508549 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.509547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:43:57.509547 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m02:43:57.516538 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m02:43:57.520524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:43:57.521501 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m02:43:57.522502 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:57.523522 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:43:57.524502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:43:57.524502 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:43:57.525592 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.528517 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m02:43:57.529519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:43:57.529519 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m02:43:57.530493 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:57.531494 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m02:43:57.532494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097FE4C40>]}
[0m02:43:57.532494 [info ] [Thread-1  ]: 4 of 7 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m02:43:57.533494 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m02:43:57.534494 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m02:43:57.534494 [info ] [Thread-1  ]: 5 of 7 START sql table model public.stg_suppliers .............................. [RUN]
[0m02:43:57.536000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m02:43:57.536000 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m02:43:57.539007 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.540006 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m02:43:57.544683 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.545690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.545690 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m02:43:57.546708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.679178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.679178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.679178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m02:43:57.679178 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m02:43:57.689183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.689183 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m02:43:57.689183 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:43:57.689183 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:43:57.689183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.689183 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:43:57.694689 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.694689 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m02:43:57.694689 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:43:57.694689 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m02:43:57.694689 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:43:57.694689 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m02:43:57.694689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097FEB1C0>]}
[0m02:43:57.694689 [info ] [Thread-1  ]: 5 of 7 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.16s]
[0m02:43:57.694689 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m02:43:57.703498 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:43:57.704506 [info ] [Thread-1  ]: 6 of 7 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m02:43:57.705508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m02:43:57.705508 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:43:57.708518 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:43:57.709518 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:43:57.715517 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:43:57.717518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:43:57.717518 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m02:43:57.718517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.751714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.752730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:43:57.752730 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, month
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m02:43:57.755795 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:43:57.755795 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m02:43:57.755795 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m02:43:57.755795 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:43:57.755795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097F9F0D0>]}
[0m02:43:57.755795 [error] [Thread-1  ]: 6 of 7 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.05s]
[0m02:43:57.755795 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:43:57.755795 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:43:57.769810 [info ] [Thread-1  ]: 7 of 7 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m02:43:57.770670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m02:43:57.770670 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:43:57.774682 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:43:57.775682 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:43:57.780196 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:43:57.781201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:43:57.781201 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m02:43:57.781201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:43:57.817229 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.818237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:43:57.818237 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        date_trunc('month', o.order_date) as month,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, month
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m02:43:57.820243 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:43:57.820243 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m02:43:57.821225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m02:43:57.822208 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:43:57.822208 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44e3600-4cb9-4f6e-8253-9e95e114cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097FEB1C0>]}
[0m02:43:57.823201 [error] [Thread-1  ]: 7 of 7 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.05s]
[0m02:43:57.824202 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:43:57.825202 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.826202 [debug] [MainThread]: On master: BEGIN
[0m02:43:57.826202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:43:57.858894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:43:57.859501 [debug] [MainThread]: On master: COMMIT
[0m02:43:57.860033 [debug] [MainThread]: Using postgres connection "master"
[0m02:43:57.860033 [debug] [MainThread]: On master: COMMIT
[0m02:43:57.860888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:43:57.861391 [debug] [MainThread]: On master: Close
[0m02:43:57.861965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:43:57.861965 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m02:43:57.862469 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m02:43:57.862469 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_category_sold' was properly closed.
[0m02:43:57.863001 [info ] [MainThread]: 
[0m02:43:57.863549 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m02:43:57.865635 [debug] [MainThread]: Command end result
[0m02:43:57.936028 [info ] [MainThread]: 
[0m02:43:57.946039 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:43:57.946039 [info ] [MainThread]: 
[0m02:43:57.947939 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:43:57.948943 [info ] [MainThread]: 
[0m02:43:57.949946 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:43:57.950944 [info ] [MainThread]: 
[0m02:43:57.951959 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m02:43:57.952954 [debug] [MainThread]: Command `dbt run` failed at 02:43:57.952954 after 2.33 seconds
[0m02:43:57.953958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D094801C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0979FB4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097E7F880>]}
[0m02:43:57.953958 [debug] [MainThread]: Flushing usage events
[0m02:45:23.041878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1161C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA3BFBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA3BFBD60>]}


============================== 02:45:23.041878 | 4707b40e-f5ab-47dd-9b44-0177d00038c9 ==============================
[0m02:45:23.041878 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:45:23.041878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m02:45:23.109855 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:45:23.109855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1033160>]}
[0m02:45:23.109855 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:45:23.112220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1033190>]}
[0m02:45:23.217396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1027490>]}
[0m02:45:23.249122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA315B670>]}
[0m02:45:23.249122 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:45:23.268449 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:45:23.403361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:45:23.403361 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:45:23.576527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m02:45:23.593004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA42E7130>]}
[0m02:45:23.667028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA42B8400>]}
[0m02:45:23.667028 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m02:45:23.667028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA42E7730>]}
[0m02:45:23.684175 [info ] [MainThread]: 
[0m02:45:23.685188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:45:23.689203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m02:45:23.740082 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m02:45:23.740082 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m02:45:23.740082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:23.780863 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:45:23.780863 [debug] [ThreadPool]: On list_db_project_2: Close
[0m02:45:23.780863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m02:45:23.787455 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:45:23.787455 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m02:45:23.787455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:45:23.821641 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:45:23.822727 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:45:23.823026 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:45:23.826561 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m02:45:23.827563 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m02:45:23.829100 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m02:45:23.833431 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:23.833431 [debug] [MainThread]: On master: BEGIN
[0m02:45:23.833431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:45:23.861759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:23.861759 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:23.861759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:45:23.861759 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:45:23.861759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA43BA730>]}
[0m02:45:23.861759 [debug] [MainThread]: On master: ROLLBACK
[0m02:45:23.861759 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:23.861759 [debug] [MainThread]: On master: BEGIN
[0m02:45:23.861759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:23.876897 [debug] [MainThread]: On master: COMMIT
[0m02:45:23.876897 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:23.876897 [debug] [MainThread]: On master: COMMIT
[0m02:45:23.876897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:23.876897 [debug] [MainThread]: On master: Close
[0m02:45:23.876897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:45:23.876897 [info ] [MainThread]: 
[0m02:45:23.882572 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m02:45:23.883579 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m02:45:23.884245 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m02:45:23.884245 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m02:45:23.892287 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m02:45:23.893287 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m02:45:23.928320 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m02:45:23.929319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:23.930319 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m02:45:23.930319 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:45:23.950457 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:23.950457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:23.950457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m02:45:23.966088 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m02:45:23.966088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:23.966088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m02:45:23.966088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:23.966088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:23.966088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m02:45:23.966088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.030153 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:45:24.030153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:24.030153 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:45:24.033706 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.033706 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m02:45:24.039814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:45:24.039814 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m02:45:24.045324 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:24.045324 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m02:45:24.045324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA15286D0>]}
[0m02:45:24.045324 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.16s]
[0m02:45:24.045324 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m02:45:24.045324 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m02:45:24.055086 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m02:45:24.056101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m02:45:24.056101 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m02:45:24.059099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.060097 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m02:45:24.064099 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.065100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.066100 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m02:45:24.066100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.215177 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.215177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.215177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m02:45:24.215177 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m02:45:24.215177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.215177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m02:45:24.215177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.215177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.215177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m02:45:24.215177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.230807 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:45:24.230807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.230807 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:45:24.233841 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.233841 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m02:45:24.233841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:45:24.233841 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m02:45:24.233841 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:24.241366 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m02:45:24.241366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1091610>]}
[0m02:45:24.241366 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.19s]
[0m02:45:24.241366 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m02:45:24.241366 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m02:45:24.245867 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m02:45:24.246879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m02:45:24.247873 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m02:45:24.251897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m02:45:24.251897 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m02:45:24.256897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m02:45:24.257901 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.258880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m02:45:24.258880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.296415 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.296415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.297407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m02:45:24.305397 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m02:45:24.308430 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.309421 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m02:45:24.310402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.310402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.310402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:45:24.310402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.310402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:45:24.310402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.310402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:45:24.310402 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.310402 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m02:45:24.310402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:45:24.310402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m02:45:24.310402 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:24.310402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m02:45:24.310402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA48399D0>]}
[0m02:45:24.326055 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.06s]
[0m02:45:24.326055 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m02:45:24.326055 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m02:45:24.328983 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m02:45:24.329997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m02:45:24.329997 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m02:45:24.333016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m02:45:24.334012 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m02:45:24.338611 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m02:45:24.339612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.340613 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m02:45:24.340613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.375324 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.376338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.376338 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m02:45:24.381965 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m02:45:24.385487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.385487 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m02:45:24.385487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.385487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.385487 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m02:45:24.385487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.385487 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:45:24.385487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.385487 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:45:24.385487 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.385487 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m02:45:24.385487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:45:24.385487 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m02:45:24.385487 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:24.401302 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m02:45:24.401808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA478BB50>]}
[0m02:45:24.401808 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m02:45:24.401808 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m02:45:24.401808 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m02:45:24.404941 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m02:45:24.405969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m02:45:24.405969 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m02:45:24.409970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.409970 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m02:45:24.413948 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.414959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.415954 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m02:45:24.415954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.452378 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.453413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.453413 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m02:45:24.459388 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m02:45:24.463406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.464016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m02:45:24.464016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.464016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.464016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m02:45:24.464016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:45:24.464016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:45:24.464016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.464016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:45:24.464016 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.464016 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m02:45:24.464016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:45:24.464016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m02:45:24.479672 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:45:24.480178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m02:45:24.480178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA4729FA0>]}
[0m02:45:24.480178 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m02:45:24.480178 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m02:45:24.480178 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:45:24.483881 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m02:45:24.484899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m02:45:24.485886 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:45:24.488917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:45:24.489923 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:45:24.493438 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:45:24.495480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:45:24.495480 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m02:45:24.496439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.530402 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.531429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:45:24.531429 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, month
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m02:45:24.531429 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:45:24.531429 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m02:45:24.533983 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m02:45:24.533983 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:45:24.537018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA414E8E0>]}
[0m02:45:24.537018 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.05s]
[0m02:45:24.537018 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:45:24.537018 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:45:24.539549 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m02:45:24.540567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m02:45:24.540567 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:45:24.543568 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:45:24.544567 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:45:24.548567 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:45:24.549569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:45:24.550575 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m02:45:24.550575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.585780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.586782 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:45:24.587780 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        date_trunc('month', o.order_date) as month,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, month
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m02:45:24.588780 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:45:24.588780 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m02:45:24.589636 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m02:45:24.590643 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:45:24.590643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1AA82E0>]}
[0m02:45:24.591642 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.05s]
[0m02:45:24.592648 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:45:24.592648 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:45:24.593708 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m02:45:24.594714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m02:45:24.594714 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:45:24.597716 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:45:24.598713 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:45:24.602712 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:45:24.604722 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:45:24.605715 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m02:45:24.605715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:45:24.760101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.760101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:45:24.760101 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, month
)
select * from supplier_revenue
  );
  
[0m02:45:24.760101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:45:24.760101 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m02:45:24.760101 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m02:45:24.760101 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:45:24.760101 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4707b40e-f5ab-47dd-9b44-0177d00038c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA000AD90>]}
[0m02:45:24.760101 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.17s]
[0m02:45:24.760101 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:45:24.768145 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:24.769162 [debug] [MainThread]: On master: BEGIN
[0m02:45:24.769162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:45:24.801924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:45:24.802925 [debug] [MainThread]: On master: COMMIT
[0m02:45:24.802925 [debug] [MainThread]: Using postgres connection "master"
[0m02:45:24.802925 [debug] [MainThread]: On master: COMMIT
[0m02:45:24.803950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:45:24.803950 [debug] [MainThread]: On master: Close
[0m02:45:24.803950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:45:24.804935 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m02:45:24.804935 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m02:45:24.804935 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m02:45:24.805953 [info ] [MainThread]: 
[0m02:45:24.806916 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m02:45:24.808916 [debug] [MainThread]: Command end result
[0m02:45:24.837225 [info ] [MainThread]: 
[0m02:45:24.839230 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:45:24.840226 [info ] [MainThread]: 
[0m02:45:24.841236 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:45:24.842225 [info ] [MainThread]: 
[0m02:45:24.843232 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:45:24.844229 [info ] [MainThread]: 
[0m02:45:24.845238 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:45:24.846238 [info ] [MainThread]: 
[0m02:45:24.847240 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m02:45:24.849238 [debug] [MainThread]: Command `dbt run` failed at 02:45:24.848236 after 1.84 seconds
[0m02:45:24.849238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA1161C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA166AF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DA4306730>]}
[0m02:45:24.850237 [debug] [MainThread]: Flushing usage events
[0m02:46:30.487463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B319C51C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31C6EBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31C6EBC40>]}


============================== 02:46:30.487463 | 5436dc9b-b4bc-4abd-be32-7a566c9fb141 ==============================
[0m02:46:30.487463 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:46:30.487463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:46:30.544953 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:46:30.544953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5436dc9b-b4bc-4abd-be32-7a566c9fb141', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B319B23160>]}
[0m02:46:30.544953 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:46:30.554883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5436dc9b-b4bc-4abd-be32-7a566c9fb141', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B319B23190>]}
[0m02:46:30.662432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5436dc9b-b4bc-4abd-be32-7a566c9fb141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31C6AD5E0>]}
[0m02:46:30.694777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5436dc9b-b4bc-4abd-be32-7a566c9fb141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31C6B8040>]}
[0m02:46:30.694777 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:46:30.714976 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:46:30.866744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m02:46:30.867720 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m02:46:30.867720 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:46:30.868719 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m02:46:31.008627 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.datamart_monthly_best_employee' (models\marts\datamart_monthly_best_employee.sql) depends on a node named 'orders' which was not found
[0m02:46:31.010280 [debug] [MainThread]: Command `dbt run` failed at 02:46:31.010280 after 0.56 seconds
[0m02:46:31.010280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B319C51C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31CC484C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B31CA73610>]}
[0m02:46:31.010280 [debug] [MainThread]: Flushing usage events
[0m02:47:38.555380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C84ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F2B8A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02D1CA790>]}


============================== 02:47:38.559373 | fa7e6218-837e-46c3-9674-76265c15b4dc ==============================
[0m02:47:38.559373 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:47:38.560055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:47:38.625636 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:47:38.626636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C723190>]}
[0m02:47:38.627636 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:47:38.627636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C7231C0>]}
[0m02:47:38.755000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F2A3D90>]}
[0m02:47:38.812619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C7378E0>]}
[0m02:47:38.814618 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:47:38.824621 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:47:38.957604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:47:38.957604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:47:38.962613 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m02:47:38.996817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F86C130>]}
[0m02:47:39.091727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F8867F0>]}
[0m02:47:39.092727 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m02:47:39.093727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F86A5E0>]}
[0m02:47:39.094727 [info ] [MainThread]: 
[0m02:47:39.095734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:47:39.099726 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m02:47:39.144041 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m02:47:39.144041 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m02:47:39.144041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:39.194633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:47:39.195505 [debug] [ThreadPool]: On list_db_project_2: Close
[0m02:47:39.195505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m02:47:39.195505 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:47:39.195505 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m02:47:39.195505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:39.237508 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.237508 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:47:39.238508 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:47:39.243777 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m02:47:39.245786 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m02:47:39.246352 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m02:47:39.252703 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.253303 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.253303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:39.282716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.282716 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.282716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:39.296202 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:47:39.297204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F2AC4C0>]}
[0m02:47:39.297204 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:39.298212 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.298212 [debug] [MainThread]: On master: BEGIN
[0m02:47:39.299203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.299203 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.299203 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:39.300213 [debug] [MainThread]: On master: COMMIT
[0m02:47:39.300213 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.300213 [debug] [MainThread]: On master: Close
[0m02:47:39.301203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:39.301986 [info ] [MainThread]: 
[0m02:47:39.302889 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m02:47:39.302889 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m02:47:39.302889 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m02:47:39.302889 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m02:47:39.314921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m02:47:39.315910 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m02:47:39.355650 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m02:47:39.356661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.357658 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m02:47:39.357658 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:47:39.490418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.491414 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.491414 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m02:47:39.498223 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m02:47:39.505226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.505226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m02:47:39.506215 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.509227 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.509227 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m02:47:39.510216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.527227 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:47:39.527227 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.527227 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:47:39.529397 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.534402 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m02:47:39.538402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:47:39.539403 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m02:47:39.542798 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.544815 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m02:47:39.546391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02CC18700>]}
[0m02:47:39.547396 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.24s]
[0m02:47:39.548403 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m02:47:39.548403 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m02:47:39.549404 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m02:47:39.550418 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m02:47:39.550418 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m02:47:39.553418 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.553418 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m02:47:39.557420 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.558418 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.559417 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m02:47:39.559417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:39.592994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.594018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.594018 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m02:47:39.601035 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m02:47:39.604040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.605036 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m02:47:39.605036 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.608047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.608047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m02:47:39.608047 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.608047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:47:39.608047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.608047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:47:39.608047 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.608047 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m02:47:39.608047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:47:39.608047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m02:47:39.608047 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.608047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m02:47:39.608047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C7232B0>]}
[0m02:47:39.608047 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.06s]
[0m02:47:39.608047 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m02:47:39.608047 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m02:47:39.623370 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m02:47:39.624147 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m02:47:39.624147 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m02:47:39.627184 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m02:47:39.628244 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m02:47:39.631282 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m02:47:39.632283 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.632283 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m02:47:39.633802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:39.667364 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.667364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.668381 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m02:47:39.675429 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m02:47:39.678527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.678527 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m02:47:39.678527 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.680555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.680555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:47:39.680555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.680555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:47:39.680555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.680555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:47:39.680555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.726184 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m02:47:39.726184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:47:39.726184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m02:47:39.726184 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.726184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m02:47:39.726184 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02CC18700>]}
[0m02:47:39.726184 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.10s]
[0m02:47:39.736190 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m02:47:39.736190 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m02:47:39.736190 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m02:47:39.738193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m02:47:39.739201 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m02:47:39.742206 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m02:47:39.743222 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m02:47:39.746386 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m02:47:39.747398 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.748399 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m02:47:39.748399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:39.783076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.784073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.784073 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m02:47:39.791316 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m02:47:39.795314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.795314 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m02:47:39.796313 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.798336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.799314 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m02:47:39.799816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.800845 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:47:39.801898 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.801898 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:47:39.801898 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.801898 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m02:47:39.801898 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:47:39.801898 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m02:47:39.801898 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.801898 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m02:47:39.801898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FE63D00>]}
[0m02:47:39.801898 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.06s]
[0m02:47:39.801898 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m02:47:39.801898 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m02:47:39.813765 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m02:47:39.814781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m02:47:39.815771 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m02:47:39.818802 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.819776 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m02:47:39.824770 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.825777 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.825777 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m02:47:39.826796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:39.862053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.862053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.863056 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m02:47:39.869192 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m02:47:39.872218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.872218 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m02:47:39.873219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.876213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.876213 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m02:47:39.877213 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:47:39.878185 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:47:39.879212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.879301 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:47:39.879301 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:47:39.879301 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m02:47:39.879301 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:47:39.879301 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m02:47:39.885806 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:47:39.885806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m02:47:39.885806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FCD8220>]}
[0m02:47:39.885806 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m02:47:39.885806 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m02:47:39.885806 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:47:39.890464 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m02:47:39.891470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m02:47:39.892492 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:47:39.895498 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:47:39.896494 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:47:39.900471 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:47:39.901470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:47:39.902475 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m02:47:39.902475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:39.939773 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:39.940773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:47:39.940773 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, month
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m02:47:39.941773 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:47:39.942776 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m02:47:39.943773 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m02:47:39.946774 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:47:39.946774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02F924370>]}
[0m02:47:39.947773 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.06s]
[0m02:47:39.948775 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:47:39.948775 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:47:39.949773 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m02:47:39.950785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m02:47:39.950785 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:47:39.954626 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:47:39.954736 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:47:39.960447 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:47:39.961448 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:47:39.962451 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m02:47:39.962451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:40.002574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:40.002574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:47:40.002574 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        date_trunc('month', o.order_date) as month,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, month
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m02:47:40.004566 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:47:40.004566 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m02:47:40.005568 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m02:47:40.006572 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:47:40.007574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FE0A910>]}
[0m02:47:40.007574 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.06s]
[0m02:47:40.008574 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:47:40.009568 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:47:40.010193 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m02:47:40.011201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m02:47:40.011201 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:47:40.015205 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:47:40.016198 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:47:40.020207 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:47:40.021208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:47:40.022198 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m02:47:40.022198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:40.061201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:47:40.061201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:47:40.062199 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, month
)
select * from supplier_revenue
  );
  
[0m02:47:40.063201 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:47:40.063201 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m02:47:40.064200 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m02:47:40.065199 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:47:40.065199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa7e6218-837e-46c3-9674-76265c15b4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FDB38E0>]}
[0m02:47:40.066295 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.06s]
[0m02:47:40.066295 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:47:40.068183 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:40.068183 [debug] [MainThread]: On master: BEGIN
[0m02:47:40.069426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:40.100672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:40.101700 [debug] [MainThread]: On master: COMMIT
[0m02:47:40.101700 [debug] [MainThread]: Using postgres connection "master"
[0m02:47:40.101700 [debug] [MainThread]: On master: COMMIT
[0m02:47:40.102682 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:40.102682 [debug] [MainThread]: On master: Close
[0m02:47:40.103683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:40.103683 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m02:47:40.103683 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m02:47:40.104696 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m02:47:40.104696 [info ] [MainThread]: 
[0m02:47:40.105681 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m02:47:40.106688 [debug] [MainThread]: Command end result
[0m02:47:40.136195 [info ] [MainThread]: 
[0m02:47:40.137277 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:47:40.138206 [info ] [MainThread]: 
[0m02:47:40.139208 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  column o.order_id does not exist
  LINE 19: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:47:40.141194 [info ] [MainThread]: 
[0m02:47:40.141194 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:47:40.143195 [info ] [MainThread]: 
[0m02:47:40.144207 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:47:40.145194 [info ] [MainThread]: 
[0m02:47:40.145194 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m02:47:40.146204 [debug] [MainThread]: Command `dbt run` failed at 02:47:40.146204 after 1.64 seconds
[0m02:47:40.147207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02C84ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FDF9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E02FDF9550>]}
[0m02:47:40.147207 [debug] [MainThread]: Flushing usage events
[0m02:56:04.704240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CDB2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F84BD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F84BCD0>]}


============================== 02:56:04.707348 | da5df9ed-375d-404a-82e4-3c0026fa8bcf ==============================
[0m02:56:04.707348 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:56:04.708331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:56:04.766635 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:56:04.766635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CC83190>]}
[0m02:56:04.766635 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:56:04.769968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CC831C0>]}
[0m02:56:04.884157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CC47A90>]}
[0m02:56:04.930273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F801BB0>]}
[0m02:56:04.932281 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:56:04.939865 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:56:05.079273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:56:05.079273 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m02:56:05.079273 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m02:56:05.259803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m02:56:05.288140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FF39F10>]}
[0m02:56:05.392800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FF0A4F0>]}
[0m02:56:05.392800 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m02:56:05.393812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FBAD670>]}
[0m02:56:05.395805 [info ] [MainThread]: 
[0m02:56:05.396783 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:05.400785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m02:56:05.461888 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m02:56:05.461888 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m02:56:05.462887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:05.500420 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:56:05.501389 [debug] [ThreadPool]: On list_db_project_2: Close
[0m02:56:05.503399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m02:56:05.510397 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:56:05.510397 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m02:56:05.511397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:05.546172 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:56:05.546172 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:56:05.547188 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:56:05.552165 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m02:56:05.553165 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m02:56:05.554191 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m02:56:05.560175 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:05.561176 [debug] [MainThread]: On master: BEGIN
[0m02:56:05.561176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:05.685275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:05.685275 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:05.685275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:05.701528 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:56:05.701528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FD87760>]}
[0m02:56:05.701528 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:05.701528 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:05.701528 [debug] [MainThread]: On master: BEGIN
[0m02:56:05.701528 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:05.701528 [debug] [MainThread]: On master: COMMIT
[0m02:56:05.701528 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:05.701528 [debug] [MainThread]: On master: COMMIT
[0m02:56:05.701528 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:05.701528 [debug] [MainThread]: On master: Close
[0m02:56:05.701528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:05.701528 [info ] [MainThread]: 
[0m02:56:05.712974 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m02:56:05.713958 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m02:56:05.714959 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m02:56:05.714959 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m02:56:05.722968 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m02:56:05.724002 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m02:56:05.758757 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m02:56:05.759757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.759757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m02:56:05.760863 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:56:05.886358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:05.886358 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.886358 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m02:56:05.902027 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m02:56:05.902027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.902027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m02:56:05.902027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:05.902027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.902027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m02:56:05.902027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:05.964994 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:56:05.964994 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.964994 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:56:05.964994 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:05.964994 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m02:56:05.964994 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:05.964994 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m02:56:05.980776 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:05.980776 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m02:56:05.980776 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B80042AC70>]}
[0m02:56:05.980776 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.27s]
[0m02:56:05.980776 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m02:56:05.980776 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m02:56:05.980776 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m02:56:05.991070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m02:56:05.992082 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m02:56:05.995074 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m02:56:05.996074 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m02:56:06.000076 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.001075 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.002075 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m02:56:06.002075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.039410 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.040410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.040410 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m02:56:06.046414 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m02:56:06.050415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.050415 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m02:56:06.051413 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.054413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.054413 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m02:56:06.055411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.057414 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:56:06.057414 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.057414 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:56:06.059412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:06.061409 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m02:56:06.062432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:06.062432 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m02:56:06.066411 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:06.067409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m02:56:06.068426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CD0D820>]}
[0m02:56:06.069412 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.08s]
[0m02:56:06.070411 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m02:56:06.070411 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m02:56:06.071411 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m02:56:06.071411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m02:56:06.072404 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m02:56:06.076409 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m02:56:06.077410 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m02:56:06.081433 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m02:56:06.082409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.082409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m02:56:06.082409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.117169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.118195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.118195 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m02:56:06.125169 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m02:56:06.128285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.128285 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m02:56:06.128285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.131320 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.131320 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:56:06.131320 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.131320 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:56:06.131320 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.131320 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:56:06.131320 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:06.138355 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m02:56:06.138355 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:06.138355 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m02:56:06.143867 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:06.143867 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m02:56:06.143867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F7A5370>]}
[0m02:56:06.143867 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m02:56:06.143867 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m02:56:06.143867 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m02:56:06.148342 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m02:56:06.149348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m02:56:06.149348 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m02:56:06.152353 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m02:56:06.153370 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m02:56:06.156596 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m02:56:06.157595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.158597 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m02:56:06.158597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.284345 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.284345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.284345 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m02:56:06.299980 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m02:56:06.299980 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.299980 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m02:56:06.299980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.299980 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.299980 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m02:56:06.299980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.299980 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:56:06.299980 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.299980 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:56:06.299980 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:06.315633 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m02:56:06.315633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:06.315633 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m02:56:06.315633 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:06.315633 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m02:56:06.315633 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F7A5370>]}
[0m02:56:06.315633 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.17s]
[0m02:56:06.315633 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m02:56:06.315633 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m02:56:06.324916 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m02:56:06.325936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m02:56:06.325936 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m02:56:06.328927 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.329951 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m02:56:06.333938 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.334955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.335955 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m02:56:06.335955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.373617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.373617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.373617 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m02:56:06.380491 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m02:56:06.383526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.384519 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m02:56:06.384923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.384923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.387969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m02:56:06.387969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:06.387969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:56:06.387969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.387969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:56:06.387969 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:06.387969 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m02:56:06.387969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:06.387969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m02:56:06.387969 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:06.387969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m02:56:06.400474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F7A5370>]}
[0m02:56:06.400474 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.08s]
[0m02:56:06.400474 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m02:56:06.400474 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:06.403629 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m02:56:06.404651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m02:56:06.404651 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:06.408702 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:06.408702 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:06.413680 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:06.414677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:06.414677 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m02:56:06.415677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.453212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.453212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:06.454206 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- with employee_revenue as (
--     select
--         e.employee_id,
--         e.first_name || ' ' || e.last_name as employee_name,
--         date_trunc('month', o.order_date) as month,
--         sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
--     from "db_project_2"."public"."stg_orders" o
--     join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
--     join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
--     group by e.employee_id, employee_name, month
-- )
-- select * from employee_revenue
-- order by total_gross_revenue desc
-- limit 1
  );
  
[0m02:56:06.456080 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 26:   );
           ^

[0m02:56:06.456080 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m02:56:06.457088 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m02:56:06.459080 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ")"
  LINE 26:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:56:06.460080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FD94730>]}
[0m02:56:06.460080 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.06s]
[0m02:56:06.461087 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:06.462139 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:06.462517 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m02:56:06.463536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m02:56:06.463536 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:06.467547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:06.467547 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:06.471532 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:06.473519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:06.473519 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m02:56:06.473519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.609003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.609003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:06.609003 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- with category_sales as (
--     select
--         p.category_id,
--         date_trunc('month', o.order_date) as month,
--         sum(od.quantity) as total_sold
--     from "db_project_2"."public"."stg_orders" o
--     join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
--     join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
--     group by p.category_id, month
-- )
-- select * from category_sales
-- order by total_sold desc
-- limit 1
  );
  
[0m02:56:06.609003 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 25:   );
           ^

[0m02:56:06.609003 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m02:56:06.609003 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m02:56:06.609003 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ")"
  LINE 25:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:56:06.609003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FD94730>]}
[0m02:56:06.609003 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.15s]
[0m02:56:06.609003 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:06.609003 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:06.617071 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m02:56:06.618078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m02:56:06.618078 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:06.622075 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:06.623077 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:06.627081 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:06.628083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:06.629082 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m02:56:06.629082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:06.663700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.664223 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:06.664795 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, month
)
select * from supplier_revenue
  );
  
[0m02:56:06.665893 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:56:06.666461 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m02:56:06.667001 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m02:56:06.667001 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:56:06.667001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da5df9ed-375d-404a-82e4-3c0026fa8bcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8004FC9A0>]}
[0m02:56:06.667001 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m02:56:06.667001 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:06.671070 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:06.671070 [debug] [MainThread]: On master: BEGIN
[0m02:56:06.672082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:06.706097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:06.707112 [debug] [MainThread]: On master: COMMIT
[0m02:56:06.708093 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:06.708093 [debug] [MainThread]: On master: COMMIT
[0m02:56:06.708093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:06.709113 [debug] [MainThread]: On master: Close
[0m02:56:06.709113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:06.709113 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m02:56:06.710091 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m02:56:06.710091 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m02:56:06.710091 [info ] [MainThread]: 
[0m02:56:06.711093 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m02:56:06.713086 [debug] [MainThread]: Command end result
[0m02:56:06.742101 [info ] [MainThread]: 
[0m02:56:06.743110 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:56:06.744111 [info ] [MainThread]: 
[0m02:56:06.745102 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ")"
  LINE 26:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:56:06.746101 [info ] [MainThread]: 
[0m02:56:06.746101 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ")"
  LINE 25:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:56:06.748108 [info ] [MainThread]: 
[0m02:56:06.749113 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.order_id does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.order_id...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:56:06.749113 [info ] [MainThread]: 
[0m02:56:06.750105 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m02:56:06.751101 [debug] [MainThread]: Command `dbt run` failed at 02:56:06.751101 after 2.09 seconds
[0m02:56:06.752101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87CDB2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87F386E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87FBA6CA0>]}
[0m02:56:06.752101 [debug] [MainThread]: Flushing usage events
[0m02:56:36.111678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E11F31C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E128629A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E149CCBE0>]}


============================== 02:56:36.111678 | 136346df-d77a-4cab-b952-2c34e615e55f ==============================
[0m02:56:36.111678 [info ] [MainThread]: Running with dbt=1.8.2
[0m02:56:36.127374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:56:36.191743 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:56:36.192746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E11E031C0>]}
[0m02:56:36.193743 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:56:36.194744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E11E031F0>]}
[0m02:56:36.315070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E12872E50>]}
[0m02:56:36.364887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E149970A0>]}
[0m02:56:36.365887 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m02:56:36.373888 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m02:56:36.519692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:56:36.519692 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:56:36.711115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m02:56:36.724192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E150B6130>]}
[0m02:56:36.808358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E1508A040>]}
[0m02:56:36.808358 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m02:56:36.808358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E150798B0>]}
[0m02:56:36.817560 [info ] [MainThread]: 
[0m02:56:36.818613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:36.823691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m02:56:36.884395 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m02:56:36.884395 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m02:56:36.885396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:36.913709 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:56:36.913709 [debug] [ThreadPool]: On list_db_project_2: Close
[0m02:56:36.913709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m02:56:36.913709 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:56:36.929381 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m02:56:36.929635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:36.961486 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:56:36.961486 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m02:56:36.962484 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m02:56:36.967497 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m02:56:36.968498 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m02:56:36.969480 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m02:56:36.976113 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:36.976113 [debug] [MainThread]: On master: BEGIN
[0m02:56:36.976113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:37.007303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.008282 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:37.008282 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:37.016283 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:56:37.017353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E150D7490>]}
[0m02:56:37.018352 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:37.018352 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:37.019279 [debug] [MainThread]: On master: BEGIN
[0m02:56:37.019279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.019279 [debug] [MainThread]: On master: COMMIT
[0m02:56:37.020278 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:37.020278 [debug] [MainThread]: On master: COMMIT
[0m02:56:37.020278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.021297 [debug] [MainThread]: On master: Close
[0m02:56:37.021297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:37.022444 [info ] [MainThread]: 
[0m02:56:37.025271 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m02:56:37.026296 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m02:56:37.027278 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m02:56:37.027278 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m02:56:37.034785 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m02:56:37.035798 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m02:56:37.071809 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m02:56:37.072796 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.072796 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m02:56:37.073793 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:56:37.103182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.104207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.104207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m02:56:37.109888 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m02:56:37.115924 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.115924 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m02:56:37.116900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.120899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.120899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m02:56:37.121900 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.180309 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:56:37.181310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.181310 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m02:56:37.182310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.188323 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m02:56:37.191887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m02:56:37.192881 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m02:56:37.195748 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:37.198307 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m02:56:37.200313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E122F76D0>]}
[0m02:56:37.200313 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.17s]
[0m02:56:37.201313 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m02:56:37.202319 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m02:56:37.202319 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m02:56:37.203346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m02:56:37.203346 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m02:56:37.206320 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.207335 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m02:56:37.212319 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.213312 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.213312 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m02:56:37.213312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.249027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.249027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.250060 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m02:56:37.255026 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m02:56:37.258055 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.259033 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m02:56:37.259033 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.262056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.262056 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m02:56:37.263058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.265049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:56:37.265049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.265049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m02:56:37.266804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.268809 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m02:56:37.269840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m02:56:37.269840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m02:56:37.272817 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:37.273818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m02:56:37.274834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F1C850>]}
[0m02:56:37.275819 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m02:56:37.275819 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m02:56:37.276810 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m02:56:37.276810 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m02:56:37.277809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m02:56:37.278810 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m02:56:37.282316 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m02:56:37.283323 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m02:56:37.287565 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m02:56:37.289079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.289079 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m02:56:37.289079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.325657 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.326687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.326687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m02:56:37.334203 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m02:56:37.337232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.338225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m02:56:37.338225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.341230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.341230 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m02:56:37.342210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.343027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:56:37.343027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.343027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m02:56:37.343027 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.343027 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m02:56:37.343027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m02:56:37.343027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m02:56:37.352278 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:37.353307 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m02:56:37.354290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E15616BE0>]}
[0m02:56:37.354290 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.08s]
[0m02:56:37.355310 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m02:56:37.356290 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m02:56:37.356290 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m02:56:37.357283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m02:56:37.358284 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m02:56:37.361312 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m02:56:37.362308 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m02:56:37.366296 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m02:56:37.367298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.367298 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m02:56:37.368294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.403528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.403528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.403528 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m02:56:37.409519 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m02:56:37.412525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.412525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m02:56:37.412525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.412525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.412525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m02:56:37.412525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.412525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:56:37.412525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.412525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m02:56:37.422354 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.424253 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m02:56:37.425247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m02:56:37.425247 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m02:56:37.427944 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:37.428973 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m02:56:37.429971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E154EB3D0>]}
[0m02:56:37.430951 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m02:56:37.430951 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m02:56:37.432481 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m02:56:37.432481 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m02:56:37.433487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m02:56:37.433487 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m02:56:37.436496 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.437510 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m02:56:37.441493 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.442527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.442527 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m02:56:37.443519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.480027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.481049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.481049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m02:56:37.488057 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m02:56:37.492074 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.492074 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m02:56:37.493082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.496058 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.496058 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m02:56:37.497060 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:37.499057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:56:37.499057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.499057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m02:56:37.500795 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.502807 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m02:56:37.504828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m02:56:37.505823 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m02:56:37.508668 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m02:56:37.509674 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m02:56:37.509674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F60B80>]}
[0m02:56:37.510674 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.08s]
[0m02:56:37.511731 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m02:56:37.511731 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:37.512674 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m02:56:37.513685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m02:56:37.513685 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:37.517674 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:37.518674 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:37.522674 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:37.523674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:37.523674 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m02:56:37.524675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.557244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.558239 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m02:56:37.558239 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- with employee_revenue as (
--     select
--         e.employee_id,
--         e.first_name || ' ' || e.last_name as employee_name,
--         date_trunc('month', o.order_date) as month,
--         sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
--     from "db_project_2"."public"."stg_orders" o
--     join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
--     join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
--     group by e.employee_id, employee_name, month
-- )
-- select * from employee_revenue
-- order by total_gross_revenue desc
-- limit 1
  );
  
[0m02:56:37.559481 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 26:   );
           ^

[0m02:56:37.559481 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m02:56:37.560520 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m02:56:37.563489 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ")"
  LINE 26:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:56:37.563489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F159D0>]}
[0m02:56:37.564489 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.05s]
[0m02:56:37.565489 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m02:56:37.565489 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:37.566497 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m02:56:37.567488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m02:56:37.567488 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:37.570517 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:37.571512 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:37.575258 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:37.575258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:37.576234 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m02:56:37.576234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.726078 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.726078 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m02:56:37.726078 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- with category_sales as (
--     select
--         p.category_id,
--         date_trunc('month', o.order_date) as month,
--         sum(od.quantity) as total_sold
--     from "db_project_2"."public"."stg_orders" o
--     join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
--     join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
--     group by p.category_id, month
-- )
-- select * from category_sales
-- order by total_sold desc
-- limit 1
  );
  
[0m02:56:37.726078 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 25:   );
           ^

[0m02:56:37.726078 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m02:56:37.726078 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m02:56:37.726078 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ")"
  LINE 25:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:56:37.726078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F60B80>]}
[0m02:56:37.726078 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.16s]
[0m02:56:37.726078 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m02:56:37.726078 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:37.733209 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m02:56:37.733209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m02:56:37.734216 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:37.737725 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:37.738829 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:37.742851 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:37.743852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:37.744851 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m02:56:37.744851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:37.779696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.779696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m02:56:37.780696 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.companyName,
        date_trunc('month', o.orderDate) as month,
        sum(od.unitPrice * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.orderID = od.orderID
    join "db_project_2"."public"."stg_products" p on od.productID = p.productID
    join "db_project_2"."public"."stg_suppliers" s on p.supplierID = s.supplierID
    group by s.companyName, month
)
select * from supplier_revenue
  );
  
[0m02:56:37.780696 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.orderid does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.orderID".

[0m02:56:37.780696 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m02:56:37.782355 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m02:56:37.782355 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.orderid does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:56:37.782355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '136346df-d77a-4cab-b952-2c34e615e55f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F0D2E0>]}
[0m02:56:37.782355 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m02:56:37.782355 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m02:56:37.787262 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:37.787262 [debug] [MainThread]: On master: BEGIN
[0m02:56:37.788280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:37.822246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:37.822246 [debug] [MainThread]: On master: COMMIT
[0m02:56:37.822246 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:37.823247 [debug] [MainThread]: On master: COMMIT
[0m02:56:37.823247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:37.824275 [debug] [MainThread]: On master: Close
[0m02:56:37.824275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:37.824275 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m02:56:37.825247 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m02:56:37.825247 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m02:56:37.825247 [info ] [MainThread]: 
[0m02:56:37.826247 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m02:56:37.828254 [debug] [MainThread]: Command end result
[0m02:56:37.859790 [info ] [MainThread]: 
[0m02:56:37.859790 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m02:56:37.860778 [info ] [MainThread]: 
[0m02:56:37.861778 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ")"
  LINE 26:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m02:56:37.862786 [info ] [MainThread]: 
[0m02:56:37.862786 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ")"
  LINE 25:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m02:56:37.863779 [info ] [MainThread]: 
[0m02:56:37.865786 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column o.orderid does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.orderID".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m02:56:37.866779 [info ] [MainThread]: 
[0m02:56:37.866779 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m02:56:37.868784 [debug] [MainThread]: Command `dbt run` failed at 02:56:37.868784 after 1.78 seconds
[0m02:56:37.869789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E11F31C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F2ED60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025E14F2E910>]}
[0m02:56:37.869789 [debug] [MainThread]: Flushing usage events
[0m03:10:55.899229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990BDECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993632CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279936323A0>]}


============================== 03:10:55.902961 | fea26631-c74d-4d77-9b8d-68d0e6ea99d4 ==============================
[0m03:10:55.902961 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:10:55.903943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:10:55.970278 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:10:55.971279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990AB31C0>]}
[0m03:10:55.972270 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:10:55.972270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990AB31F0>]}
[0m03:10:56.084800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799155A850>]}
[0m03:10:56.126849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799350B070>]}
[0m03:10:56.126849 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:10:56.139352 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:10:56.286388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:10:56.286388 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:10:56.286388 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m03:10:56.286388 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:10:56.466303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:10:56.475298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993D67130>]}
[0m03:10:56.566523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993D80430>]}
[0m03:10:56.566523 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m03:10:56.566523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279939EABB0>]}
[0m03:10:56.573693 [info ] [MainThread]: 
[0m03:10:56.574699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:10:56.580709 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:10:56.641403 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:10:56.641403 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:10:56.641403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:56.673695 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:10:56.673695 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:10:56.683699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:10:56.689241 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:10:56.689241 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:10:56.689241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:56.705479 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:10:56.705479 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:10:56.705479 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:10:56.721665 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m03:10:56.721665 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:10:56.721665 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:10:56.731174 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:56.731174 [debug] [MainThread]: On master: BEGIN
[0m03:10:56.731174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:56.752327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:56.752327 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:56.752327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:56.768517 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:10:56.768517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993D80910>]}
[0m03:10:56.768517 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:56.768517 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:56.768517 [debug] [MainThread]: On master: BEGIN
[0m03:10:56.768517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:56.768517 [debug] [MainThread]: On master: COMMIT
[0m03:10:56.768517 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:56.768517 [debug] [MainThread]: On master: COMMIT
[0m03:10:56.768517 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:56.768517 [debug] [MainThread]: On master: Close
[0m03:10:56.768517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:56.778542 [info ] [MainThread]: 
[0m03:10:56.782374 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:10:56.783397 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m03:10:56.784366 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m03:10:56.785367 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:10:56.792367 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:10:56.793408 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:10:56.830592 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:10:56.831386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.831386 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:10:56.832377 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:10:56.866783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:56.866783 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.866783 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:10:56.874435 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:10:56.874435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.874435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:10:56.874435 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:56.921628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.921628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:10:56.921628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:56.937327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:10:56.937327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.937327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:10:56.937327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:56.937327 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:10:56.937327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:10:56.937327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:10:56.953045 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:56.953045 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:10:56.953045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990FA8730>]}
[0m03:10:56.953045 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.17s]
[0m03:10:56.953045 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:10:56.953045 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:10:56.961886 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m03:10:56.962907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:10:56.963899 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:10:56.965897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:10:56.966915 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:10:56.972123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:10:56.974123 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:56.975120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:10:56.975120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.008739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.011268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:57.011268 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:10:57.011268 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:10:57.011268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:57.011268 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:10:57.011268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.011268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:57.011268 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:10:57.011268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.024948 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:10:57.024948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:57.024948 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:10:57.024948 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:57.024948 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:10:57.024948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:10:57.024948 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:10:57.024948 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:57.034980 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:10:57.034980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002799371D7F0>]}
[0m03:10:57.034980 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m03:10:57.034980 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:10:57.034980 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:10:57.038860 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m03:10:57.039865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:10:57.040874 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:10:57.043865 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:10:57.043865 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:10:57.047874 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:10:57.048873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.049889 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:10:57.049889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.085594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.085594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.086619 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:10:57.093604 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:10:57.096627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.097609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:10:57.097609 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.100159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.101164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:10:57.102136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.103168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:10:57.104159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.104159 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:10:57.105135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:57.108158 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:10:57.108158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:10:57.109168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:10:57.112136 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:57.113160 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:10:57.114159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279941D53D0>]}
[0m03:10:57.115136 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:10:57.116137 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:10:57.116137 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:10:57.117136 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m03:10:57.117136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:10:57.118136 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:10:57.121143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:10:57.121143 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:10:57.125137 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:10:57.126163 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.127143 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:10:57.127143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.164749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.165741 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.165741 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:10:57.172161 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:10:57.177217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.177217 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:10:57.177217 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.177217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.177217 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:10:57.177217 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.177217 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:10:57.177217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.177217 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:10:57.177217 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:57.177217 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:10:57.177217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:10:57.177217 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:10:57.177217 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:57.193624 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:10:57.193624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993BFF340>]}
[0m03:10:57.193624 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.08s]
[0m03:10:57.193624 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:10:57.193624 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:10:57.196832 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:10:57.197838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:10:57.198840 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:10:57.201842 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.201842 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:10:57.206383 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.206383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.207394 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:10:57.208358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.244671 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.244671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.244671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:10:57.245717 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:10:57.245717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.245717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:10:57.245717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.245717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.245717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:10:57.245717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:57.261363 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:10:57.261363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.261363 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:10:57.261363 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:57.266895 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:10:57.266895 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:10:57.266895 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:10:57.266895 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:10:57.266895 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:10:57.266895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279941BD340>]}
[0m03:10:57.266895 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:10:57.266895 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:10:57.266895 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:10:57.275184 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:10:57.276201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:10:57.276201 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:10:57.279838 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:10:57.280867 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:10:57.284837 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:10:57.285838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:10:57.285838 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:10:57.285838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.433621 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.433621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:10:57.433621 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, month
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m03:10:57.439666 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 16:         date_trunc('month', o.order_date) as month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:10:57.439666 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m03:10:57.439666 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:10:57.439666 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function date_trunc(unknown, text) does not exist
  LINE 16:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m03:10:57.439666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993C050D0>]}
[0m03:10:57.439666 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.16s]
[0m03:10:57.439666 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:10:57.439666 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:10:57.439666 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:10:57.449480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:10:57.450495 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:10:57.453493 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:10:57.454497 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:10:57.459491 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:10:57.461491 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:10:57.462491 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:10:57.462491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.598958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.599528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:10:57.599528 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        date_trunc('month', o.order_date) as month,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, month
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m03:10:57.601266 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 15:         date_trunc('month', o.order_date) as month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:10:57.601266 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:10:57.601812 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:10:57.603529 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  function date_trunc(unknown, text) does not exist
  LINE 15:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:10:57.604092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993CD7CA0>]}
[0m03:10:57.604633 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.15s]
[0m03:10:57.605175 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:10:57.605175 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:10:57.606247 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:10:57.607260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:10:57.607260 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:10:57.611275 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:10:57.612266 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:10:57.616253 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:10:57.617269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:10:57.618261 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:10:57.618261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:57.655931 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.656928 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:10:57.656928 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, month
)
select * from supplier_revenue
  );
  
[0m03:10:57.658855 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.supplier_id does not exist
LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                              ^
HINT:  Perhaps you meant to reference the column "p.supplier_id".

[0m03:10:57.658855 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m03:10:57.659849 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:10:57.660858 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:10:57.661855 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fea26631-c74d-4d77-9b8d-68d0e6ea99d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027993A03D90>]}
[0m03:10:57.661855 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m03:10:57.662856 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:10:57.663849 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:57.664873 [debug] [MainThread]: On master: BEGIN
[0m03:10:57.664873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:57.697095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:57.697095 [debug] [MainThread]: On master: COMMIT
[0m03:10:57.697095 [debug] [MainThread]: Using postgres connection "master"
[0m03:10:57.698111 [debug] [MainThread]: On master: COMMIT
[0m03:10:57.698111 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:57.699093 [debug] [MainThread]: On master: Close
[0m03:10:57.699093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:57.699093 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:10:57.700214 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:10:57.700725 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:10:57.700725 [info ] [MainThread]: 
[0m03:10:57.701741 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m03:10:57.703736 [debug] [MainThread]: Command end result
[0m03:10:57.734729 [info ] [MainThread]: 
[0m03:10:57.735728 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:10:57.736736 [info ] [MainThread]: 
[0m03:10:57.736736 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function date_trunc(unknown, text) does not exist
  LINE 16:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m03:10:57.737728 [info ] [MainThread]: 
[0m03:10:57.738730 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  function date_trunc(unknown, text) does not exist
  LINE 15:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:10:57.740251 [info ] [MainThread]: 
[0m03:10:57.741273 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:10:57.742266 [info ] [MainThread]: 
[0m03:10:57.742266 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m03:10:57.744268 [debug] [MainThread]: Command `dbt run` failed at 03:10:57.743273 after 1.89 seconds
[0m03:10:57.744268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027990BDECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279942FEA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279942FE6A0>]}
[0m03:10:57.744268 [debug] [MainThread]: Flushing usage events
[0m03:13:37.541667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83EE9ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841907A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83F81A790>]}


============================== 03:13:37.545659 | e2ee7d12-a0b4-405b-b440-84dad8cca102 ==============================
[0m03:13:37.545659 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:13:37.546354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m03:13:37.610368 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:37.611368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83ED73190>]}
[0m03:13:37.611368 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:37.612386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83ED731C0>]}
[0m03:13:37.719009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8418F2D90>]}
[0m03:13:37.766142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83ED868E0>]}
[0m03:13:37.766142 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:13:37.776855 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:13:37.900734 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:13:37.900734 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:13:37.900734 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:13:38.092130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:13:38.107129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84202A130>]}
[0m03:13:38.188273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841FFB610>]}
[0m03:13:38.188273 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m03:13:38.188273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841C9D8B0>]}
[0m03:13:38.199146 [info ] [MainThread]: 
[0m03:13:38.200159 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:38.205160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:13:38.268031 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:13:38.269045 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:13:38.269045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:38.303664 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:13:38.305669 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:13:38.306676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:13:38.313680 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:13:38.313680 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:13:38.313680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:38.343923 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.344928 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:13:38.344928 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:13:38.349953 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m03:13:38.351926 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:13:38.351926 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:13:38.357971 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:38.358988 [debug] [MainThread]: On master: BEGIN
[0m03:13:38.358988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:38.503978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.503978 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:38.505001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:13:38.512183 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:13:38.513231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841EC7160>]}
[0m03:13:38.514159 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:38.514159 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:38.515182 [debug] [MainThread]: On master: BEGIN
[0m03:13:38.515778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.515778 [debug] [MainThread]: On master: COMMIT
[0m03:13:38.515778 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:38.515778 [debug] [MainThread]: On master: COMMIT
[0m03:13:38.515778 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:38.515778 [debug] [MainThread]: On master: Close
[0m03:13:38.515778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:38.515778 [info ] [MainThread]: 
[0m03:13:38.515778 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:13:38.515778 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m03:13:38.522631 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m03:13:38.522631 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:13:38.529642 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:13:38.530643 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:13:38.565308 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:13:38.565308 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.565308 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:13:38.565308 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:13:38.597047 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.597047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.597047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:13:38.597047 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:13:38.597047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.612766 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:13:38.612766 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.612766 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.612766 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:13:38.612766 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.671817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:13:38.671817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.672825 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:13:38.673809 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:38.676313 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:13:38.676313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:38.676313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:13:38.686357 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:38.686357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:13:38.686357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83F268700>]}
[0m03:13:38.690969 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.16s]
[0m03:13:38.690969 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:13:38.690969 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:13:38.690969 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m03:13:38.693835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:13:38.694848 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:13:38.697842 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.698840 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:13:38.702846 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.702846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.703870 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:13:38.703870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:38.739648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.740668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.740668 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:13:38.745656 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:13:38.749674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.749674 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:13:38.750672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.752667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.753672 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:13:38.754649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.755670 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:13:38.756665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.756665 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:13:38.757648 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:38.758714 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:13:38.758714 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:38.758714 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:13:38.758714 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:38.758714 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:13:38.758714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841EA3790>]}
[0m03:13:38.758714 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.06s]
[0m03:13:38.758714 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:13:38.758714 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:13:38.768726 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m03:13:38.769741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:13:38.769741 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:13:38.773752 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:13:38.774771 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:13:38.778769 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:13:38.779752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.780755 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:13:38.780755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:38.922451 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:38.923454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.923454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:13:38.931615 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:13:38.934635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.934635 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:13:38.935635 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.938635 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.938635 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:13:38.939607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:38.941137 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:13:38.941137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.942165 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:13:38.943079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:38.945120 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:13:38.946115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:38.947112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:13:38.949090 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:38.951108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:13:38.951108 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8424C5F10>]}
[0m03:13:38.952110 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.18s]
[0m03:13:38.953321 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:13:38.953321 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:13:38.953321 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m03:13:38.953321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:13:38.953321 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:13:38.953321 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:13:38.953321 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:13:38.963342 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:13:38.964331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:38.965330 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:13:38.965330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:39.004703 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.004703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:39.004703 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:13:39.009794 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:13:39.009794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:39.009794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:13:39.009794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:39.009794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:39.009794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:13:39.009794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:39.009794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:13:39.009794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:39.009794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:13:39.009794 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:39.025656 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:13:39.025656 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:39.025656 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:13:39.025656 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:39.025656 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:13:39.025656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8424875B0>]}
[0m03:13:39.025656 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:13:39.025656 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:13:39.036189 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:13:39.036189 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:13:39.037203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:13:39.038196 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:13:39.041218 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.041218 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:13:39.045420 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.046421 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.047419 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:13:39.047419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:39.083436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.083436 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.084461 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:13:39.090605 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:13:39.094619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.095602 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:13:39.095602 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:39.098623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.099607 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:13:39.099607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:39.101618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:13:39.101618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.102618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:13:39.103602 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:39.105619 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:13:39.106754 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:39.106754 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:13:39.106754 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:39.106754 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:13:39.106754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84247DA30>]}
[0m03:13:39.106754 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:13:39.106754 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:13:39.106754 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:39.115769 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:13:39.115769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:13:39.116784 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:39.119784 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:39.120789 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:39.124785 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:39.125800 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:39.125800 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:13:39.126801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:39.161310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.161310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:39.162318 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        date_trunc('month', o.order_date) as month,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, month
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m03:13:39.163309 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 16:         date_trunc('month', o.order_date) as month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m03:13:39.163309 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m03:13:39.164337 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:13:39.167310 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function date_trunc(unknown, text) does not exist
  LINE 16:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m03:13:39.167310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84247D8B0>]}
[0m03:13:39.168309 [error] [Thread-1  ]: 6 of 8 ERROR creating sql table model public.datamart_monthly_best_employee .... [[31mERROR[0m in 0.05s]
[0m03:13:39.169336 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:39.169336 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:39.170682 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:13:39.171272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:13:39.171272 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:39.174305 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:39.175412 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:39.179448 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:39.180413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:39.180413 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:13:39.180413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:39.217530 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.217530 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:39.218527 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, month
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m03:13:39.219542 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 20:     group by p.category_id, month
                                     ^

[0m03:13:39.219542 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:13:39.220543 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:13:39.222543 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "month" does not exist
  LINE 20:     group by p.category_id, month
                                       ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:13:39.222639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84258AB20>]}
[0m03:13:39.223526 [error] [Thread-1  ]: 7 of 8 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.05s]
[0m03:13:39.224527 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:39.224527 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:39.225527 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:13:39.225527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:13:39.226547 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:39.230925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:39.231932 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:39.235466 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:39.236482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:39.236482 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:13:39.237482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:39.271511 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.272471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:39.272471 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:13:39.273489 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.supplier_id does not exist
LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                              ^
HINT:  Perhaps you meant to reference the column "p.supplier_id".

[0m03:13:39.274471 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m03:13:39.274471 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:13:39.276471 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:13:39.276471 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2ee7d12-a0b4-405b-b440-84dad8cca102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E84258AB20>]}
[0m03:13:39.277481 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m03:13:39.278490 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:39.279488 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:39.279488 [debug] [MainThread]: On master: BEGIN
[0m03:13:39.279488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:39.310393 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:39.311376 [debug] [MainThread]: On master: COMMIT
[0m03:13:39.311376 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:39.312377 [debug] [MainThread]: On master: COMMIT
[0m03:13:39.312377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:39.313377 [debug] [MainThread]: On master: Close
[0m03:13:39.313377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:39.313377 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:13:39.314375 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:13:39.314375 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:13:39.314375 [info ] [MainThread]: 
[0m03:13:39.315371 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m03:13:39.317379 [debug] [MainThread]: Command end result
[0m03:13:39.346931 [info ] [MainThread]: 
[0m03:13:39.347915 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m03:13:39.347915 [info ] [MainThread]: 
[0m03:13:39.348908 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function date_trunc(unknown, text) does not exist
  LINE 16:         date_trunc('month', o.order_date) as month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m03:13:39.349918 [info ] [MainThread]: 
[0m03:13:39.350919 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "month" does not exist
  LINE 20:     group by p.category_id, month
                                       ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:13:39.351919 [info ] [MainThread]: 
[0m03:13:39.352915 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:13:39.352915 [info ] [MainThread]: 
[0m03:13:39.353909 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m03:13:39.355916 [debug] [MainThread]: Command `dbt run` failed at 03:13:39.354910 after 1.86 seconds
[0m03:13:39.355916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83EE9ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841C9D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E841C9D4C0>]}
[0m03:13:39.355916 [debug] [MainThread]: Flushing usage events
[0m03:13:52.702369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769762BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876A0A7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C1C8D00>]}


============================== 03:13:52.705888 | aa111c1b-444d-46d3-9439-79ae050cf4bd ==============================
[0m03:13:52.705888 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:13:52.706894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:13:52.769802 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:52.770946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769633160>]}
[0m03:13:52.771958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:52.771958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769633190>]}
[0m03:13:52.884002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876A0C91F0>]}
[0m03:13:52.930409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C1BC730>]}
[0m03:13:52.932410 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:13:52.939449 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:13:53.083343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:13:53.084870 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m03:13:53.085902 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:13:53.282541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:13:53.295109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C8EBF40>]}
[0m03:13:53.392408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C8BD3A0>]}
[0m03:13:53.393407 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m03:13:53.393407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C8C04C0>]}
[0m03:13:53.395389 [info ] [MainThread]: 
[0m03:13:53.396245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:53.401260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:13:53.460073 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:13:53.460073 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:13:53.460073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:53.495722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:13:53.497717 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:13:53.498718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:13:53.504748 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:13:53.505740 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:13:53.505740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:53.534455 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.535439 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:13:53.535439 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:13:53.540437 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m03:13:53.541438 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:13:53.542965 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:13:53.548983 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:53.548983 [debug] [MainThread]: On master: BEGIN
[0m03:13:53.548983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:53.578184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.578716 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:53.578716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:13:53.586133 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:13:53.587129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C9041C0>]}
[0m03:13:53.587129 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:53.589034 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:53.589034 [debug] [MainThread]: On master: BEGIN
[0m03:13:53.589846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.589846 [debug] [MainThread]: On master: COMMIT
[0m03:13:53.589846 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:53.589846 [debug] [MainThread]: On master: COMMIT
[0m03:13:53.590875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:53.590875 [debug] [MainThread]: On master: Close
[0m03:13:53.591886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:53.591886 [info ] [MainThread]: 
[0m03:13:53.594903 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:13:53.595902 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m03:13:53.596901 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m03:13:53.597903 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:13:53.605892 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:13:53.606904 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:13:53.645596 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:13:53.646617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.647598 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:13:53.647598 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:13:53.680856 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.681858 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.681858 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:13:53.688275 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:13:53.695802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.696253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:13:53.696253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.696253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.696253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:13:53.696253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.759929 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:13:53.759929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.760929 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:13:53.762100 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:53.768128 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:13:53.771137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:13:53.772134 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:13:53.772745 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:53.772745 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:13:53.778751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876CD57CA0>]}
[0m03:13:53.778751 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.18s]
[0m03:13:53.778751 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:13:53.778751 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:13:53.778751 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m03:13:53.781944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:13:53.782987 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:13:53.785949 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.785949 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:13:53.790586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.791583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.791583 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:13:53.792598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:53.826803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.827798 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.827798 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:13:53.833338 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:13:53.837314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.838315 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:13:53.838315 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.841314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.841314 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:13:53.842315 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.844326 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:13:53.844326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.845323 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:13:53.846323 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:53.848346 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:13:53.849322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:13:53.850322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:13:53.852320 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:53.853326 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:13:53.854326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876CD68FA0>]}
[0m03:13:53.855335 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m03:13:53.856316 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:13:53.856316 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:13:53.857322 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m03:13:53.858315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:13:53.858315 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:13:53.862315 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:13:53.862315 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:13:53.866314 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:13:53.867314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.868316 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:13:53.868316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:53.902859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.902859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.903889 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:13:53.910412 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:13:53.913441 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.914410 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:13:53.914410 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.917436 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.917436 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:13:53.918418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.920435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:13:53.920435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.920435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:13:53.922404 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:53.924410 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:13:53.925409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:13:53.925409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:13:53.928737 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:53.929750 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:13:53.930769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876CE3A460>]}
[0m03:13:53.931743 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:13:53.932744 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:13:53.932744 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:13:53.933742 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m03:13:53.933742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:13:53.934742 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:13:53.937300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:13:53.937300 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:13:53.941303 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:13:53.942305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.942305 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:13:53.943305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:53.977957 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:53.977957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.978990 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:13:53.984478 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:13:53.987856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.987856 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:13:53.987856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.987856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.987856 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:13:53.987856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:53.987856 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:13:53.987856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.987856 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:13:53.987856 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:53.987856 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:13:53.987856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:13:53.987856 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:13:53.987856 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:54.003732 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:13:54.004236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876CD217F0>]}
[0m03:13:54.004236 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:13:54.004236 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:13:54.004236 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:13:54.007443 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:13:54.008551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:13:54.008655 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:13:54.011692 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.012659 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:13:54.015662 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.016669 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.016669 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:13:54.017669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:54.051986 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:54.053039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.053039 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:13:54.058991 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:13:54.062020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.063014 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:13:54.063014 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:54.064115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.064115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:13:54.064115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:54.064115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:13:54.064115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.064115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:13:54.064115 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:54.064115 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:13:54.064115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:13:54.064115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:13:54.064115 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:54.064115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:13:54.064115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C171820>]}
[0m03:13:54.064115 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.06s]
[0m03:13:54.079998 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:13:54.079998 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:54.081471 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:13:54.082487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:13:54.082487 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:54.086475 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.087478 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:54.091013 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.092057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.093064 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:13:54.093064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:54.134607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:54.136119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.136119 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 1
  );
  
[0m03:13:54.140932 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m03:13:54.140932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.140932 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:13:54.140932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:54.140932 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:13:54.140932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.140932 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:13:54.140932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:54.140932 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:13:54.156600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:13:54.156846 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:13:54.156846 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:54.157852 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:13:54.158853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C736BE0>]}
[0m03:13:54.159852 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 1[0m in 0.08s]
[0m03:13:54.160989 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:13:54.161645 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:54.161645 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:13:54.162651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:13:54.162651 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:54.166650 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.166650 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:54.170649 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.171780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.172650 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:13:54.172650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:54.205759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:54.206799 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.206799 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
)
select * from category_sales
order by total_sold desc
limit 1
  );
  
[0m03:13:54.210114 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m03:13:54.210114 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.210114 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m03:13:54.210114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:13:54.210114 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:13:54.210114 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.210114 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:13:54.210114 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:13:54.226467 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m03:13:54.226467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:13:54.226467 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m03:13:54.226467 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:13:54.226467 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:13:54.226467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876CE1D6D0>]}
[0m03:13:54.226467 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.datamart_monthly_category_sold ........ [[32mSELECT 1[0m in 0.06s]
[0m03:13:54.226467 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:13:54.226467 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:54.233358 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:13:54.234364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:13:54.234364 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:54.237872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:54.238873 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:54.243872 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:54.244872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:54.245873 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:13:54.245873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:13:54.280220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:13:54.280220 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:13:54.280220 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:13:54.280220 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.supplier_id does not exist
LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                              ^
HINT:  Perhaps you meant to reference the column "p.supplier_id".

[0m03:13:54.280220 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m03:13:54.283750 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:13:54.283750 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:13:54.283750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa111c1b-444d-46d3-9439-79ae050cf4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769689F40>]}
[0m03:13:54.283750 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m03:13:54.283750 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:13:54.290933 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:54.290933 [debug] [MainThread]: On master: BEGIN
[0m03:13:54.290933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:54.323522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:13:54.324527 [debug] [MainThread]: On master: COMMIT
[0m03:13:54.324527 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:54.324527 [debug] [MainThread]: On master: COMMIT
[0m03:13:54.325526 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:13:54.325526 [debug] [MainThread]: On master: Close
[0m03:13:54.326521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:54.326521 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:13:54.326521 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:13:54.327537 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:13:54.327537 [info ] [MainThread]: 
[0m03:13:54.328522 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m03:13:54.330538 [debug] [MainThread]: Command end result
[0m03:13:54.358056 [info ] [MainThread]: 
[0m03:13:54.359055 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:13:54.360056 [info ] [MainThread]: 
[0m03:13:54.360056 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:13:54.361091 [info ] [MainThread]: 
[0m03:13:54.362047 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m03:13:54.363059 [debug] [MainThread]: Command `dbt run` failed at 03:13:54.363059 after 1.71 seconds
[0m03:13:54.364065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769762BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001876C1D14C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018769633640>]}
[0m03:13:54.364065 [debug] [MainThread]: Flushing usage events
[0m03:15:06.935747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7A6B2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7AFF7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D117D00>]}


============================== 03:15:06.939813 | fac38714-e213-4880-ae95-a57afbee4e3a ==============================
[0m03:15:06.939813 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:15:06.940821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'profiles_dir': './', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:15:07.004568 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:15:07.005569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7A583160>]}
[0m03:15:07.005569 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:15:07.006587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7A583190>]}
[0m03:15:07.121740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7B0231F0>]}
[0m03:15:07.166270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D10D730>]}
[0m03:15:07.168269 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:15:07.176272 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:15:07.319110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m03:15:07.320086 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:15:07.320086 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m03:15:07.503222 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:15:07.518205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D83AF40>]}
[0m03:15:07.607210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D80B5B0>]}
[0m03:15:07.607210 [info ] [MainThread]: Found 8 models, 5 sources, 413 macros
[0m03:15:07.607210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D80F4C0>]}
[0m03:15:07.612256 [info ] [MainThread]: 
[0m03:15:07.613261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:15:07.617722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:15:07.679988 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:15:07.679988 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:15:07.679988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:07.707127 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:15:07.707127 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:15:07.707127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:15:07.722929 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:15:07.722929 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:15:07.722929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:07.754109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:15:07.754109 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:15:07.754109 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:15:07.754109 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m03:15:07.754109 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:15:07.754109 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:15:07.769820 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:07.769820 [debug] [MainThread]: On master: BEGIN
[0m03:15:07.769820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:15:07.799372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:15:07.799372 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:07.799372 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:15:07.801883 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:15:07.801883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D8F3760>]}
[0m03:15:07.801883 [debug] [MainThread]: On master: ROLLBACK
[0m03:15:07.801883 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:07.801883 [debug] [MainThread]: On master: BEGIN
[0m03:15:07.801883 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:15:07.801883 [debug] [MainThread]: On master: COMMIT
[0m03:15:07.801883 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:07.801883 [debug] [MainThread]: On master: COMMIT
[0m03:15:07.801883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:15:07.801883 [debug] [MainThread]: On master: Close
[0m03:15:07.801883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:07.801883 [info ] [MainThread]: 
[0m03:15:07.820413 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:15:07.821396 [info ] [Thread-1  ]: 1 of 8 START sql table model public.stg_employees .............................. [RUN]
[0m03:15:07.822400 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_employees'
[0m03:15:07.822400 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:15:07.829398 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:15:07.830419 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:15:07.866950 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:15:07.867944 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.867944 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:15:07.868945 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:15:07.899342 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:07.899927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.899927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:15:07.899927 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:15:07.899927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.899927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:15:07.914092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:07.914092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.914092 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:15:07.914092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:07.960826 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:15:07.960826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.960826 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:15:07.960826 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:07.977201 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:15:07.977201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:15:07.977201 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:15:07.986708 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:07.986708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:15:07.986708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7AA78640>]}
[0m03:15:07.986708 [info ] [Thread-1  ]: 1 of 8 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.16s]
[0m03:15:07.986708 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:15:07.992238 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:15:07.993113 [info ] [Thread-1  ]: 2 of 8 START sql table model public.stg_order_details .......................... [RUN]
[0m03:15:07.994134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:15:07.994134 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:15:07.997214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:15:07.998186 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:15:08.001649 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.002654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.003653 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:15:08.003653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.043660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.043660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.043660 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:15:08.049471 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:15:08.053493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.053493 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:15:08.054470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.056494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.057495 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:15:08.057495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.059484 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:15:08.060482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.060482 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:15:08.061478 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.063477 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:15:08.064511 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:15:08.065494 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:15:08.068208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.069192 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:15:08.070209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C79543C10>]}
[0m03:15:08.070307 [info ] [Thread-1  ]: 2 of 8 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.08s]
[0m03:15:08.071156 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:15:08.071156 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:15:08.071156 [info ] [Thread-1  ]: 3 of 8 START sql table model public.stg_orders ................................. [RUN]
[0m03:15:08.071156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:15:08.071156 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:15:08.071156 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:15:08.078114 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:15:08.081688 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:15:08.082691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.082691 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:15:08.083668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.117548 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.118576 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.118576 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:15:08.126154 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:15:08.129165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.130185 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:15:08.130185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.133154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.134161 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:15:08.135162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.136195 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:15:08.137183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.137183 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:15:08.138161 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.141162 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:15:08.141162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:15:08.141162 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:15:08.144854 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.145873 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:15:08.146873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7957A400>]}
[0m03:15:08.147849 [info ] [Thread-1  ]: 3 of 8 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.08s]
[0m03:15:08.148850 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:15:08.148850 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:15:08.149858 [info ] [Thread-1  ]: 4 of 8 START sql table model public.stg_products ............................... [RUN]
[0m03:15:08.149858 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:15:08.150849 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:15:08.152877 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:15:08.153872 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:15:08.156863 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:15:08.157859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.158857 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:15:08.158857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.193692 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.193692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.194691 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:15:08.200738 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:15:08.203108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.203108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:15:08.203108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.203108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.203108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:15:08.203108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.203108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:15:08.203108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.203108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:15:08.203108 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.203108 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:15:08.203108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:15:08.203108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:15:08.218739 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.219090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:15:08.219090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D8EB850>]}
[0m03:15:08.219090 [info ] [Thread-1  ]: 4 of 8 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:15:08.219090 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:15:08.219090 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:15:08.223401 [info ] [Thread-1  ]: 5 of 8 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:15:08.224409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:15:08.225429 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:15:08.228429 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.228429 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:15:08.232968 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.232968 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.233965 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:15:08.234986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.366321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.366321 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.381913 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:15:08.382061 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:15:08.382061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.392090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:15:08.392090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.392090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.392090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:15:08.392090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.397609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:15:08.397609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.397609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:15:08.397609 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.400126 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:15:08.400126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:15:08.400126 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:15:08.400126 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.400126 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:15:08.400126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7DCC0A90>]}
[0m03:15:08.400126 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.18s]
[0m03:15:08.400126 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:15:08.400126 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:15:08.410934 [info ] [Thread-1  ]: 6 of 8 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:15:08.411951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:15:08.411951 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:15:08.415964 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.415964 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:15:08.419964 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.420964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.420964 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:15:08.421969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.458487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.458487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.458487 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:15:08.468694 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:15:08.471718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.471718 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:15:08.472710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.473772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.473772 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:15:08.473772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.473772 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:15:08.473772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.473772 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:15:08.473772 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.473772 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:15:08.473772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:15:08.473772 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:15:08.473772 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.473772 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:15:08.473772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7DC7C670>]}
[0m03:15:08.473772 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.06s]
[0m03:15:08.473772 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:15:08.473772 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:15:08.489656 [info ] [Thread-1  ]: 7 of 8 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:15:08.490673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:15:08.490673 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:15:08.494693 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.495694 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:15:08.498674 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.500201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.500201 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:15:08.501229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.535961 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.535961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.536962 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
)
select * from category_sales
order by total_sold desc
limit 10
  );
  
[0m03:15:08.547401 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:15:08.551422 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.551422 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m03:15:08.552416 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.555420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.555420 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m03:15:08.556400 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:15:08.557400 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:15:08.558416 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.558416 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:15:08.559717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.561728 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m03:15:08.562745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:15:08.562745 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m03:15:08.564282 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:15:08.564282 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:15:08.564282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D68CCD0>]}
[0m03:15:08.564282 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.datamart_monthly_category_sold ........ [[32mSELECT 10[0m in 0.07s]
[0m03:15:08.564282 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:15:08.564282 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:15:08.564282 [info ] [Thread-1  ]: 8 of 8 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:15:08.571360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:15:08.572255 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:15:08.575265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:15:08.576259 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:15:08.580255 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:15:08.580255 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:15:08.581761 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:15:08.581761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:15:08.715780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.716811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:15:08.716944 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:15:08.717945 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column s.supplier_id does not exist
LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                              ^
HINT:  Perhaps you meant to reference the column "p.supplier_id".

[0m03:15:08.717945 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m03:15:08.718953 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:15:08.721945 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:15:08.721945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fac38714-e213-4880-ae95-a57afbee4e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D6B2940>]}
[0m03:15:08.722953 [error] [Thread-1  ]: 8 of 8 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.15s]
[0m03:15:08.723945 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:15:08.725040 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:08.725040 [debug] [MainThread]: On master: BEGIN
[0m03:15:08.725945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:15:08.756613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:15:08.757624 [debug] [MainThread]: On master: COMMIT
[0m03:15:08.757624 [debug] [MainThread]: Using postgres connection "master"
[0m03:15:08.758622 [debug] [MainThread]: On master: COMMIT
[0m03:15:08.758622 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:15:08.758622 [debug] [MainThread]: On master: Close
[0m03:15:08.759627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:08.759627 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:15:08.760624 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:15:08.760624 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:15:08.760624 [info ] [MainThread]: 
[0m03:15:08.761624 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m03:15:08.763620 [debug] [MainThread]: Command end result
[0m03:15:08.793125 [info ] [MainThread]: 
[0m03:15:08.795127 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:15:08.796128 [info ] [MainThread]: 
[0m03:15:08.797136 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column s.supplier_id does not exist
  LINE 20: ..._2"."public"."stg_suppliers" s on p.supplier_id = s.supplier...
                                                                ^
  HINT:  Perhaps you meant to reference the column "p.supplier_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:15:08.798135 [info ] [MainThread]: 
[0m03:15:08.798135 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m03:15:08.799129 [debug] [MainThread]: Command `dbt run` failed at 03:15:08.799129 after 1.91 seconds
[0m03:15:08.800636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7A6B2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7DDE5E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C7D80B790>]}
[0m03:15:08.800636 [debug] [MainThread]: Flushing usage events
[0m03:26:01.016425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AA741C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD1DAD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD1DAC40>]}


============================== 03:26:01.020424 | bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6 ==============================
[0m03:26:01.020424 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:26:01.020424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:26:01.082484 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:26:01.083484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AA613160>]}
[0m03:26:01.084480 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:26:01.085485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AA613190>]}
[0m03:26:01.200451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD19D5E0>]}
[0m03:26:01.246411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD1A7040>]}
[0m03:26:01.247682 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:26:01.255717 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:26:01.410603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m03:26:01.411603 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\warehouse\stg_categories.sql
[0m03:26:01.412604 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\sources.yml
[0m03:26:01.412604 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:26:01.688589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:26:01.706885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD9C1130>]}
[0m03:26:01.797880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD994EB0>]}
[0m03:26:01.798856 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:26:01.799855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD99DEB0>]}
[0m03:26:01.800856 [info ] [MainThread]: 
[0m03:26:01.801865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:26:01.807381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:26:01.910988 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:26:01.910988 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:26:01.910988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:01.945782 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:26:01.947807 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:26:01.949936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:26:01.955476 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:26:01.956452 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:26:01.956452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:01.992545 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:26:01.992545 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:26:01.993556 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:26:01.994088 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m03:26:01.994088 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:26:01.994088 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:26:02.007333 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:02.007333 [debug] [MainThread]: On master: BEGIN
[0m03:26:02.007333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:02.157841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.157841 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:02.157841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:26:02.160940 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:26:02.160940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD9F0CD0>]}
[0m03:26:02.160940 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:02.160940 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:02.160940 [debug] [MainThread]: On master: BEGIN
[0m03:26:02.160940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.168907 [debug] [MainThread]: On master: COMMIT
[0m03:26:02.168907 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:02.168907 [debug] [MainThread]: On master: COMMIT
[0m03:26:02.169989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.169989 [debug] [MainThread]: On master: Close
[0m03:26:02.169989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:02.170996 [info ] [MainThread]: 
[0m03:26:02.174668 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:26:02.175668 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:26:02.176667 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:26:02.176667 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:26:02.184209 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:26:02.186195 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:26:02.223250 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:26:02.223250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:02.223250 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:26:02.223250 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:26:02.254561 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.254561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:02.254561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:26:02.254561 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:26:02.254561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:02.254561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:26:02.254561 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.280406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:26:02.280406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:02.280406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:26:02.285920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.285920 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:26:02.285920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:02.285920 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:26:02.285920 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.285920 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:26:02.285920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AA652D30>]}
[0m03:26:02.285920 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.11s]
[0m03:26:02.302184 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:26:02.302184 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:26:02.303414 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:26:02.304427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:26:02.304427 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:26:02.307543 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:26:02.308543 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:26:02.312550 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:26:02.313541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.313541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:26:02.313541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.349089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.349089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.350107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:26:02.355620 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:26:02.358653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.359655 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:26:02.360558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.362638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.362638 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:26:02.362638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.362638 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:26:02.362638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.362638 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:26:02.362638 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.362638 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:26:02.362638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:02.362638 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:26:02.362638 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.378380 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:26:02.378883 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD527EE0>]}
[0m03:26:02.378883 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.08s]
[0m03:26:02.378883 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:26:02.378883 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:26:02.382414 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:26:02.383423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:26:02.384446 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:26:02.387432 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.387432 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:26:02.390969 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.391966 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.392968 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:26:02.392968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.433522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.433522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.435049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:26:02.438757 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:26:02.438757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.438757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:26:02.438757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.438757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.438757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:26:02.438757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.450496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:26:02.450496 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.450496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:26:02.452492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.454515 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:26:02.455511 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:02.455511 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:26:02.458562 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.459461 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:26:02.459461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD527DC0>]}
[0m03:26:02.459461 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.08s]
[0m03:26:02.459461 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:26:02.459461 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:26:02.459461 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:26:02.459461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:26:02.459461 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:26:02.468417 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:26:02.468417 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:26:02.472408 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:26:02.473404 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.474520 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:26:02.474520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.506888 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.508006 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.508006 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:26:02.516012 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:26:02.519041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.520046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:26:02.520046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.522985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.522985 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:26:02.522985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.522985 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:26:02.522985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.522985 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:26:02.522985 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.522985 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:26:02.522985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:02.522985 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:26:02.531515 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.531515 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:26:02.531515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4ADE470D0>]}
[0m03:26:02.531515 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:26:02.531515 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:26:02.531515 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:26:02.538608 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:26:02.539627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:26:02.540630 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:26:02.543748 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:26:02.544749 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:26:02.548747 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:26:02.549753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.549753 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:26:02.550749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.586002 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.587035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.587035 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:26:02.593526 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:26:02.597561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.597561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:26:02.598618 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.598618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.598618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:26:02.598618 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.598618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:26:02.598618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.604659 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:26:02.604659 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.604659 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:26:02.604659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:02.604659 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:26:02.604659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.604659 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:26:02.604659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD867460>]}
[0m03:26:02.604659 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:26:02.614666 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:26:02.614666 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:26:02.616499 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:26:02.617506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:26:02.617506 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:26:02.621060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.621060 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:26:02.625089 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.626077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.627056 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:26:02.627056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.764881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.780129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.780129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:26:02.780129 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:26:02.790184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.790184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:26:02.790184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.790184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.790184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:26:02.790184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.796384 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:26:02.796384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.796384 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:26:02.796384 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.796384 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:26:02.796384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:02.796384 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:26:02.805419 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.805419 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:26:02.805419 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD888700>]}
[0m03:26:02.805419 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.19s]
[0m03:26:02.811457 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:26:02.811457 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:02.812556 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:26:02.813563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:26:02.813563 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:02.817590 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.817590 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:02.822587 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.823573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.824574 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:26:02.824574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:02.955603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:02.955603 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.955603 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:26:02.976098 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:26:02.979675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.979675 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:26:02.981715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.981715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.981715 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:26:02.981715 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:02.981715 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:26:02.981715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.981715 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:26:02.981715 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:02.981715 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:26:02.981715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:02.981715 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:26:02.995232 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:02.995232 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:26:02.995232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AD872370>]}
[0m03:26:02.995232 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.18s]
[0m03:26:02.995232 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:03.000895 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:03.000895 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:26:03.001929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:26:03.002908 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:03.008447 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:03.009441 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:03.017052 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:03.018045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:03.019024 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:26:03.019024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:03.160149 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:03.160149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:03.160149 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.orderID = od.orderID
    join "db_project_2"."public"."stg_products" p on od.productID = p.productID
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.month,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
order by cs.total_sold desc
limit 10
  );
  
[0m03:26:03.160149 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.orderid does not exist
LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                              ^
HINT:  Perhaps you meant to reference the column "o.order_id".

[0m03:26:03.160149 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:26:03.160149 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:26:03.160149 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.orderid does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.order_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:26:03.160149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4ADED3640>]}
[0m03:26:03.160149 [error] [Thread-1  ]: 8 of 9 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.16s]
[0m03:26:03.160149 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:03.160149 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:03.160149 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:26:03.173285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:26:03.173285 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:03.177280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.178281 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:03.182281 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.183286 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.183286 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:26:03.184283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:03.220766 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:03.222494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.222494 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:26:03.233660 [debug] [Thread-1  ]: SQL status: SELECT 1961 in 0.0 seconds
[0m03:26:03.236694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.237689 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:26:03.237689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:03.239672 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:26:03.239672 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.239672 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:26:03.241779 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:03.244203 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:26:03.244203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:03.244203 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:26:03.244203 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:03.244203 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:26:03.244203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbfc2416-ea55-4e8f-abb0-c5e70a6bd0a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4ADED3400>]}
[0m03:26:03.244203 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 1961[0m in 0.07s]
[0m03:26:03.244203 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:03.244203 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:03.251053 [debug] [MainThread]: On master: BEGIN
[0m03:26:03.251053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:03.282596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:03.283610 [debug] [MainThread]: On master: COMMIT
[0m03:26:03.283610 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:03.284595 [debug] [MainThread]: On master: COMMIT
[0m03:26:03.284595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:03.284595 [debug] [MainThread]: On master: Close
[0m03:26:03.285610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:03.285610 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:26:03.286615 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:26:03.286615 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:26:03.286615 [info ] [MainThread]: 
[0m03:26:03.287595 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m03:26:03.290592 [debug] [MainThread]: Command end result
[0m03:26:03.320185 [info ] [MainThread]: 
[0m03:26:03.321100 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:03.322101 [info ] [MainThread]: 
[0m03:26:03.323112 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column o.orderid does not exist
  LINE 18: ..."db_project_2"."public"."stg_order_details" od on o.orderID ...
                                                                ^
  HINT:  Perhaps you meant to reference the column "o.order_id".
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:26:03.324110 [info ] [MainThread]: 
[0m03:26:03.325103 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m03:26:03.326111 [debug] [MainThread]: Command `dbt run` failed at 03:26:03.326111 after 2.36 seconds
[0m03:26:03.327128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AA741C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4ACD15E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AABE8820>]}
[0m03:26:03.327128 [debug] [MainThread]: Flushing usage events
[0m03:26:43.577349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215069FECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509452CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215094523A0>]}


============================== 03:26:43.577349 | cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e ==============================
[0m03:26:43.577349 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:26:43.577349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:26:43.645904 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:26:43.646895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215068D31C0>]}
[0m03:26:43.646895 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:26:43.648005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215068D31F0>]}
[0m03:26:43.756581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150737A850>]}
[0m03:26:43.799598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509327070>]}
[0m03:26:43.799598 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:26:43.811670 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:26:43.941447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:26:43.941447 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:26:44.114616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:26:44.137601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509B84130>]}
[0m03:26:44.230531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215089C1B50>]}
[0m03:26:44.230531 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:26:44.231533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509B5EC40>]}
[0m03:26:44.233542 [info ] [MainThread]: 
[0m03:26:44.233974 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:26:44.239015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:26:44.301315 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:26:44.301315 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:26:44.301315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:44.334891 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:26:44.334891 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:26:44.342584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:26:44.348606 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:26:44.349609 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:26:44.349609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:26:44.388254 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.388254 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:26:44.388254 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:26:44.394453 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:26:44.394453 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:26:44.394453 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:26:44.394453 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:44.394453 [debug] [MainThread]: On master: BEGIN
[0m03:26:44.394453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:26:44.425757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.425757 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:44.425757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:26:44.441435 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:26:44.441435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509BA9580>]}
[0m03:26:44.441435 [debug] [MainThread]: On master: ROLLBACK
[0m03:26:44.441435 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:44.441435 [debug] [MainThread]: On master: BEGIN
[0m03:26:44.441435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.441435 [debug] [MainThread]: On master: COMMIT
[0m03:26:44.441435 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:44.441435 [debug] [MainThread]: On master: COMMIT
[0m03:26:44.441435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.441435 [debug] [MainThread]: On master: Close
[0m03:26:44.441435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:26:44.441435 [info ] [MainThread]: 
[0m03:26:44.453446 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:26:44.454462 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:26:44.455446 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:26:44.456451 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:26:44.466476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:26:44.468478 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:26:44.511596 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:26:44.512599 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.513578 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:26:44.513578 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:26:44.544904 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.544904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.544904 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:26:44.544904 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:26:44.554409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.554409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:26:44.554409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.554409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.554409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:26:44.554409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.617400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:26:44.617400 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.617400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:26:44.617400 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.617400 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:26:44.633253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:26:44.633253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:26:44.633253 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:44.633253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:26:44.643338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021506DC8730>]}
[0m03:26:44.643338 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.19s]
[0m03:26:44.643338 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:26:44.643338 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:26:44.647502 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:26:44.648522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:26:44.648522 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:26:44.652540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:26:44.653518 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:26:44.657531 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:26:44.658518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.659522 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:26:44.659522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:44.695516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.696524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.696524 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:26:44.703875 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:26:44.706890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.706890 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:26:44.707898 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.709891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.710950 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:26:44.710950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.710950 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:26:44.710950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.710950 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:26:44.710950 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.710950 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:26:44.710950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:26:44.710950 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:26:44.710950 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:44.710950 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:26:44.710950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509FFFF10>]}
[0m03:26:44.710950 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.06s]
[0m03:26:44.710950 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:26:44.710950 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:26:44.725148 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:26:44.725952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:26:44.726951 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:26:44.730947 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.731946 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:26:44.735455 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.737459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.737459 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:26:44.738463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:44.771508 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.771508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.772526 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:26:44.780501 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:26:44.784005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.785011 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:26:44.785011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.786152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.786152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:26:44.786152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.786152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:26:44.786152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.786152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:26:44.786152 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.786152 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:26:44.786152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:26:44.786152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:26:44.786152 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:44.786152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:26:44.786152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150A106910>]}
[0m03:26:44.786152 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.06s]
[0m03:26:44.802434 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:26:44.802434 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:26:44.803837 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:26:44.804844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:26:44.804844 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:26:44.808634 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:26:44.809634 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:26:44.813639 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:26:44.814634 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.815637 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:26:44.815637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:44.850185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.851188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.851188 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:26:44.858963 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:26:44.862118 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.862118 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:26:44.862118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.862118 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.862118 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:26:44.862118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.870141 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:26:44.870141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.870141 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:26:44.871806 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.873845 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:26:44.874838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:26:44.874838 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:26:44.877438 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:44.879474 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:26:44.879985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509A04C70>]}
[0m03:26:44.879985 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.08s]
[0m03:26:44.882009 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:26:44.882009 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:26:44.882997 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:26:44.882997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:26:44.884001 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:26:44.887018 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:26:44.887547 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:26:44.891565 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:26:44.892566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.893567 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:26:44.894552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:44.930559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:44.930559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.930559 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:26:44.937263 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:26:44.941269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.941269 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:26:44.942296 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.945291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.945291 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:26:44.946340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:44.946340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:26:44.946340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.946340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:26:44.949607 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:44.951621 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:26:44.952623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:26:44.952623 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:26:44.956624 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:44.959624 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:26:44.960637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150A00EA90>]}
[0m03:26:44.961623 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.08s]
[0m03:26:44.961623 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:26:44.962622 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:26:44.962622 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:26:44.963613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:26:44.964612 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:26:44.966616 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:26:44.967616 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:26:44.971619 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:26:44.972626 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:44.973625 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:26:44.973625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:45.008196 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:45.009190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:45.009190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:26:45.015106 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:26:45.019103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:45.019103 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:26:45.020104 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.022105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:45.023120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:26:45.024105 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.025097 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:26:45.026104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:45.026104 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:26:45.027104 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:45.029876 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:26:45.030874 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:26:45.030874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:26:45.033876 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:45.035875 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:26:45.035875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215099E9640>]}
[0m03:26:45.036880 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:26:45.037879 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:26:45.037879 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:45.038868 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:26:45.039867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:26:45.039867 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:45.042866 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.043867 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:45.047867 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.048868 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.049875 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:26:45.049875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:45.083634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:45.084634 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.084634 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:26:45.095151 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:26:45.099315 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.100340 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:26:45.101322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.103345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.104339 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:26:45.104339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.106326 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:26:45.106326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.106326 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:26:45.108322 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:45.110338 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:26:45.111339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:26:45.111339 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:26:45.114326 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:45.116338 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:26:45.116338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021509FFFF70>]}
[0m03:26:45.117325 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.08s]
[0m03:26:45.118325 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:26:45.118325 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:45.119325 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:26:45.120325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:26:45.120325 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:45.123324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:45.124350 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:45.128327 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:45.130326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:45.130326 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:26:45.130326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:45.164687 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:45.165717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:26:45.165717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.month,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
order by cs.total_sold desc
limit 10
  );
  
[0m03:26:45.167699 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column cs.month does not exist
LINE 31:     cs.month,
             ^

[0m03:26:45.167699 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:26:45.168698 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:26:45.168698 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column cs.month does not exist
  LINE 31:     cs.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:26:45.168698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215099642E0>]}
[0m03:26:45.168698 [error] [Thread-1  ]: 8 of 9 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.05s]
[0m03:26:45.168698 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:26:45.168698 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:45.174184 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:26:45.175216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:26:45.175216 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:45.179212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.179739 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:45.185251 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.186255 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.187265 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:26:45.187265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:26:45.223262 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:26:45.224282 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.225281 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:26:45.235878 [debug] [Thread-1  ]: SQL status: SELECT 1961 in 0.0 seconds
[0m03:26:45.239037 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.239037 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:26:45.239037 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.239037 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.239037 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:26:45.239037 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:26:45.239037 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:26:45.239037 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.239037 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:26:45.239037 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:26:45.239037 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:26:45.239037 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:26:45.239037 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:26:45.254663 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:26:45.254663 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:26:45.254663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc722fa3-ce28-49d2-b3ac-cd9a5ff6a64e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215099EB8E0>]}
[0m03:26:45.254663 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 1961[0m in 0.08s]
[0m03:26:45.254663 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:26:45.260094 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:45.260094 [debug] [MainThread]: On master: BEGIN
[0m03:26:45.261117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:26:45.297869 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:26:45.298880 [debug] [MainThread]: On master: COMMIT
[0m03:26:45.298880 [debug] [MainThread]: Using postgres connection "master"
[0m03:26:45.298880 [debug] [MainThread]: On master: COMMIT
[0m03:26:45.299881 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:26:45.299881 [debug] [MainThread]: On master: Close
[0m03:26:45.300868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:26:45.300868 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:26:45.301869 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:26:45.301869 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:26:45.301869 [info ] [MainThread]: 
[0m03:26:45.302868 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m03:26:45.304885 [debug] [MainThread]: Command end result
[0m03:26:45.337908 [info ] [MainThread]: 
[0m03:26:45.338884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:26:45.339884 [info ] [MainThread]: 
[0m03:26:45.339884 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column cs.month does not exist
  LINE 31:     cs.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:26:45.340892 [info ] [MainThread]: 
[0m03:26:45.342407 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m03:26:45.343427 [debug] [MainThread]: Command `dbt run` failed at 03:26:45.343427 after 1.80 seconds
[0m03:26:45.343427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215069FECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150A0130A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150A10CDC0>]}
[0m03:26:45.344425 [debug] [MainThread]: Flushing usage events
[0m03:27:09.639138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE512ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE7B83CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE7B833A0>]}


============================== 03:27:09.639991 | a2294f7b-846b-4763-a1ba-89289c7459ce ==============================
[0m03:27:09.639991 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:27:09.639991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:27:09.704645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:27:09.705645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE50031C0>]}
[0m03:27:09.706640 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:27:09.707172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE50031F0>]}
[0m03:27:09.820096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE5AAA850>]}
[0m03:27:09.865632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE7A5C070>]}
[0m03:27:09.867575 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:27:09.874587 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:27:10.020986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:27:10.020986 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:27:10.210251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:27:10.224277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE82D3130>]}
[0m03:27:10.318435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE82F2C70>]}
[0m03:27:10.319442 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:27:10.319442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE70F2B50>]}
[0m03:27:10.321437 [info ] [MainThread]: 
[0m03:27:10.322266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:27:10.327278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:27:10.384494 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:27:10.384494 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:27:10.384494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:10.425123 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:27:10.427116 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:27:10.429239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:27:10.431658 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:27:10.438445 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:27:10.438445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:27:10.471589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.471589 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:27:10.472606 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:27:10.477605 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:27:10.479615 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:27:10.480590 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:27:10.488121 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:10.489146 [debug] [MainThread]: On master: BEGIN
[0m03:27:10.489146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:27:10.520691 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.520691 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:10.521673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:27:10.530365 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:27:10.531579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE4E34B80>]}
[0m03:27:10.531579 [debug] [MainThread]: On master: ROLLBACK
[0m03:27:10.532988 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:10.533499 [debug] [MainThread]: On master: BEGIN
[0m03:27:10.534026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.534026 [debug] [MainThread]: On master: COMMIT
[0m03:27:10.534026 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:10.534026 [debug] [MainThread]: On master: COMMIT
[0m03:27:10.534026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:27:10.535526 [debug] [MainThread]: On master: Close
[0m03:27:10.535526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:27:10.536693 [info ] [MainThread]: 
[0m03:27:10.539706 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:27:10.540704 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:27:10.541700 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:27:10.541700 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:27:10.549044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:27:10.550020 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:27:10.587563 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:27:10.588548 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.588548 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:27:10.588548 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:27:10.620586 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.621563 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.621563 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:27:10.628569 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:27:10.635590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.636588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:27:10.636588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.640174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.640174 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:27:10.640174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.702546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:27:10.702546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.702546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:27:10.702546 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:10.702546 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:27:10.702546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:27:10.702546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:27:10.719299 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:10.722392 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:27:10.724380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE54F8730>]}
[0m03:27:10.724380 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.18s]
[0m03:27:10.726304 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:27:10.726304 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:27:10.727304 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:27:10.727304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:27:10.728304 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:27:10.731485 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:27:10.732505 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:27:10.736490 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:27:10.738493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.738493 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:27:10.739487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:10.776512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.777514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.777514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:27:10.784539 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:27:10.788536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.788536 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:27:10.788536 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.792102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.793079 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:27:10.793079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.795081 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:27:10.796076 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.796076 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:27:10.798082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:10.800086 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:27:10.801086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:27:10.802101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:27:10.805099 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:10.806122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:27:10.807092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE507C8E0>]}
[0m03:27:10.808114 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.08s]
[0m03:27:10.809099 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:27:10.809099 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:27:10.810092 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:27:10.811099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:27:10.811099 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:27:10.815091 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.816098 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:27:10.820625 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.821643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.821643 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:27:10.822661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:10.958292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:10.958292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.958292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:27:10.974830 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:27:10.984360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.984360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:27:10.984360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.984360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.984360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:27:10.984360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:10.989869 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:27:10.989869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.989869 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:27:10.989869 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:10.989869 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:27:10.989869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:27:10.989869 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:27:10.989869 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:10.989869 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:27:10.989869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8828DF0>]}
[0m03:27:10.989869 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.18s]
[0m03:27:10.989869 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:27:11.003917 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:27:11.004618 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:27:11.005638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:27:11.005638 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:27:11.009631 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:27:11.010624 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:27:11.014629 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:27:11.016140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.016140 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:27:11.017153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.052715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.053748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.053748 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:27:11.060594 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:27:11.063700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.063700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:27:11.063700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.063700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.063700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:27:11.063700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.063700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:27:11.063700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.063700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:27:11.063700 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.063700 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:27:11.063700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:27:11.063700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:27:11.063700 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.079548 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:27:11.079548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE54F8730>]}
[0m03:27:11.079548 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:27:11.079548 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:27:11.079548 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:27:11.083591 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:27:11.084605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:27:11.084605 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:27:11.087619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:27:11.088602 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:27:11.092299 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:27:11.093298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.093298 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:27:11.094296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.130646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.130646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.131646 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:27:11.135645 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:27:11.140273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:27:11.140273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.140273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:27:11.140273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:27:11.140273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:27:11.140273 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.140273 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:27:11.140273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:27:11.140273 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.140273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:27:11.155922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE86FEE80>]}
[0m03:27:11.155922 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:27:11.155922 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:27:11.155922 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:27:11.159441 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:27:11.160454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:27:11.161448 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:27:11.164469 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.164469 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:27:11.168628 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.170627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.170627 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:27:11.170627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.205129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.205129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.206129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:27:11.211107 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:27:11.214136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.215129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:27:11.215129 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.216804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.216804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:27:11.216804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.216804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:27:11.216804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.216804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:27:11.216804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.216804 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:27:11.216804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:27:11.216804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:27:11.216804 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.216804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:27:11.216804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE810F040>]}
[0m03:27:11.216804 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.06s]
[0m03:27:11.216804 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:27:11.232431 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:27:11.233185 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:27:11.234191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:27:11.234191 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:27:11.238203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.238203 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:27:11.242713 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.243748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.244727 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:27:11.244727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.277929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.279026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.279026 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:27:11.286060 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:27:11.289103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.289103 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:27:11.289103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.289103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.289103 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:27:11.289103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.289103 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:27:11.289103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.289103 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:27:11.289103 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.301688 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:27:11.301688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:27:11.301688 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:27:11.301688 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.301688 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:27:11.301688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE4FF7D60>]}
[0m03:27:11.301688 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.07s]
[0m03:27:11.301688 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:27:11.301688 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:27:11.312455 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:27:11.313461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:27:11.313461 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:27:11.317001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.318016 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:27:11.322019 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.323019 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.324019 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:27:11.324019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.360524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.361543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.361543 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
order by cs.total_sold desc
limit 10
  );
  
[0m03:27:11.372214 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:27:11.375250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.376303 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m03:27:11.376303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.376303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.376303 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m03:27:11.376303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.376303 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:27:11.376303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.376303 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:27:11.376303 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.376303 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m03:27:11.376303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:27:11.376303 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m03:27:11.376303 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.392215 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:27:11.392215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE810A6A0>]}
[0m03:27:11.392215 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.datamart_monthly_category_sold ........ [[32mSELECT 10[0m in 0.08s]
[0m03:27:11.392215 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:27:11.392215 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:27:11.395656 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:27:11.396911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:27:11.396911 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:27:11.399936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.400948 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:27:11.404492 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.406505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.406505 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:27:11.407493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:27:11.442052 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.442052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.442052 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
  );
  
[0m03:27:11.453043 [debug] [Thread-1  ]: SQL status: SELECT 1961 in 0.0 seconds
[0m03:27:11.454717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.454717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:27:11.454717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.454717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.454717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:27:11.454717 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:27:11.454717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:27:11.454717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.454717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:27:11.454717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.454717 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:27:11.454717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:27:11.454717 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:27:11.469924 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:27:11.469924 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:27:11.469924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2294f7b-846b-4763-a1ba-89289c7459ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8114490>]}
[0m03:27:11.469924 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 1961[0m in 0.07s]
[0m03:27:11.469924 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:27:11.477482 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:11.478491 [debug] [MainThread]: On master: BEGIN
[0m03:27:11.478491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:27:11.511866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:27:11.511866 [debug] [MainThread]: On master: COMMIT
[0m03:27:11.512890 [debug] [MainThread]: Using postgres connection "master"
[0m03:27:11.512890 [debug] [MainThread]: On master: COMMIT
[0m03:27:11.512890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:27:11.513891 [debug] [MainThread]: On master: Close
[0m03:27:11.513891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:27:11.513891 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:27:11.514868 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:27:11.514868 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:27:11.515865 [info ] [MainThread]: 
[0m03:27:11.515865 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m03:27:11.519399 [debug] [MainThread]: Command end result
[0m03:27:11.548963 [info ] [MainThread]: 
[0m03:27:11.550950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:27:11.551950 [info ] [MainThread]: 
[0m03:27:11.551950 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:27:11.553951 [debug] [MainThread]: Command `dbt run` succeeded at 03:27:11.553951 after 1.96 seconds
[0m03:27:11.553951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE512ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8201E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8142220>]}
[0m03:27:11.554950 [debug] [MainThread]: Flushing usage events
[0m03:28:12.841738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A66E111C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670BABD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670BABC40>]}


============================== 03:28:12.841738 | 17cab402-8608-43c7-aa8c-28b7e9e8af9d ==============================
[0m03:28:12.841738 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:28:12.841738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:28:12.912018 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:28:12.912018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A66DFE3160>]}
[0m03:28:12.912018 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:28:12.915117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A66DFE3190>]}
[0m03:28:13.027036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670B6C5E0>]}
[0m03:28:13.073556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670B77040>]}
[0m03:28:13.075549 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:28:13.084411 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:28:13.213414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:28:13.213414 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m03:28:13.405259 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:28:13.418738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6712C3130>]}
[0m03:28:13.508024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A671291580>]}
[0m03:28:13.508024 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:28:13.508024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6712E06A0>]}
[0m03:28:13.516482 [info ] [MainThread]: 
[0m03:28:13.518496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:28:13.523723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:28:13.578974 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:28:13.578974 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:28:13.578974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:13.622583 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:28:13.622583 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:28:13.622583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:28:13.629618 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:28:13.629618 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:28:13.629618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:13.667550 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:28:13.667550 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:28:13.667550 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:28:13.667550 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:28:13.667550 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:28:13.667550 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:28:13.682813 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:13.682813 [debug] [MainThread]: On master: BEGIN
[0m03:28:13.682813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:28:13.698325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:28:13.714681 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:13.714681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:28:13.722694 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:28:13.722694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670A2EDF0>]}
[0m03:28:13.722694 [debug] [MainThread]: On master: ROLLBACK
[0m03:28:13.722694 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:13.722694 [debug] [MainThread]: On master: BEGIN
[0m03:28:13.722694 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:28:13.722694 [debug] [MainThread]: On master: COMMIT
[0m03:28:13.722694 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:13.722694 [debug] [MainThread]: On master: COMMIT
[0m03:28:13.729838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:28:13.729838 [debug] [MainThread]: On master: Close
[0m03:28:13.729838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:28:13.729838 [info ] [MainThread]: 
[0m03:28:13.735048 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:28:13.736066 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:28:13.737060 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:28:13.737060 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:28:13.744474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:28:13.745474 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:28:13.781501 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:28:13.782502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.782502 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:28:13.782502 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:28:13.808320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:13.808320 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.808320 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:28:13.824565 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:28:13.824565 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.824565 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:28:13.824565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:13.834604 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.834604 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:28:13.834604 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:13.888129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:28:13.888129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.888129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:28:13.888129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:13.888129 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:28:13.888129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:28:13.888129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:28:13.888129 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:13.903229 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:28:13.903229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A66E4D76A0>]}
[0m03:28:13.903229 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.17s]
[0m03:28:13.903229 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:28:13.903229 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:28:13.903229 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:28:13.910391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:28:13.910791 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:28:13.913388 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:28:13.914384 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:28:13.918961 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:28:13.919968 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.919968 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:28:13.920966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:13.956997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:13.956997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.958011 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:28:13.963487 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:28:13.968534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.969519 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:28:13.970501 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:13.973108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.973108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:28:13.974164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:13.976179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:28:13.976179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.977176 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:28:13.977979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:13.980150 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:28:13.981270 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:28:13.981270 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:28:13.984151 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:13.985176 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:28:13.986178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A671721D30>]}
[0m03:28:13.987155 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.08s]
[0m03:28:13.988152 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:28:13.988152 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:28:13.989152 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:28:13.990151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:28:13.990151 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:28:13.993666 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:28:13.994662 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:28:14.000689 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.002661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.003661 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:28:14.003661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.038777 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.038777 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.038777 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:28:14.047770 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:28:14.050762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.050762 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:28:14.051762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.054761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.055761 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:28:14.056768 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.057785 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:28:14.058785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.058785 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:28:14.059769 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.061786 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:28:14.062785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:28:14.063795 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:28:14.066357 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.067387 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:28:14.068380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6717FF670>]}
[0m03:28:14.068380 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.08s]
[0m03:28:14.069357 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:28:14.070516 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:28:14.070516 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:28:14.070516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:28:14.070516 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:28:14.070516 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:28:14.070516 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:28:14.078439 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:28:14.079426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.079426 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:28:14.079426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.112974 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.112974 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.112974 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:28:14.120147 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:28:14.125710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.125710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:28:14.126760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.126760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.126760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:28:14.126760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.126760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:28:14.126760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.126760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:28:14.126760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.126760 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:28:14.126760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:28:14.126760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:28:14.126760 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.126760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:28:14.126760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6701097F0>]}
[0m03:28:14.126760 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.06s]
[0m03:28:14.142573 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:28:14.143096 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:28:14.143096 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:28:14.144127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:28:14.145138 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:28:14.148155 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:28:14.149155 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:28:14.152642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:28:14.153674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.153674 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:28:14.154655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.191910 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.191910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.192988 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:28:14.198908 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:28:14.202977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.202977 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:28:14.202977 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.202977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.202977 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:28:14.202977 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.202977 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:28:14.202977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.202977 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:28:14.202977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.202977 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:28:14.202977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:28:14.202977 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:28:14.202977 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.218602 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:28:14.218602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6712293A0>]}
[0m03:28:14.218602 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:28:14.218602 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:28:14.222494 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:28:14.223014 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:28:14.224026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:28:14.224026 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:28:14.227019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.228019 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:28:14.231525 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.233527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.233527 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:28:14.234526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.271526 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.271526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.272528 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:28:14.277692 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:28:14.281804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.281804 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:28:14.282701 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.285755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.285755 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:28:14.285755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.285755 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:28:14.285755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.285755 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:28:14.285755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.285755 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:28:14.292273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:28:14.292273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:28:14.292273 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.292273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:28:14.292273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6711051C0>]}
[0m03:28:14.292273 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:28:14.292273 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:28:14.292273 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:28:14.299849 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:28:14.300873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:28:14.300873 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:28:14.304890 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.305880 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:28:14.308908 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.309920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.310890 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:28:14.310890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.344961 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.344961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.345959 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:28:14.354625 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:28:14.356702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.356702 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:28:14.356702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.356702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.356702 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:28:14.356702 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.356702 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:28:14.356702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.356702 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:28:14.356702 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.356702 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:28:14.356702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:28:14.356702 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:28:14.372572 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.372572 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:28:14.372572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6712293A0>]}
[0m03:28:14.372572 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.07s]
[0m03:28:14.372572 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:28:14.372572 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:28:14.378238 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:28:14.379250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:28:14.379250 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:28:14.382764 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.383794 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:28:14.387768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.389769 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.390768 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:28:14.390768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.522840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.522840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.529374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
order by cs.total_sold desc
limit 10
  );
  
[0m03:28:14.534883 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:28:14.534883 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.534883 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m03:28:14.534883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.534883 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.534883 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m03:28:14.534883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.534883 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:28:14.550537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.550655 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:28:14.551183 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.551183 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m03:28:14.551183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:28:14.551183 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m03:28:14.551183 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.551183 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:28:14.551183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6711079D0>]}
[0m03:28:14.551183 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.datamart_monthly_category_sold ........ [[32mSELECT 10[0m in 0.17s]
[0m03:28:14.551183 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:28:14.551183 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:28:14.551183 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:28:14.564074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:28:14.565087 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:28:14.568109 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.569117 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:28:14.573103 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.574087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.574087 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:28:14.574087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:28:14.610712 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.610712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.611736 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
limit 10
  );
  
[0m03:28:14.619793 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:28:14.622824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.622824 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:28:14.622824 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.622824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.622824 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:28:14.622824 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:28:14.622824 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:28:14.622824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.622824 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:28:14.622824 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.622824 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:28:14.622824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:28:14.622824 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:28:14.636014 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:28:14.636014 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:28:14.636014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cab402-8608-43c7-aa8c-28b7e9e8af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6711069A0>]}
[0m03:28:14.636014 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 10[0m in 0.07s]
[0m03:28:14.636014 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:28:14.644949 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:14.644949 [debug] [MainThread]: On master: BEGIN
[0m03:28:14.644949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:28:14.679693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:28:14.680711 [debug] [MainThread]: On master: COMMIT
[0m03:28:14.680711 [debug] [MainThread]: Using postgres connection "master"
[0m03:28:14.680711 [debug] [MainThread]: On master: COMMIT
[0m03:28:14.680711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:28:14.681685 [debug] [MainThread]: On master: Close
[0m03:28:14.682686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:14.683013 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:28:14.683013 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:28:14.683685 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:28:14.683685 [info ] [MainThread]: 
[0m03:28:14.684688 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m03:28:14.686693 [debug] [MainThread]: Command end result
[0m03:28:14.715209 [info ] [MainThread]: 
[0m03:28:14.716219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:28:14.717212 [info ] [MainThread]: 
[0m03:28:14.718232 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:28:14.719211 [debug] [MainThread]: Command `dbt run` succeeded at 03:28:14.719211 after 1.91 seconds
[0m03:28:14.720251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A66E111C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A671752760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67137EE50>]}
[0m03:28:14.720251 [debug] [MainThread]: Flushing usage events
[0m03:29:08.448675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717D0E2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717DA27AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717FB47D00>]}


============================== 03:29:08.452286 | fd1fdbd1-34b3-4570-a050-ff5dede15189 ==============================
[0m03:29:08.452286 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:08.452964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m03:29:08.513200 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:08.514190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CFB3160>]}
[0m03:29:08.515196 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:08.516197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717CFB3190>]}
[0m03:29:08.625555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717DA531F0>]}
[0m03:29:08.669742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717FB3D730>]}
[0m03:29:08.671671 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:29:08.679706 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:08.819650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:29:08.820517 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:29:08.988790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:29:09.008218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017100293130>]}
[0m03:29:09.093372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171002B1700>]}
[0m03:29:09.093372 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:29:09.093372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171000B2A30>]}
[0m03:29:09.098788 [info ] [MainThread]: 
[0m03:29:09.099792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:29:09.104794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:29:09.163201 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:29:09.163201 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:29:09.163201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:09.202324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:29:09.202324 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:29:09.202324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:29:09.212404 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:09.213397 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:29:09.213397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:09.243016 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.243016 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:09.244021 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:29:09.249600 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:29:09.250598 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:29:09.251582 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:29:09.258581 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:09.258581 [debug] [MainThread]: On master: BEGIN
[0m03:29:09.258581 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:29:09.289183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.289183 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:09.290206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:29:09.297203 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:29:09.298732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710010BF40>]}
[0m03:29:09.299735 [debug] [MainThread]: On master: ROLLBACK
[0m03:29:09.299735 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:09.300762 [debug] [MainThread]: On master: BEGIN
[0m03:29:09.300762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.300762 [debug] [MainThread]: On master: COMMIT
[0m03:29:09.301760 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:09.301760 [debug] [MainThread]: On master: COMMIT
[0m03:29:09.301760 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.301760 [debug] [MainThread]: On master: Close
[0m03:29:09.302760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:09.303743 [info ] [MainThread]: 
[0m03:29:09.305761 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:29:09.306736 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:29:09.307761 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:29:09.307761 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:29:09.314760 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:29:09.315762 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:29:09.352300 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:29:09.353312 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.353312 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:29:09.354299 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:29:09.390492 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.391549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.391549 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:29:09.397448 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:29:09.403738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.403738 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:29:09.403738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.403738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.403738 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:29:09.403738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.467778 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:09.467778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.468760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:09.469913 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.475061 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:29:09.479056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:09.480040 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:29:09.483040 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.485108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:29:09.487111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717D4A8640>]}
[0m03:29:09.487111 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.18s]
[0m03:29:09.488111 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:29:09.489102 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:29:09.489102 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:29:09.490112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:29:09.491111 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:29:09.493109 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:29:09.494109 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:29:09.498114 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:29:09.499113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.499113 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:29:09.499113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.533817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.533817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.534816 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:29:09.541534 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:29:09.544552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.544552 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:29:09.545552 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.548560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.548560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:29:09.549531 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.551550 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:09.551550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.551550 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:09.552548 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.555558 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:29:09.555558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:09.556505 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:29:09.556505 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.556505 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:29:09.556505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171006EFCD0>]}
[0m03:29:09.556505 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.07s]
[0m03:29:09.556505 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:29:09.563383 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:29:09.563383 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:29:09.564391 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:29:09.564391 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:29:09.568389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.569389 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:29:09.574480 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.575485 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.575485 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:29:09.576389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.609649 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.610673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.610673 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:29:09.616210 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:29:09.619212 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.619212 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:29:09.620229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.623230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.623230 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:29:09.624210 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.626215 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:09.626215 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.626215 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:09.627213 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.629779 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:29:09.630774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:09.630774 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:29:09.632863 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.632863 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:29:09.632863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171007C5C70>]}
[0m03:29:09.632863 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m03:29:09.632863 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:29:09.632863 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:29:09.632863 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:29:09.639807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:29:09.639807 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:29:09.642821 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:29:09.643822 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:29:09.647825 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:29:09.647825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.648824 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:29:09.648824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.685398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.685398 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.685398 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:29:09.694104 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:29:09.698124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.698124 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:29:09.699120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.701271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.702328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:29:09.702328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.702328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:09.702328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.702328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:09.702328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.702328 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:29:09.702328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:09.702328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:29:09.702328 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.702328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:29:09.702328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BF8AF10>]}
[0m03:29:09.702328 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.06s]
[0m03:29:09.702328 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:29:09.702328 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:29:09.717212 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:29:09.718340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:29:09.719229 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:29:09.722241 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:29:09.723224 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:29:09.726244 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:29:09.727254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.728807 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:29:09.728807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.763466 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.764491 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.764491 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:29:09.771477 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:29:09.774494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.775488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:29:09.775488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.778471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.778471 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:29:09.779561 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.779561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:09.779561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.779561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:09.779561 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.779561 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:29:09.779561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:09.779561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:29:09.779561 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.779561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:29:09.779561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171000D0730>]}
[0m03:29:09.779561 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.06s]
[0m03:29:09.779561 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:29:09.779561 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:29:09.794826 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:29:09.795852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:29:09.795852 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:29:09.799353 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.799353 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:29:09.803367 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.804369 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.804369 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:29:09.805395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.842490 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.842490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.843522 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:29:09.849510 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:29:09.849510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.849510 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:29:09.849510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.849510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.849510 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:29:09.849510 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.849510 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:09.849510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.849510 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:09.849510 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.849510 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:29:09.849510 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:09.849510 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:29:09.865146 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.865146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:29:09.865146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717BF8AF10>]}
[0m03:29:09.865146 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:29:09.865146 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:29:09.865146 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:09.871854 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:29:09.872873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:29:09.872873 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:09.876875 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.877874 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:09.882864 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.885863 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.885863 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:29:09.886863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:09.924631 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:09.925633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.925633 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:29:09.931671 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:09.937256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.937256 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:29:09.937256 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.937256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.937256 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:29:09.937256 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:09.937256 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:09.937256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.937256 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:09.937256 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:09.947794 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:29:09.947794 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:09.947794 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:29:09.947794 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:09.947794 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:29:09.947794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171000E2A00>]}
[0m03:29:09.947794 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.07s]
[0m03:29:09.947794 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:09.947794 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:09.959825 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:29:09.960832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:29:09.960832 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:09.964831 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:09.964831 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:09.968831 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:09.970832 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:09.970832 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:29:09.971831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:10.008589 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:10.008589 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:10.009609 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
group by cs.category_id
order by cs.total_sold desc
limit 10
  );
  
[0m03:29:10.012622 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cn.category_name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 30:     cn.category_name,
             ^

[0m03:29:10.012622 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:29:10.013621 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:29:10.016615 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cn.category_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 30:     cn.category_name,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:10.016615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171000E2A00>]}
[0m03:29:10.017614 [error] [Thread-1  ]: 8 of 9 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.06s]
[0m03:29:10.018615 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:10.018615 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:10.019640 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:29:10.020615 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:29:10.020615 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:10.023375 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.024375 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:10.030364 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.030364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.031869 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:29:10.031869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:10.067885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:10.068943 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.068943 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
limit 10
  );
  
[0m03:29:10.077891 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:10.079513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.079513 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:10.079513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:10.079513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.079513 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:29:10.079513 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:10.079513 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:10.079513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.079513 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:10.079513 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:10.079513 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:10.079513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:10.079513 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:29:10.095146 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:10.095146 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:29:10.095146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1fdbd1-34b3-4570-a050-ff5dede15189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171006BCFD0>]}
[0m03:29:10.095146 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 10[0m in 0.08s]
[0m03:29:10.095146 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:10.100399 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:10.101404 [debug] [MainThread]: On master: BEGIN
[0m03:29:10.101404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:29:10.136976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:10.136976 [debug] [MainThread]: On master: COMMIT
[0m03:29:10.138006 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:10.138006 [debug] [MainThread]: On master: COMMIT
[0m03:29:10.138006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:10.138987 [debug] [MainThread]: On master: Close
[0m03:29:10.138987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:10.138987 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:29:10.139982 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:29:10.139982 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:29:10.140981 [info ] [MainThread]: 
[0m03:29:10.140981 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m03:29:10.142984 [debug] [MainThread]: Command end result
[0m03:29:10.170013 [info ] [MainThread]: 
[0m03:29:10.170990 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:29:10.170990 [info ] [MainThread]: 
[0m03:29:10.172626 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cn.category_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 30:     cn.category_name,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:10.173634 [info ] [MainThread]: 
[0m03:29:10.174631 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m03:29:10.176631 [debug] [MainThread]: Command `dbt run` failed at 03:29:10.176631 after 1.77 seconds
[0m03:29:10.176631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717D0E2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001717F6B7E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171002B1700>]}
[0m03:29:10.177661 [debug] [MainThread]: Flushing usage events
[0m03:29:30.061656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F984DE1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98787CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98787CC40>]}


============================== 03:29:30.061656 | b349848c-8791-479b-9698-9fcc4dff6174 ==============================
[0m03:29:30.061656 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:30.061656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:29:30.128882 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:30.130566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F984CB3160>]}
[0m03:29:30.131599 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:30.131599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F984CB3190>]}
[0m03:29:30.253584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98783D5E0>]}
[0m03:29:30.303485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987846040>]}
[0m03:29:30.304512 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:29:30.312483 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:30.438540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:29:30.438540 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:29:30.607416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:29:30.636819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987F66130>]}
[0m03:29:30.746040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987F8F580>]}
[0m03:29:30.746040 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:29:30.746040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987F3F6A0>]}
[0m03:29:30.749866 [info ] [MainThread]: 
[0m03:29:30.751880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:29:30.756898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:29:30.806668 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:29:30.806668 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:29:30.806668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:30.839321 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:29:30.839321 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:29:30.839321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:29:30.854326 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:30.854326 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:29:30.854326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:30.885618 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:29:30.885618 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:30.885618 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:29:30.885618 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:29:30.885618 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:29:30.885618 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:29:30.902031 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:30.903037 [debug] [MainThread]: On master: BEGIN
[0m03:29:30.903037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:29:30.934598 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:30.934598 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:30.934598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:29:30.943038 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:29:30.943038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9876FFDF0>]}
[0m03:29:30.943038 [debug] [MainThread]: On master: ROLLBACK
[0m03:29:30.943038 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:30.943038 [debug] [MainThread]: On master: BEGIN
[0m03:29:30.943038 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:30.943038 [debug] [MainThread]: On master: COMMIT
[0m03:29:30.943038 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:30.943038 [debug] [MainThread]: On master: COMMIT
[0m03:29:30.943038 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:30.943038 [debug] [MainThread]: On master: Close
[0m03:29:30.943038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:30.943038 [info ] [MainThread]: 
[0m03:29:30.952752 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:29:30.953773 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:29:30.954746 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:29:30.954746 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:29:30.961745 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:29:30.962745 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:29:30.999322 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:29:31.000314 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.000314 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:29:31.001292 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:29:31.031807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.031807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.031807 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:29:31.031807 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:29:31.041317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.041317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:29:31.041317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.046844 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.046844 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:29:31.046844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.109874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:31.109874 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.109874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:31.109874 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.109874 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:29:31.109874 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:31.109874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:29:31.109874 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.125489 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:29:31.125489 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9883D1BB0>]}
[0m03:29:31.125489 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.17s]
[0m03:29:31.125489 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:29:31.125489 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:29:31.125489 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:29:31.132073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:29:31.132073 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:29:31.136105 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:29:31.136105 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:29:31.139704 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:29:31.140734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.141741 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:29:31.141741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.176628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.177655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.177655 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:29:31.184126 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:29:31.187148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.188150 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:29:31.189139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.191155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.192148 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:29:31.193133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.194151 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:31.194151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.195241 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:31.195241 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.195241 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:29:31.195241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:31.195241 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:29:31.195241 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.195241 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:29:31.195241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9884E0460>]}
[0m03:29:31.195241 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.06s]
[0m03:29:31.195241 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:29:31.195241 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:29:31.195241 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:29:31.207015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:29:31.208028 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:29:31.212309 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.213307 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:29:31.217326 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.218345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.219320 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:29:31.219320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.254584 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.255955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.255955 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:29:31.262965 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:29:31.265989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.265989 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:29:31.266965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.268988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.269982 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:29:31.269982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.272112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:31.272112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.272112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:31.272112 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.272112 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:29:31.272112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:31.272112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:29:31.272112 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.272112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:29:31.272112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987BD6190>]}
[0m03:29:31.281117 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m03:29:31.281117 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:29:31.281117 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:29:31.281117 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:29:31.283707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:29:31.284743 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:29:31.287725 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:29:31.288726 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:29:31.292723 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:29:31.293725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.294739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:29:31.294739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.330537 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.330537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.330537 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:29:31.338318 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:29:31.342892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.342892 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:29:31.343903 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.345925 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.345925 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:29:31.347897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.349003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:31.349003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.349003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:31.349003 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.349003 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:29:31.349003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:31.349003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:29:31.349003 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.349003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:29:31.349003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987BD6190>]}
[0m03:29:31.349003 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:29:31.349003 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:29:31.349003 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:29:31.362086 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:29:31.362789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:29:31.363795 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:29:31.366800 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:29:31.366800 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:29:31.370936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:29:31.371935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.371935 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:29:31.372951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.408464 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.409450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.409450 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:29:31.415570 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:29:31.417594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.417594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:29:31.417594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.417594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.417594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:29:31.417594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.417594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:31.417594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.417594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:31.417594 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.417594 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:29:31.417594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:31.417594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:29:31.432314 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.433319 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:29:31.433319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988410F10>]}
[0m03:29:31.433319 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:29:31.433319 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:29:31.433319 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:29:31.438517 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:29:31.439531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:29:31.439531 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:29:31.442522 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.443063 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:29:31.447068 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.447068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.448067 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:29:31.448067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.484089 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.484089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.484089 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:29:31.490226 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:29:31.490226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.490226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:29:31.490226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.490226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.490226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:29:31.490226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.490226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:31.490226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.490226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:31.490226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.503761 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:29:31.503761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:31.503761 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:29:31.503761 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.503761 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:29:31.503761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987DCAAC0>]}
[0m03:29:31.503761 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:29:31.503761 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:29:31.503761 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:31.513428 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:29:31.514455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:29:31.514455 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:31.517457 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.518484 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:31.522471 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.523467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.524469 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:29:31.524469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.561577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.561577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.562595 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:29:31.572189 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:31.577225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:29:31.577225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.577225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:29:31.577225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:31.577225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:31.577225 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.577225 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:29:31.577225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:29:31.577225 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.577225 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:29:31.577225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988410F10>]}
[0m03:29:31.593331 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.06s]
[0m03:29:31.593331 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:31.593331 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:31.595735 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:29:31.596751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:29:31.596751 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:31.601170 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:31.602182 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:31.606723 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:31.607713 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:31.608713 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:29:31.608713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.647310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.648313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:31.648313 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
group by cs.category_id, cn.category_name
order by cs.total_sold desc
limit 10
  );
  
[0m03:29:31.650328 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cs.order_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 31:     cs.order_date,
             ^

[0m03:29:31.650328 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:29:31.651314 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:29:31.654315 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cs.order_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 31:     cs.order_date,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:31.654315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988410F10>]}
[0m03:29:31.655314 [error] [Thread-1  ]: 8 of 9 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.06s]
[0m03:29:31.656314 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:31.656314 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:31.657294 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:29:31.658342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:29:31.658342 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:31.662280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.663468 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:31.668966 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.669971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.669971 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:29:31.670979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:31.717092 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.717092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.717092 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
limit 10
  );
  
[0m03:29:31.717092 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:31.732891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.732891 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:31.732891 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.732891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.732891 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:29:31.732891 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:31.742906 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:31.742906 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.742906 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:31.742906 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.748424 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:31.748424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:31.748424 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:29:31.748424 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:31.748424 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:29:31.748424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b349848c-8791-479b-9698-9fcc4dff6174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F987DE4730>]}
[0m03:29:31.748424 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 10[0m in 0.09s]
[0m03:29:31.748424 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:31.759044 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:31.760054 [debug] [MainThread]: On master: BEGIN
[0m03:29:31.760054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:29:31.797427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:31.797951 [debug] [MainThread]: On master: COMMIT
[0m03:29:31.797951 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:31.797951 [debug] [MainThread]: On master: COMMIT
[0m03:29:31.798980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:31.798980 [debug] [MainThread]: On master: Close
[0m03:29:31.799981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:31.799981 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:29:31.800963 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:29:31.800963 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:29:31.800963 [info ] [MainThread]: 
[0m03:29:31.802958 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m03:29:31.804965 [debug] [MainThread]: Command end result
[0m03:29:31.835559 [info ] [MainThread]: 
[0m03:29:31.836579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:29:31.837569 [info ] [MainThread]: 
[0m03:29:31.838575 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cs.order_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 31:     cs.order_date,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:31.839577 [info ] [MainThread]: 
[0m03:29:31.840578 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m03:29:31.842589 [debug] [MainThread]: Command `dbt run` failed at 03:29:31.842589 after 1.82 seconds
[0m03:29:31.843592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F984DE1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988493250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9884931F0>]}
[0m03:29:31.843592 [debug] [MainThread]: Flushing usage events
[0m03:29:52.198396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D2264ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D250B7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22FCA790>]}


============================== 03:29:52.213407 | 0cb3b82f-79db-4614-b55b-0e286fc201b1 ==============================
[0m03:29:52.213407 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:29:52.213407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:29:52.272216 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:52.272216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22520190>]}
[0m03:29:52.272216 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:29:52.282807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D225201C0>]}
[0m03:29:52.404162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D250A2D90>]}
[0m03:29:52.449331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D225358E0>]}
[0m03:29:52.451184 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:29:52.458339 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:29:52.588094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:29:52.588094 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:29:52.771714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:29:52.785916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D257D4130>]}
[0m03:29:52.889264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D257F8E80>]}
[0m03:29:52.889264 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:29:52.889264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D257FFA00>]}
[0m03:29:52.893815 [info ] [MainThread]: 
[0m03:29:52.894846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:29:52.899829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:29:52.946480 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:29:52.946480 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:29:52.946480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:52.994045 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:29:52.994045 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:29:52.999748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:29:53.005785 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:53.005785 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:29:53.006781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:29:53.033731 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.033731 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:29:53.033731 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:29:53.039885 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:29:53.039885 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:29:53.039885 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:29:53.039885 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:53.039885 [debug] [MainThread]: On master: BEGIN
[0m03:29:53.039885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:29:53.082889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.083915 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:53.084135 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:29:53.084135 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:29:53.084135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D24F6E130>]}
[0m03:29:53.084135 [debug] [MainThread]: On master: ROLLBACK
[0m03:29:53.084135 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:53.084135 [debug] [MainThread]: On master: BEGIN
[0m03:29:53.084135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.084135 [debug] [MainThread]: On master: COMMIT
[0m03:29:53.084135 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:53.084135 [debug] [MainThread]: On master: COMMIT
[0m03:29:53.084135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.084135 [debug] [MainThread]: On master: Close
[0m03:29:53.084135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:29:53.084135 [info ] [MainThread]: 
[0m03:29:53.100362 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:29:53.101441 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:29:53.102360 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:29:53.102360 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:29:53.109363 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:29:53.110360 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:29:53.146354 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:29:53.147340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.147340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:29:53.148361 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:29:53.169601 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.169601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.169601 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:29:53.185639 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:29:53.185639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.185639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:29:53.185639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.185639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.185639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:29:53.185639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.249245 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:53.249245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.249245 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:29:53.249245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.249245 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:29:53.249245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:29:53.249245 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:29:53.264765 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.264765 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:29:53.264765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22A18700>]}
[0m03:29:53.264765 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.16s]
[0m03:29:53.264765 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:29:53.264765 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:29:53.274162 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:29:53.275179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:29:53.275179 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:29:53.278192 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:29:53.279186 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:29:53.283180 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:29:53.284179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.285177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:29:53.286197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.323723 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.324739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.324739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:29:53.330904 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:29:53.333938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.334933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:29:53.334933 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.337937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.338468 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:29:53.338468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.340501 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:53.340501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.341501 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:29:53.341562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.341562 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:29:53.341562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:29:53.341562 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:29:53.341562 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.341562 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:29:53.341562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25D4F430>]}
[0m03:29:53.341562 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.07s]
[0m03:29:53.341562 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:29:53.341562 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:29:53.341562 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:29:53.353739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:29:53.353739 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:29:53.357749 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.358751 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:29:53.362734 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.363758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.364739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:29:53.364739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.399522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.400537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.400537 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:29:53.405538 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:29:53.409545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.409545 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:29:53.410519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.412533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.413543 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:29:53.413543 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.415534 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:53.415534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.416536 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:29:53.417517 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.418612 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:29:53.418612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:29:53.418612 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:29:53.418612 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.418612 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:29:53.418612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D22A18700>]}
[0m03:29:53.418612 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.07s]
[0m03:29:53.418612 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:29:53.418612 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:29:53.428401 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:29:53.429415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:29:53.429415 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:29:53.432428 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:29:53.433418 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:29:53.437417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:29:53.439437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.440409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:29:53.440409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.476872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.477898 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.477898 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:29:53.484864 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:29:53.489508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.489508 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:29:53.489508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.489508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.489508 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:29:53.489508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.489508 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:53.489508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.489508 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:29:53.489508 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.489508 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:29:53.489508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:29:53.489508 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:29:53.489508 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.504042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:29:53.504042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25660580>]}
[0m03:29:53.504042 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:29:53.504042 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:29:53.504042 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:29:53.507799 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:29:53.508806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:29:53.508806 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:29:53.511804 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:29:53.512805 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:29:53.515804 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:29:53.516804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.517805 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:29:53.517805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.553352 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.553352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.554370 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:29:53.556352 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:29:53.556352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.556352 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:29:53.556352 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.564933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.564933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:29:53.564933 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.564933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:53.564933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.564933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:29:53.564933 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.572588 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:29:53.572588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:29:53.572588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:29:53.572588 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.572588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:29:53.572588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25C17EE0>]}
[0m03:29:53.572588 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.06s]
[0m03:29:53.572588 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:29:53.572588 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:29:53.582158 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:29:53.582673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:29:53.583684 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:29:53.586706 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.587701 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:29:53.591678 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.593680 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.593680 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:29:53.594678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.630079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.630079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.631109 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:29:53.637011 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:29:53.641000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.641000 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:29:53.642163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.644169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.645168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:29:53.645168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.647168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:53.647168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.647168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:29:53.648285 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.648285 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:29:53.648285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:29:53.648285 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:29:53.648285 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.648285 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:29:53.648285 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25C3E4F0>]}
[0m03:29:53.648285 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:29:53.648285 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:29:53.648285 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:53.648285 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:29:53.659111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:29:53.660129 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:53.663127 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.664126 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:53.667667 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.668663 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.669653 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:29:53.669653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.706818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.707835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.707835 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:29:53.717769 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:53.722807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.722807 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:29:53.723794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.724867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.724867 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:29:53.724867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.724867 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:53.724867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.724867 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:29:53.724867 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.732395 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:29:53.732395 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:29:53.732395 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:29:53.732395 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.732395 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:29:53.732395 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D255B4730>]}
[0m03:29:53.732395 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.07s]
[0m03:29:53.740907 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:29:53.741538 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:53.741538 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:29:53.742543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:29:53.743548 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:53.746566 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:53.747565 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:53.752552 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:53.753547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:53.754570 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:29:53.754570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.790603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.791624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:29:53.791624 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
group by cs.category_id, cn.category_name, cs.order_date
order by cs.total_sold desc
limit 10
  );
  
[0m03:29:53.793623 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "cs.total_sold" must appear in the GROUP BY clause or be used in an aggregate function
LINE 32:     cs.total_sold
             ^

[0m03:29:53.793623 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m03:29:53.794628 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:29:53.797623 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cs.total_sold" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 32:     cs.total_sold
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:53.797623 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25C17EE0>]}
[0m03:29:53.798621 [error] [Thread-1  ]: 8 of 9 ERROR creating sql table model public.datamart_monthly_category_sold .... [[31mERROR[0m in 0.06s]
[0m03:29:53.799607 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:29:53.799607 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:53.800624 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:29:53.800624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:29:53.801607 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:53.804622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.805636 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:53.810503 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.811503 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.811503 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:29:53.812510 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:29:53.848053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:29:53.849083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.849083 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
limit 10
  );
  
[0m03:29:53.855124 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:29:53.855124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.855124 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:53.855124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.865154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.865154 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:29:53.865154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:29:53.865154 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:53.865154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.865154 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:29:53.865154 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:29:53.871837 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:29:53.872871 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:29:53.872871 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:29:53.875731 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:29:53.876667 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:29:53.877666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cb3b82f-79db-4614-b55b-0e286fc201b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25C5DEE0>]}
[0m03:29:53.878666 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 10[0m in 0.08s]
[0m03:29:53.879666 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:29:53.880738 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:53.881668 [debug] [MainThread]: On master: BEGIN
[0m03:29:53.881668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:29:54.009940 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:29:54.009940 [debug] [MainThread]: On master: COMMIT
[0m03:29:54.009940 [debug] [MainThread]: Using postgres connection "master"
[0m03:29:54.009940 [debug] [MainThread]: On master: COMMIT
[0m03:29:54.009940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:29:54.009940 [debug] [MainThread]: On master: Close
[0m03:29:54.009940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:29:54.009940 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:29:54.009940 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:29:54.009940 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:29:54.009940 [info ] [MainThread]: 
[0m03:29:54.009940 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m03:29:54.024107 [debug] [MainThread]: Command end result
[0m03:29:54.052677 [info ] [MainThread]: 
[0m03:29:54.053676 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:29:54.053676 [info ] [MainThread]: 
[0m03:29:54.054676 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  column "cs.total_sold" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 32:     cs.total_sold
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m03:29:54.055675 [info ] [MainThread]: 
[0m03:29:54.055675 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m03:29:54.058675 [debug] [MainThread]: Command `dbt run` failed at 03:29:54.057700 after 1.89 seconds
[0m03:29:54.058675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D2264ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25D3E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D25D3EFD0>]}
[0m03:29:54.059696 [debug] [MainThread]: Flushing usage events
[0m03:30:08.486893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015870A01C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587349CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587349CC40>]}


============================== 03:30:08.490397 | 8c01d2d1-b922-4e1c-8573-8cf5bfec565f ==============================
[0m03:30:08.490397 [info ] [MainThread]: Running with dbt=1.8.2
[0m03:30:08.491402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:30:08.553438 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:30:08.554440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158708D3160>]}
[0m03:30:08.554440 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:30:08.555445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158708D3190>]}
[0m03:30:08.669605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587345D5E0>]}
[0m03:30:08.716729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873467040>]}
[0m03:30:08.718540 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m03:30:08.726546 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m03:30:08.872578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:30:08.873578 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m03:30:09.044319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m03:30:09.063603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873BA3130>]}
[0m03:30:09.137857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873B70580>]}
[0m03:30:09.137857 [info ] [MainThread]: Found 9 models, 6 sources, 413 macros
[0m03:30:09.152909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873BC16A0>]}
[0m03:30:09.154364 [info ] [MainThread]: 
[0m03:30:09.155376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:30:09.160374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m03:30:09.209474 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m03:30:09.209474 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m03:30:09.209474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:09.256459 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m03:30:09.256459 [debug] [ThreadPool]: On list_db_project_2: Close
[0m03:30:09.256459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m03:30:09.256459 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:30:09.256459 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m03:30:09.256459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:30:09.294305 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.294305 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m03:30:09.294305 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:30:09.294305 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m03:30:09.294305 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m03:30:09.294305 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m03:30:09.309935 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:09.309935 [debug] [MainThread]: On master: BEGIN
[0m03:30:09.309935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:30:09.341453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.341453 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:09.341453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:30:09.341453 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m03:30:09.341453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587331E3A0>]}
[0m03:30:09.341453 [debug] [MainThread]: On master: ROLLBACK
[0m03:30:09.341453 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:09.341453 [debug] [MainThread]: On master: BEGIN
[0m03:30:09.341453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.341453 [debug] [MainThread]: On master: COMMIT
[0m03:30:09.341453 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:09.341453 [debug] [MainThread]: On master: COMMIT
[0m03:30:09.341453 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.341453 [debug] [MainThread]: On master: Close
[0m03:30:09.341453 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:30:09.341453 [info ] [MainThread]: 
[0m03:30:09.359275 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m03:30:09.360276 [info ] [Thread-1  ]: 1 of 9 START sql table model public.stg_categories ............................. [RUN]
[0m03:30:09.361282 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m03:30:09.361282 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m03:30:09.369284 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m03:30:09.370288 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m03:30:09.416308 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m03:30:09.417323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.417323 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m03:30:09.418322 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m03:30:09.435092 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.435092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.435092 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with categories as (
    select * from "db_project_2"."public"."categories"
)

select * from categories
  );
  
[0m03:30:09.450795 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m03:30:09.450795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.450795 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m03:30:09.450795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.450795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.466380 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m03:30:09.466380 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.513756 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:30:09.513756 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.513756 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m03:30:09.513756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.513756 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m03:30:09.529569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m03:30:09.529569 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m03:30:09.529569 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:09.529569 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m03:30:09.539583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873FF1BB0>]}
[0m03:30:09.539583 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.stg_categories ........................ [[32mSELECT 8[0m in 0.17s]
[0m03:30:09.539583 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m03:30:09.539583 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m03:30:09.539583 [info ] [Thread-1  ]: 2 of 9 START sql table model public.stg_employees .............................. [RUN]
[0m03:30:09.543332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m03:30:09.543332 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m03:30:09.547601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m03:30:09.548276 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m03:30:09.552154 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m03:30:09.552867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.553383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m03:30:09.553383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:09.708541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.708541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.708541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with employees as (
    select * from "db_project_2"."public"."employees"
)

select * from employees
  );
  
[0m03:30:09.708541 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m03:30:09.708541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.708541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m03:30:09.708541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.724328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.724328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m03:30:09.724328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.724328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:30:09.724328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.724328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m03:30:09.724328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.724328 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m03:30:09.724328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m03:30:09.724328 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m03:30:09.734338 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:09.734338 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m03:30:09.734338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015874101460>]}
[0m03:30:09.734338 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.stg_employees ......................... [[32mSELECT 9[0m in 0.19s]
[0m03:30:09.739849 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m03:30:09.739849 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m03:30:09.739849 [info ] [Thread-1  ]: 3 of 9 START sql table model public.stg_order_details .......................... [RUN]
[0m03:30:09.741630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m03:30:09.742643 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m03:30:09.746660 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.747661 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m03:30:09.751644 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.752660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.753645 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m03:30:09.753645 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:09.789449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.789449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.790542 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    with order_details as (
    select * from "db_project_2"."public"."order_details"
)

select * from order_details
  );
  
[0m03:30:09.796084 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m03:30:09.799094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.800089 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m03:30:09.800164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.800164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.800164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m03:30:09.800164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.800164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:30:09.800164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.800164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m03:30:09.800164 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.800164 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m03:30:09.800164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m03:30:09.800164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m03:30:09.800164 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:09.800164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m03:30:09.800164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158737F6190>]}
[0m03:30:09.816544 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.stg_order_details ..................... [[32mSELECT 2155[0m in 0.06s]
[0m03:30:09.816544 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m03:30:09.816544 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m03:30:09.816544 [info ] [Thread-1  ]: 4 of 9 START sql table model public.stg_orders ................................. [RUN]
[0m03:30:09.819875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m03:30:09.820897 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m03:30:09.823893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m03:30:09.824895 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m03:30:09.827894 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m03:30:09.828895 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.829897 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m03:30:09.829897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:09.865280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.865280 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.866262 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "db_project_2"."public"."orders"
)

select * from orders
  );
  
[0m03:30:09.872753 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m03:30:09.875927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m03:30:09.875927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.875927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m03:30:09.875927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:30:09.875927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m03:30:09.875927 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.875927 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m03:30:09.875927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m03:30:09.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m03:30:09.891639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:09.891639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m03:30:09.891639 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158737F6190>]}
[0m03:30:09.891639 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.stg_orders ............................ [[32mSELECT 830[0m in 0.07s]
[0m03:30:09.891639 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m03:30:09.891639 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m03:30:09.896778 [info ] [Thread-1  ]: 5 of 9 START sql table model public.stg_products ............................... [RUN]
[0m03:30:09.897793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m03:30:09.898801 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m03:30:09.901789 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m03:30:09.902317 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m03:30:09.906737 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m03:30:09.908737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.908737 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m03:30:09.908737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:09.943358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:09.944379 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.944379 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "db_project_2"."public"."products"
)

select * from products
  );
  
[0m03:30:09.950350 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m03:30:09.952407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.952407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m03:30:09.952407 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.952407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.952407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m03:30:09.952407 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:09.952407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:30:09.952407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.952407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m03:30:09.952407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:09.952407 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m03:30:09.952407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m03:30:09.952407 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m03:30:09.968032 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:09.968032 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m03:30:09.968032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873A2AE20>]}
[0m03:30:09.968032 [info ] [Thread-1  ]: 5 of 9 OK created sql table model public.stg_products .......................... [[32mSELECT 77[0m in 0.07s]
[0m03:30:09.968032 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m03:30:09.968032 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m03:30:09.976046 [info ] [Thread-1  ]: 6 of 9 START sql table model public.stg_suppliers .............................. [RUN]
[0m03:30:09.977064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_suppliers)
[0m03:30:09.978053 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m03:30:09.981053 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m03:30:09.981053 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m03:30:09.986131 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m03:30:09.987055 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:09.988052 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m03:30:09.988052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:10.021859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:10.021859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:10.021859 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_suppliers.sql
with suppliers as (
    select * from "db_project_2"."public"."suppliers"
)

select * from suppliers
  );
  
[0m03:30:10.021859 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m03:30:10.021859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:10.021859 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m03:30:10.021859 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.037699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:10.037699 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m03:30:10.037699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.037699 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:30:10.037699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:10.037699 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m03:30:10.037699 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:10.037699 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m03:30:10.037699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m03:30:10.037699 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m03:30:10.047710 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:10.047710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m03:30:10.047710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158739E1C70>]}
[0m03:30:10.047710 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.stg_suppliers ......................... [[32mSELECT 29[0m in 0.07s]
[0m03:30:10.047710 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m03:30:10.047710 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:30:10.052055 [info ] [Thread-1  ]: 7 of 9 START sql table model public.datamart_monthly_best_employee ............. [RUN]
[0m03:30:10.053073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m03:30:10.053073 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:30:10.057084 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.058085 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:30:10.062084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.063069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.063069 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m03:30:10.064066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:10.099205 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:10.099205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.100193 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    with employee_revenue as (
    select
        e.employee_id,
        e.first_name || ' ' || e.last_name as employee_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as total_gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_employees" e on o.employee_id = e.employee_id
    group by e.employee_id, employee_name, o.order_date
)
select * from employee_revenue
order by total_gross_revenue desc
limit 10
  );
  
[0m03:30:10.109186 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:30:10.112290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.112290 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m03:30:10.112290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.112290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.112290 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m03:30:10.112290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.112290 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:30:10.112290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.112290 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m03:30:10.112290 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:10.112290 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m03:30:10.112290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m03:30:10.112290 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m03:30:10.128398 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:10.129955 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m03:30:10.130924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001587413DD30>]}
[0m03:30:10.130924 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.datamart_monthly_best_employee ........ [[32mSELECT 10[0m in 0.08s]
[0m03:30:10.131925 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m03:30:10.132925 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:30:10.132925 [info ] [Thread-1  ]: 8 of 9 START sql table model public.datamart_monthly_category_sold ............. [RUN]
[0m03:30:10.133926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m03:30:10.134925 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:30:10.138488 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.139516 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:30:10.142492 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.145499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.145499 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m03:30:10.146519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:10.291667 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:10.291667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.291667 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    with category_sales as (
    select
        p.category_id,
        o.order_date,
        sum(od.quantity) as total_sold
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    group by p.category_id, o.order_date
),
category_names as (
    select
        c.category_id,
        c.category_name
    from "db_project_2"."public"."stg_categories" c
)
select
    cs.category_id,
    cn.category_name,
    cs.order_date,
    cs.total_sold
from category_sales cs
join category_names cn on cs.category_id = cn.category_id
group by cs.category_id, cn.category_name, cs.order_date, cs.total_sold
order by cs.total_sold desc
limit 10
  );
  
[0m03:30:10.307327 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:30:10.307327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.307327 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m03:30:10.307327 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.307327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.307327 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m03:30:10.307327 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.307327 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:30:10.307327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.307327 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m03:30:10.307327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:10.307327 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m03:30:10.307327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m03:30:10.323126 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m03:30:10.323126 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:10.323126 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m03:30:10.323126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158729FA7F0>]}
[0m03:30:10.323126 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.datamart_monthly_category_sold ........ [[32mSELECT 10[0m in 0.19s]
[0m03:30:10.323126 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m03:30:10.323126 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:30:10.330938 [info ] [Thread-1  ]: 9 of 9 START sql table model public.datamart_monthly_supplier_gross_revenue .... [RUN]
[0m03:30:10.331953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m03:30:10.331953 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:30:10.336480 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.337480 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:30:10.344280 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.346280 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.346280 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m03:30:10.347281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:30:10.487851 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:30:10.487851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.487851 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    with supplier_revenue as (
    select
        s.company_name,
        o.order_date,
        sum(od.unit_price * od.quantity * (1 - od.discount)) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od on o.order_id = od.order_id
    join "db_project_2"."public"."stg_products" p on od.product_id = p.product_id
    join "db_project_2"."public"."stg_suppliers" s on p.supplier_id = s.supplier_id
    group by s.company_name, o.order_date
)
select * from supplier_revenue
limit 10
  );
  
[0m03:30:10.493422 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m03:30:10.493422 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.493422 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:30:10.493422 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.493422 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.493422 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m03:30:10.509058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:30:10.509058 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:30:10.509058 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.509058 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m03:30:10.509058 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:30:10.509058 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m03:30:10.509058 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m03:30:10.509058 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m03:30:10.509058 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m03:30:10.509058 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m03:30:10.509058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c01d2d1-b922-4e1c-8573-8cf5bfec565f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158739E1A90>]}
[0m03:30:10.509058 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 10[0m in 0.18s]
[0m03:30:10.509058 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m03:30:10.523251 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:10.523251 [debug] [MainThread]: On master: BEGIN
[0m03:30:10.524424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:30:10.558507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:30:10.559539 [debug] [MainThread]: On master: COMMIT
[0m03:30:10.560505 [debug] [MainThread]: Using postgres connection "master"
[0m03:30:10.560505 [debug] [MainThread]: On master: COMMIT
[0m03:30:10.560505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:30:10.561523 [debug] [MainThread]: On master: Close
[0m03:30:10.561523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:30:10.562505 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m03:30:10.562505 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m03:30:10.562505 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m03:30:10.563499 [info ] [MainThread]: 
[0m03:30:10.563499 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m03:30:10.565504 [debug] [MainThread]: Command end result
[0m03:30:10.594596 [info ] [MainThread]: 
[0m03:30:10.595598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:30:10.596597 [info ] [MainThread]: 
[0m03:30:10.597614 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m03:30:10.598597 [debug] [MainThread]: Command `dbt run` succeeded at 03:30:10.598597 after 2.16 seconds
[0m03:30:10.598597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015870A01C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873B70A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015873A1BD00>]}
[0m03:30:10.599602 [debug] [MainThread]: Flushing usage events
[0m12:54:51.304067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34E021C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D350ABCE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D350ABCD60>]}


============================== 12:54:51.310718 | 4136639c-8232-42dc-8011-380bce77f213 ==============================
[0m12:54:51.310718 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:54:51.310718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:51.407747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:54:51.408732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4136639c-8232-42dc-8011-380bce77f213', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34DEF3160>]}
[0m12:54:51.409738 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:54:51.409738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4136639c-8232-42dc-8011-380bce77f213', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34DEF3190>]}
[0m12:54:51.575201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4136639c-8232-42dc-8011-380bce77f213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34DEE7490>]}
[0m12:54:51.623657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4136639c-8232-42dc-8011-380bce77f213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D350019670>]}
[0m12:54:51.625194 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m12:54:51.649652 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:54:52.633797 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 10 files added, 3 files changed.
[0m12:54:52.634780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m12:54:52.634780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_products.sql
[0m12:54:52.634780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_shippers.sql
[0m12:54:52.635780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_employees.sql
[0m12:54:52.635780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m12:54:52.635780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_orders.sql
[0m12:54:52.636780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m12:54:52.636780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_order_details.sql
[0m12:54:52.636780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_categories.sql
[0m12:54:52.636780 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_suppliers.sql
[0m12:54:52.637780 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_categories.sql
[0m12:54:52.637780 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_suppliers.sql
[0m12:54:52.637780 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_products.sql
[0m12:54:52.638781 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_orders.sql
[0m12:54:52.638781 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_employees.sql
[0m12:54:52.638781 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_order_details.sql
[0m12:54:52.638781 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m12:54:52.639780 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m12:54:52.639780 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m12:54:52.803421 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.stg_products' (models\staging\stg_products.sql) depends on a node named 'products' which was not found
[0m12:54:52.806432 [debug] [MainThread]: Command `dbt run` failed at 12:54:52.805417 after 1.56 seconds
[0m12:54:52.806432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D34E021C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35101D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D350F57940>]}
[0m12:54:52.807429 [debug] [MainThread]: Flushing usage events
[0m12:56:20.469700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C341C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EDDBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EDDBC40>]}


============================== 12:56:20.474831 | 9ff0ec1b-969a-45f2-8ae6-faa0526b001d ==============================
[0m12:56:20.474831 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:56:20.475833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:56:20.559266 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:56:20.559978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ff0ec1b-969a-45f2-8ae6-faa0526b001d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C213160>]}
[0m12:56:20.559978 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:56:20.561071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ff0ec1b-969a-45f2-8ae6-faa0526b001d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C213190>]}
[0m12:56:20.671032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ff0ec1b-969a-45f2-8ae6-faa0526b001d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579ED9D5E0>]}
[0m12:56:20.701304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ff0ec1b-969a-45f2-8ae6-faa0526b001d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579EDA7040>]}
[0m12:56:20.716385 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m12:56:20.725188 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:56:20.886560 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 10 files added, 3 files changed.
[0m12:56:20.887557 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_orders.sql
[0m12:56:20.887557 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_products.sql
[0m12:56:20.887557 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_suppliers.sql
[0m12:56:20.888543 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m12:56:20.888543 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m12:56:20.888543 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_shippers.sql
[0m12:56:20.888543 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_categories.sql
[0m12:56:20.889563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_order_details.sql
[0m12:56:20.889563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m12:56:20.889563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_employees.sql
[0m12:56:20.890541 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_order_details.sql
[0m12:56:20.890541 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_categories.sql
[0m12:56:20.890541 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_employees.sql
[0m12:56:20.891562 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_orders.sql
[0m12:56:20.891562 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_suppliers.sql
[0m12:56:20.891562 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_products.sql
[0m12:56:20.891562 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m12:56:20.892541 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m12:56:20.892541 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m12:56:21.056260 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.stg_shippers' (models\staging\stg_shippers.sql) depends on a source named 'raw.shippers' which was not found
[0m12:56:21.057950 [debug] [MainThread]: Command `dbt run` failed at 12:56:21.057950 after 0.64 seconds
[0m12:56:21.057950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579C341C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579F33CAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002579F40EA00>]}
[0m12:56:21.058965 [debug] [MainThread]: Flushing usage events
[0m12:58:04.147300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1C151C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1EBEBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1EBEBD60>]}


============================== 12:58:04.147300 | 6d2baf1b-74d6-4ee3-957e-c88cb181c3e4 ==============================
[0m12:58:04.147300 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:58:04.147300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:04.224348 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:58:04.225360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d2baf1b-74d6-4ee3-957e-c88cb181c3e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1C023160>]}
[0m12:58:04.226363 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:58:04.226363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d2baf1b-74d6-4ee3-957e-c88cb181c3e4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1C023190>]}
[0m12:58:04.339558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d2baf1b-74d6-4ee3-957e-c88cb181c3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1C017490>]}
[0m12:58:04.397596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d2baf1b-74d6-4ee3-957e-c88cb181c3e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1E14B670>]}
[0m12:58:04.397596 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m12:58:04.415385 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:58:04.537013 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 10 files added, 3 files changed.
[0m12:58:04.537013 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_categories.sql
[0m12:58:04.537013 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m12:58:04.537013 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_products.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_suppliers.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_employees.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_order_details.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_orders.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_shippers.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_suppliers.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_categories.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_order_details.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_orders.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_employees.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_products.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m12:58:04.552563 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m12:58:04.729457 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.stg_shippers' (models\staging\stg_shippers.sql) depends on a source named 'raw.shippers' which was not found
[0m12:58:04.732545 [debug] [MainThread]: Command `dbt run` failed at 12:58:04.731468 after 0.61 seconds
[0m12:58:04.732545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1C151C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F13B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD1F15A280>]}
[0m12:58:04.733548 [debug] [MainThread]: Flushing usage events
[0m12:58:47.516367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B49D61C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4C7FBD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4C7FBC40>]}


============================== 12:58:47.520177 | 4b96fe2c-dcb8-4917-a61c-2e917ec6babf ==============================
[0m12:58:47.520177 [info ] [MainThread]: Running with dbt=1.8.2
[0m12:58:47.521188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:58:47.580112 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:58:47.582105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B49C33160>]}
[0m12:58:47.582105 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m12:58:47.583107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B49C33190>]}
[0m12:58:47.692707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4C7BD5E0>]}
[0m12:58:47.738156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4C7C8040>]}
[0m12:58:47.740127 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m12:58:47.747735 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m12:58:47.887937 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 10 files added, 4 files changed.
[0m12:58:47.888960 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_suppliers.sql
[0m12:58:47.888960 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_orders.sql
[0m12:58:47.888960 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m12:58:47.889964 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_order_details.sql
[0m12:58:47.889964 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_employees.sql
[0m12:58:47.889964 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_shippers.sql
[0m12:58:47.890944 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_products.sql
[0m12:58:47.890944 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m12:58:47.890944 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m12:58:47.891944 [debug] [MainThread]: Partial parsing: added file: dbt_dskola_project://models\staging\stg_categories.sql
[0m12:58:47.891944 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\sources.yml
[0m12:58:47.891944 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_employees.sql
[0m12:58:47.892963 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_products.sql
[0m12:58:47.892963 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_orders.sql
[0m12:58:47.892963 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_suppliers.sql
[0m12:58:47.893961 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_order_details.sql
[0m12:58:47.893961 [debug] [MainThread]: Partial parsing: deleted file: dbt_dskola_project://models\warehouse\stg_categories.sql
[0m12:58:47.893961 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m12:58:47.893961 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m12:58:47.895123 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m12:58:48.180868 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m12:58:48.192867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4D01C130>]}
[0m12:58:48.302030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4CFD9EE0>]}
[0m12:58:48.302030 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m12:58:48.302030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4D003BB0>]}
[0m12:58:48.310959 [info ] [MainThread]: 
[0m12:58:48.311966 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:48.316965 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m12:58:50.164013 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m12:58:50.165013 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m12:58:50.165013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:50.203067 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:58:50.204096 [debug] [ThreadPool]: On list_db_project_2: Close
[0m12:58:50.206067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m12:58:50.207926 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m12:58:50.207926 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m12:58:50.207926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:50.245218 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.246235 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m12:58:50.246235 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:58:50.253218 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m12:58:50.255236 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m12:58:50.255236 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m12:58:50.262235 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.263219 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.263219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:50.295976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.295976 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.296975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:50.304977 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:58:50.306977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4CFD9EB0>]}
[0m12:58:50.306977 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:50.307977 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.307977 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.307977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.308978 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.308978 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.308978 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.309979 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:58:50.309979 [debug] [MainThread]: On master: Close
[0m12:58:50.309979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:50.310980 [info ] [MainThread]: 
[0m12:58:50.314976 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m12:58:50.316005 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m12:58:50.316981 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m12:58:50.316981 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m12:58:50.323742 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m12:58:50.324765 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m12:58:50.364797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m12:58:50.365813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m12:58:50.365813 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m12:58:50.366797 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m12:58:50.511343 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.511343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m12:58:50.511343 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories;
  );
  
[0m12:58:50.516342 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: select * from raw_categories;
                                     ^

[0m12:58:50.517341 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: ROLLBACK
[0m12:58:50.517341 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m12:58:50.597141 [debug] [Thread-1  ]: Database Error in model stg_categories (models\staging\stg_categories.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_categories;
                                       ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m12:58:50.597141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4BD10A30>]}
[0m12:58:50.597141 [error] [Thread-1  ]: 1 of 13 ERROR creating sql table model public.stg_categories ................... [[31mERROR[0m in 0.28s]
[0m12:58:50.597141 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m12:58:50.597141 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m12:58:50.597141 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m12:58:50.607315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m12:58:50.607315 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m12:58:50.610329 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m12:58:50.611329 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m12:58:50.616084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m12:58:50.617053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m12:58:50.618057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m12:58:50.618057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.654613 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.655600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m12:58:50.655600 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees;
  );
  
[0m12:58:50.656608 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: select * from raw_employees;
                                    ^

[0m12:58:50.657628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: ROLLBACK
[0m12:58:50.657628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m12:58:50.658732 [debug] [Thread-1  ]: Database Error in model stg_employees (models\staging\stg_employees.sql)
  syntax error at or near ";"
  LINE 20: select * from raw_employees;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m12:58:50.659608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4BD10A30>]}
[0m12:58:50.660609 [error] [Thread-1  ]: 2 of 13 ERROR creating sql table model public.stg_employees .................... [[31mERROR[0m in 0.05s]
[0m12:58:50.661609 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m12:58:50.661609 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m12:58:50.662600 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m12:58:50.663608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m12:58:50.663608 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m12:58:50.666613 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m12:58:50.667613 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m12:58:50.671145 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m12:58:50.673137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m12:58:50.673137 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m12:58:50.674167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.709826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.710828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m12:58:50.710828 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details;
  );
  
[0m12:58:50.711845 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: select * from raw_order_details;
                                        ^

[0m12:58:50.711845 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: ROLLBACK
[0m12:58:50.712848 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m12:58:50.713829 [debug] [Thread-1  ]: Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_order_details;
                                          ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m12:58:50.714830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4CD5A0A0>]}
[0m12:58:50.714830 [error] [Thread-1  ]: 3 of 13 ERROR creating sql table model public.stg_order_details ................ [[31mERROR[0m in 0.05s]
[0m12:58:50.715828 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m12:58:50.715828 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m12:58:50.716826 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m12:58:50.717826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m12:58:50.717826 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m12:58:50.721846 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m12:58:50.722846 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m12:58:50.726832 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m12:58:50.728833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m12:58:50.728833 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m12:58:50.729844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.763922 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.764948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m12:58:50.764948 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products;
  );
  
[0m12:58:50.765940 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: select * from raw_products;
                                   ^

[0m12:58:50.766924 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: ROLLBACK
[0m12:58:50.766924 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m12:58:50.768939 [debug] [Thread-1  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_products;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m12:58:50.768939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B49BCB1F0>]}
[0m12:58:50.769915 [error] [Thread-1  ]: 4 of 13 ERROR creating sql table model public.stg_orders ....................... [[31mERROR[0m in 0.05s]
[0m12:58:50.770918 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m12:58:50.771917 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m12:58:50.771917 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m12:58:50.772916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m12:58:50.772916 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m12:58:50.775925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m12:58:50.777088 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m12:58:50.781121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m12:58:50.782112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m12:58:50.782112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m12:58:50.782112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.829005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.829005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m12:58:50.830065 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products;
  );
  
[0m12:58:50.831051 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: select * from raw_products;
                                   ^

[0m12:58:50.831051 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: ROLLBACK
[0m12:58:50.832000 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m12:58:50.832994 [debug] [Thread-1  ]: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near ";"
  LINE 23: select * from raw_products;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m12:58:50.834066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4D3F28E0>]}
[0m12:58:50.834066 [error] [Thread-1  ]: 5 of 13 ERROR creating sql table model public.stg_products ..................... [[31mERROR[0m in 0.06s]
[0m12:58:50.835256 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m12:58:50.835256 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m12:58:50.837716 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m12:58:50.839734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m12:58:50.839734 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m12:58:50.843262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m12:58:50.844278 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m12:58:50.850292 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m12:58:50.852267 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m12:58:50.852267 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m12:58:50.852267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.888915 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.888915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m12:58:50.889920 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers;
  );
  
[0m12:58:50.889920 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: select * from raw_shippers;
                                   ^

[0m12:58:50.890922 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: ROLLBACK
[0m12:58:50.890922 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m12:58:50.892920 [debug] [Thread-1  ]: Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_shippers;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m12:58:50.892920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4D3F28E0>]}
[0m12:58:50.893920 [error] [Thread-1  ]: 6 of 13 ERROR creating sql table model public.stg_shippers ..................... [[31mERROR[0m in 0.05s]
[0m12:58:50.894920 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m12:58:50.894920 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m12:58:50.895928 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m12:58:50.896927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m12:58:50.896927 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m12:58:50.899927 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m12:58:50.900927 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m12:58:50.905007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m12:58:50.907140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m12:58:50.908007 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m12:58:50.908007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:50.943170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.943170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m12:58:50.944377 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers;
  );
  
[0m12:58:50.944377 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: select * from raw_suppliers;
                                    ^

[0m12:58:50.944377 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: ROLLBACK
[0m12:58:50.944377 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m12:58:50.944377 [debug] [Thread-1  ]: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_suppliers;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m12:58:50.944377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b96fe2c-dcb8-4917-a61c-2e917ec6babf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4D4C7310>]}
[0m12:58:50.944377 [error] [Thread-1  ]: 7 of 13 ERROR creating sql table model public.stg_suppliers .................... [[31mERROR[0m in 0.05s]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m12:58:50.944377 [info ] [Thread-1  ]: 8 of 13 SKIP relation public.int_monthly_employee_revenue ...................... [[33mSKIP[0m]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m12:58:50.944377 [info ] [Thread-1  ]: 9 of 13 SKIP relation public.int_monthly_category_sales ........................ [[33mSKIP[0m]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m12:58:50.944377 [info ] [Thread-1  ]: 10 of 13 SKIP relation public.int_monthly_supplier_revenue ..................... [[33mSKIP[0m]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m12:58:50.944377 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m12:58:50.944377 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m12:58:50.944377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m12:58:50.944377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m12:58:50.957643 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m12:58:50.957960 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m12:58:50.959659 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.959659 [debug] [MainThread]: On master: BEGIN
[0m12:58:50.959659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:50.997176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:58:50.997176 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.998192 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:50.998192 [debug] [MainThread]: On master: COMMIT
[0m12:58:50.999172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:58:50.999172 [debug] [MainThread]: On master: Close
[0m12:58:51.000177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:51.000177 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m12:58:51.000177 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m12:58:51.000177 [debug] [MainThread]: Connection 'model.dbt_dskola_project.stg_suppliers' was properly closed.
[0m12:58:51.001177 [info ] [MainThread]: 
[0m12:58:51.001177 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m12:58:51.003174 [debug] [MainThread]: Command end result
[0m12:58:51.033911 [info ] [MainThread]: 
[0m12:58:51.035907 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m12:58:51.035907 [info ] [MainThread]: 
[0m12:58:51.036905 [error] [MainThread]:   Database Error in model stg_categories (models\staging\stg_categories.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_categories;
                                       ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m12:58:51.038906 [info ] [MainThread]: 
[0m12:58:51.039907 [error] [MainThread]:   Database Error in model stg_employees (models\staging\stg_employees.sql)
  syntax error at or near ";"
  LINE 20: select * from raw_employees;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m12:58:51.041913 [info ] [MainThread]: 
[0m12:58:51.041913 [error] [MainThread]:   Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_order_details;
                                          ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m12:58:51.043425 [info ] [MainThread]: 
[0m12:58:51.044432 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_products;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m12:58:51.045434 [info ] [MainThread]: 
[0m12:58:51.046432 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near ";"
  LINE 23: select * from raw_products;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m12:58:51.047433 [info ] [MainThread]: 
[0m12:58:51.048432 [error] [MainThread]:   Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_shippers;
                                     ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m12:58:51.049435 [info ] [MainThread]: 
[0m12:58:51.050430 [error] [MainThread]:   Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ";"
  LINE 18: select * from raw_suppliers;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m12:58:51.051431 [info ] [MainThread]: 
[0m12:58:51.052441 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=6 TOTAL=13
[0m12:58:51.054443 [debug] [MainThread]: Command `dbt run` failed at 12:58:51.053438 after 3.58 seconds
[0m12:58:51.054443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B49D61C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4C335E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4CFB81F0>]}
[0m12:58:51.055443 [debug] [MainThread]: Flushing usage events
[0m13:01:32.400901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D18731C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B1CAD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B1CAC40>]}


============================== 13:01:32.402130 | 0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9 ==============================
[0m13:01:32.402130 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:01:32.402130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:32.465427 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:01:32.466321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D18603160>]}
[0m13:01:32.467335 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:01:32.467647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D18603190>]}
[0m13:01:32.577537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B18D5E0>]}
[0m13:01:32.622612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B197040>]}
[0m13:01:32.624618 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:01:32.632148 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_employees.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_orders.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_categories.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_shippers.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_order_details.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_products.sql
[0m13:01:32.787670 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_suppliers.sql
[0m13:01:32.976929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:01:32.991326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B8DC130>]}
[0m13:01:33.074059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B8976D0>]}
[0m13:01:33.074059 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:01:33.074059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B8F9040>]}
[0m13:01:33.085053 [info ] [MainThread]: 
[0m13:01:33.086059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:33.091082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:01:33.137921 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:01:33.137921 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:01:33.153634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:33.185633 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:01:33.185633 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:01:33.185633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:01:33.185633 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:01:33.185633 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:01:33.185633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:33.226811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.226811 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:01:33.226811 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:01:33.232856 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m13:01:33.232856 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:01:33.232856 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:01:33.232856 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:33.232856 [debug] [MainThread]: On master: BEGIN
[0m13:01:33.232856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:33.384713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.384713 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:33.384713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:33.400994 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:01:33.400994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B71BFA0>]}
[0m13:01:33.400994 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:33.400994 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:33.400994 [debug] [MainThread]: On master: BEGIN
[0m13:01:33.400994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.400994 [debug] [MainThread]: On master: COMMIT
[0m13:01:33.400994 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:33.400994 [debug] [MainThread]: On master: COMMIT
[0m13:01:33.400994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:01:33.400994 [debug] [MainThread]: On master: Close
[0m13:01:33.400994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:33.410007 [info ] [MainThread]: 
[0m13:01:33.414142 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:01:33.415158 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:01:33.416425 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:01:33.416425 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:01:33.425671 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:01:33.427166 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:01:33.475186 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:01:33.476188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.477188 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:01:33.477188 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:01:33.610162 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.610162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.610162 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:01:33.620784 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:01:33.652083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.652083 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:01:33.652083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.667849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.667849 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:01:33.667849 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.683553 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:01:33.683553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.683553 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:01:33.683553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:33.683553 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:01:33.683553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:01:33.683553 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:01:33.699268 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:33.699268 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:01:33.699268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1BD05E80>]}
[0m13:01:33.699268 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.28s]
[0m13:01:33.699268 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:01:33.699268 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:01:33.699268 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:01:33.708910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:01:33.708910 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:01:33.714571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:01:33.715518 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:01:33.720516 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:01:33.722494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.722494 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:01:33.722494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:33.759933 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.759933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.760929 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:01:33.767895 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:01:33.769961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.769961 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:01:33.769961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.772470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.772470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:01:33.772470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.772470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:01:33.772470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.772470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:01:33.772470 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:33.772470 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:01:33.772470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:01:33.772470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:01:33.772470 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:33.786005 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:01:33.786005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1AFBDD90>]}
[0m13:01:33.786005 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.08s]
[0m13:01:33.786005 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:01:33.786005 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:01:33.786005 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:01:33.786005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:01:33.786005 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:01:33.786005 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.786005 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:01:33.798819 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.798819 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.799850 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:01:33.799850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:33.834671 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.834671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.834671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:01:33.839340 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:01:33.839340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.839340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:01:33.839340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.839340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.839340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:01:33.839340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.839340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:01:33.839340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.839340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:01:33.839340 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:33.839340 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:01:33.839340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:01:33.839340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:01:33.854966 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:33.854966 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:01:33.854966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1BD5CAC0>]}
[0m13:01:33.854966 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:01:33.854966 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:01:33.854966 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:01:33.863703 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:01:33.864724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:01:33.864724 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:01:33.869709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:01:33.870961 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:01:33.875719 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:01:33.876735 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.877731 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:01:33.877731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:33.910179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.910179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.910179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:01:33.910179 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:01:33.910179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.910179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:01:33.910179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.910179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.910179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:01:33.924913 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:33.924913 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:01:33.924913 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.924913 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:01:33.924913 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:33.924913 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:01:33.924913 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:01:33.924913 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:01:33.934941 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:33.934941 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:01:33.934941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1BD69610>]}
[0m13:01:33.934941 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 77[0m in 0.07s]
[0m13:01:33.940456 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:01:33.940456 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:01:33.941448 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:01:33.942454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:01:33.943455 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:01:33.946460 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:01:33.947453 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:01:33.952482 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:01:33.953453 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:33.954454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:01:33.954454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:33.990219 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:33.991252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:33.991252 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:01:33.998308 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:01:34.002337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:34.002337 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:01:34.003337 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:34.006399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:34.006399 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:01:34.006399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:34.006399 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:01:34.006399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:34.006399 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:01:34.010406 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:34.010406 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:01:34.010406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:01:34.010406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:01:34.010406 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:34.010406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:01:34.010406 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B509760>]}
[0m13:01:34.010406 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:01:34.010406 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:01:34.010406 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:01:34.010406 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:01:34.022068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:01:34.022068 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:01:34.025081 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.026101 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:01:34.030097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.032098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.032098 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:01:34.033400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:34.068532 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.069419 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.069419 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:01:34.075571 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:01:34.078611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.078611 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:01:34.079138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:34.081172 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:01:34.081172 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.081172 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:01:34.082164 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:34.083241 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:01:34.083241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:01:34.083241 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:01:34.083241 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:34.083241 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:01:34.083241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1BE549D0>]}
[0m13:01:34.083241 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:01:34.083241 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:01:34.083241 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:01:34.090874 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:01:34.091892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:01:34.092888 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:01:34.095944 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.096952 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:01:34.102948 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.103951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.104949 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:01:34.104949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:34.142085 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.143113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.143113 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:01:34.145179 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:01:34.145179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.145179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:01:34.145179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:34.145179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.145179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:01:34.145179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:01:34.145179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:01:34.145179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.145179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:01:34.145179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:01:34.161049 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:01:34.161049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:01:34.161049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:01:34.161049 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:01:34.161049 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:01:34.161049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B7365E0>]}
[0m13:01:34.161049 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:01:34.171064 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:01:34.171064 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:01:34.173123 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:01:34.173123 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:01:34.174139 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:01:34.177136 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:01:34.180127 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:01:34.185138 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:01:34.186131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:01:34.187129 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:01:34.187129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:34.331091 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.331091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:01:34.331091 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month;
  );
  
[0m13:01:34.331091 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: group by employee_id, month;
                                    ^

[0m13:01:34.331091 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:01:34.331091 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:01:34.331091 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ";"
  LINE 28: group by employee_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:01:34.331091 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D186A58B0>]}
[0m13:01:34.331091 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.16s]
[0m13:01:34.331091 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:01:34.331091 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:01:34.331091 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:01:34.341344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:01:34.342407 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:01:34.345357 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:01:34.346350 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:01:34.351368 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:01:34.353365 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:01:34.353365 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:01:34.354359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:34.389382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.390397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:01:34.391399 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month;
  );
  
[0m13:01:34.391399 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 38: group by category_id, month;
                                    ^

[0m13:01:34.392384 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:01:34.392384 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:01:34.394383 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  syntax error at or near ";"
  LINE 38: group by category_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:01:34.394383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B73E940>]}
[0m13:01:34.395385 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:01:34.396404 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:01:34.396404 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:01:34.397403 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:01:34.397403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:01:34.398398 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:01:34.401419 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:01:34.402427 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:01:34.406403 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:01:34.407390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:01:34.408401 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:01:34.408401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:01:34.444690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.444690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:01:34.445714 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month;
  );
  
[0m13:01:34.446696 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 38: group by supplier_id, month;
                                    ^

[0m13:01:34.446696 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:01:34.446696 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:01:34.448690 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  syntax error at or near ";"
  LINE 38: group by supplier_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:01:34.448690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f3b02cc-a993-4c81-b6e6-f5ff5b8a0bc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1BDF7B80>]}
[0m13:01:34.449690 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:01:34.450754 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:01:34.450754 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:01:34.451654 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:01:34.452670 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:01:34.452670 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:01:34.453672 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:01:34.453672 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:01:34.454671 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:01:34.454671 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:01:34.455670 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:01:34.456768 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.456768 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.457665 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:34.497222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:01:34.497222 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.497222 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.498238 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.498238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:01:34.498238 [debug] [MainThread]: On master: Close
[0m13:01:34.499228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:34.499228 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:01:34.500232 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:01:34.500232 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:01:34.500232 [info ] [MainThread]: 
[0m13:01:34.501230 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m13:01:34.504214 [debug] [MainThread]: Command end result
[0m13:01:34.533429 [info ] [MainThread]: 
[0m13:01:34.534340 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:01:34.535339 [info ] [MainThread]: 
[0m13:01:34.536336 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ";"
  LINE 28: group by employee_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:01:34.536336 [info ] [MainThread]: 
[0m13:01:34.537337 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  syntax error at or near ";"
  LINE 38: group by category_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:01:34.538336 [info ] [MainThread]: 
[0m13:01:34.538336 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  syntax error at or near ";"
  LINE 38: group by supplier_id, month;
                                      ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:01:34.539336 [info ] [MainThread]: 
[0m13:01:34.540332 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:01:34.541328 [debug] [MainThread]: Command `dbt run` failed at 13:01:34.541328 after 2.18 seconds
[0m13:01:34.542332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D18731C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1AD05E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D1B5A9070>]}
[0m13:01:34.542332 [debug] [MainThread]: Flushing usage events
[0m13:02:08.824740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2091BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E29D7AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E4AF6D00>]}


============================== 13:02:08.828547 | bb83fb5f-91cc-4dc6-8b92-388a36421f31 ==============================
[0m13:02:08.828547 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:02:08.829545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:02:08.891547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:02:08.892546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1F63160>]}
[0m13:02:08.892546 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:02:08.893551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1F63190>]}
[0m13:02:09.007876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E29F91F0>]}
[0m13:02:09.058619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E4AED730>]}
[0m13:02:09.059613 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:02:09.067812 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:02:09.235179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:02:09.236195 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:02:09.236195 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:02:09.237177 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:02:09.435406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:02:09.449605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E5240130>]}
[0m13:02:09.552402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E5225460>]}
[0m13:02:09.553403 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:02:09.554399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E4F05760>]}
[0m13:02:09.556402 [info ] [MainThread]: 
[0m13:02:09.557393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:02:09.562020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:02:09.627442 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:02:09.628448 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:02:09.628448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:09.671053 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:02:09.673052 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:02:09.676058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:02:09.682607 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:02:09.683602 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:02:09.683602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:09.722602 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:02:09.723603 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:02:09.723603 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:02:09.731127 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:02:09.733133 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:02:09.733133 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:02:09.742132 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:09.742132 [debug] [MainThread]: On master: BEGIN
[0m13:02:09.743125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:02:09.782109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:02:09.782109 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:09.783109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:02:09.796590 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:02:09.799606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E50B0BE0>]}
[0m13:02:09.800599 [debug] [MainThread]: On master: ROLLBACK
[0m13:02:09.802045 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:09.803062 [debug] [MainThread]: On master: BEGIN
[0m13:02:09.803062 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:02:09.804052 [debug] [MainThread]: On master: COMMIT
[0m13:02:09.804052 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:09.804052 [debug] [MainThread]: On master: COMMIT
[0m13:02:09.805057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:02:09.807052 [debug] [MainThread]: On master: Close
[0m13:02:09.808052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:09.809283 [info ] [MainThread]: 
[0m13:02:09.814060 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:02:09.815060 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:02:09.817060 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:02:09.817060 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:02:09.830575 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:02:09.831568 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:02:09.887147 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:02:09.889136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:09.890135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:02:09.890135 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:02:09.927317 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:09.928847 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:09.928847 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:02:09.937881 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:02:10.002868 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:10.002868 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:02:10.003887 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.007887 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:10.007887 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:02:10.008873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.032362 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:02:10.033365 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:10.034362 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:02:10.036358 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.044365 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:02:10.048364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:02:10.049362 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:02:10.052372 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.056575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:02:10.058576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E56B2DF0>]}
[0m13:02:10.058576 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.24s]
[0m13:02:10.060575 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:02:10.060575 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:02:10.061568 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:02:10.062570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:02:10.063584 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:02:10.066576 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:02:10.067635 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:02:10.072157 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:02:10.073157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.073157 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:02:10.073157 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.117811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.118818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.119815 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:02:10.128815 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:02:10.133815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.134817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:02:10.135815 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.140817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.141819 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:02:10.142814 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.144815 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:02:10.144815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.145817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:02:10.147816 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.149816 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:02:10.150814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:02:10.151818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:02:10.155826 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.157842 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:02:10.157842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E579ED00>]}
[0m13:02:10.158818 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.10s]
[0m13:02:10.160823 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:02:10.161820 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:02:10.162829 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:02:10.163827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:02:10.163827 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:02:10.169030 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.169550 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:02:10.176562 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.177563 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.177563 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:02:10.177563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.220455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.220455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.221456 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:02:10.230975 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:02:10.233976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.234975 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:02:10.235978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.240004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.240004 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:02:10.241000 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.243978 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:02:10.243978 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.244976 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:02:10.245984 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.248986 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:02:10.249988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:02:10.249988 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:02:10.252994 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.253999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:02:10.254999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E575B880>]}
[0m13:02:10.254999 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.09s]
[0m13:02:10.255987 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:02:10.256998 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:02:10.258987 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:02:10.259989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:02:10.259989 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:02:10.264988 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:02:10.265988 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:02:10.270499 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:02:10.273003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.273003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:02:10.274008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.311015 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.312010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.313010 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:02:10.319541 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:02:10.323571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.324579 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:02:10.325549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.329555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.329555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:02:10.330571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.332548 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:02:10.333578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.333578 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:02:10.335562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.337571 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:02:10.338570 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:02:10.338570 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:02:10.343555 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.344560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:02:10.345559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E52E4310>]}
[0m13:02:10.346550 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 77[0m in 0.09s]
[0m13:02:10.348555 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:02:10.349557 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:02:10.349557 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:02:10.350559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:02:10.350559 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:02:10.353576 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:02:10.355569 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:02:10.358569 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:02:10.360575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.360575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:02:10.361587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.502324 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.502324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.502324 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:02:10.502324 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:02:10.512390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.512390 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:02:10.512390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.512390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.512390 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:02:10.512390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.512390 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:02:10.522400 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.523021 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:02:10.523021 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.523021 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:02:10.523021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:02:10.523021 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:02:10.523021 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.523021 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:02:10.532562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E4AF6FD0>]}
[0m13:02:10.532562 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.18s]
[0m13:02:10.532562 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:02:10.532562 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:02:10.535458 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:02:10.536463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:02:10.536463 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:02:10.540488 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.541495 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:02:10.545501 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.546470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.547475 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:02:10.547475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.588543 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.588543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.589536 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:02:10.594572 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:02:10.596560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.596560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:02:10.596560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.596560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.596560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:02:10.596560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.596560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:02:10.596560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.596560 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:02:10.606671 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.606671 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:02:10.606671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:02:10.606671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:02:10.606671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.606671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:02:10.606671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E57B9220>]}
[0m13:02:10.617416 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:02:10.617416 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:02:10.617416 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:02:10.618980 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:02:10.619986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:02:10.619986 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:02:10.625353 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.626351 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:02:10.630356 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.631373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.631373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:02:10.632361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.669570 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.670607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.670607 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:02:10.676088 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:02:10.679867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.680400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:02:10.681522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.684284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.684842 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:02:10.685402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:02:10.687051 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:02:10.687616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.687616 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:02:10.689398 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:02:10.691704 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:02:10.691704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:02:10.691704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:02:10.691704 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:02:10.691704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:02:10.691704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E57AC610>]}
[0m13:02:10.691704 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:02:10.699715 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:02:10.699715 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:02:10.700505 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:02:10.701513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:02:10.701513 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:02:10.705540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:02:10.706548 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:02:10.710544 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:02:10.711517 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:02:10.712531 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:02:10.712531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.860158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.864501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:02:10.864501 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:02:10.864501 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 21:     on o.order_id = od.order_id
                ^
HINT:  Perhaps you meant to reference the column "od.order_id".

[0m13:02:10.864501 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:02:10.868513 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:02:10.871230 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:02:10.871230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E5775550>]}
[0m13:02:10.871230 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.17s]
[0m13:02:10.871230 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:02:10.871230 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:02:10.874485 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:02:10.875491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:02:10.875491 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:02:10.880514 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:02:10.881514 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:02:10.885490 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:02:10.886498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:02:10.887498 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:02:10.887498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.921211 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.922234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:02:10.922234 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:02:10.923348 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 21:     on o.order_id = od.order_id
                ^
HINT:  Perhaps you meant to reference the column "od.order_id".

[0m13:02:10.923348 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:02:10.923348 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:02:10.923348 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:02:10.923348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E1F1D100>]}
[0m13:02:10.923348 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:02:10.927352 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:02:10.927352 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:02:10.928614 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:02:10.929619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:02:10.929619 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:02:10.933649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:02:10.934627 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:02:10.939621 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:02:10.940619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:02:10.941619 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:02:10.941619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:02:10.978666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:02:10.978666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:02:10.979690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:02:10.980690 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column o.order_id does not exist
LINE 21:     on o.order_id = od.order_id
                ^
HINT:  Perhaps you meant to reference the column "od.order_id".

[0m13:02:10.980690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:02:10.981701 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:02:10.982708 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:02:10.982708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb83fb5f-91cc-4dc6-8b92-388a36421f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E57AA8B0>]}
[0m13:02:10.983708 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:02:10.984708 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:02:10.984708 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:02:10.985716 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:02:10.985716 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:02:10.986718 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:02:10.986718 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:02:10.987613 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:02:10.987613 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:02:10.987613 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:02:10.988643 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:02:10.989626 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:10.989626 [debug] [MainThread]: On master: BEGIN
[0m13:02:10.990643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:02:11.024222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:02:11.025229 [debug] [MainThread]: On master: COMMIT
[0m13:02:11.025229 [debug] [MainThread]: Using postgres connection "master"
[0m13:02:11.026229 [debug] [MainThread]: On master: COMMIT
[0m13:02:11.026229 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:02:11.026229 [debug] [MainThread]: On master: Close
[0m13:02:11.027230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:11.027230 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:02:11.028227 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:02:11.028227 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:02:11.028227 [info ] [MainThread]: 
[0m13:02:11.029223 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m13:02:11.031222 [debug] [MainThread]: Command end result
[0m13:02:11.060256 [info ] [MainThread]: 
[0m13:02:11.061249 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:02:11.062257 [info ] [MainThread]: 
[0m13:02:11.063264 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:02:11.064257 [info ] [MainThread]: 
[0m13:02:11.064257 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:02:11.065770 [info ] [MainThread]: 
[0m13:02:11.066786 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  column o.order_id does not exist
  LINE 21:     on o.order_id = od.order_id
                  ^
  HINT:  Perhaps you meant to reference the column "od.order_id".
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:02:11.067798 [info ] [MainThread]: 
[0m13:02:11.067798 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:02:11.069303 [debug] [MainThread]: Command `dbt run` failed at 13:02:11.069303 after 2.29 seconds
[0m13:02:11.069303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E2091BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E509E4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000150E51FFB50>]}
[0m13:02:11.070333 [debug] [MainThread]: Flushing usage events
[0m13:04:18.226740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C94ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4F3B7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4D2CA790>]}


============================== 13:04:18.226740 | 7bb11a3e-596a-4ea3-b836-617be1b5832f ==============================
[0m13:04:18.226740 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:04:18.226740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:18.284125 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:18.284125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7bb11a3e-596a-4ea3-b836-617be1b5832f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C823190>]}
[0m13:04:18.284125 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:18.284125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7bb11a3e-596a-4ea3-b836-617be1b5832f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C8231C0>]}
[0m13:04:18.410386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bb11a3e-596a-4ea3-b836-617be1b5832f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4F3A2D90>]}
[0m13:04:18.456906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bb11a3e-596a-4ea3-b836-617be1b5832f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C8378E0>]}
[0m13:04:18.457897 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:04:18.466914 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:04:18.610369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:18.610369 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_orders.sql
[0m13:04:18.743828 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dskola_project.stg_orders' (models\staging\stg_orders.sql) depends on a node named 'orders' which was not found
[0m13:04:18.743828 [debug] [MainThread]: Command `dbt run` failed at 13:04:18.743828 after 0.56 seconds
[0m13:04:18.743828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C94ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4E971070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011A4C7E7BB0>]}
[0m13:04:18.743828 [debug] [MainThread]: Flushing usage events
[0m13:04:48.060545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F064541C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F066FDBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F066FDBD60>]}


============================== 13:04:48.061276 | ee9f78e2-4c60-44ae-84b5-d6a291dade77 ==============================
[0m13:04:48.061276 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:04:48.061276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:04:48.124069 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:48.124069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F064413160>]}
[0m13:04:48.128849 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:04:48.128849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F064413190>]}
[0m13:04:48.235416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F064407490>]}
[0m13:04:48.281955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06653B670>]}
[0m13:04:48.283957 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:04:48.290956 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:04:48.424108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:48.424108 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_orders.sql
[0m13:04:48.597677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:04:48.620619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0676F8F10>]}
[0m13:04:48.716371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0676DDC70>]}
[0m13:04:48.716371 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:04:48.716371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067707DC0>]}
[0m13:04:48.721128 [info ] [MainThread]: 
[0m13:04:48.722645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:48.727675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:04:48.784322 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:04:48.784322 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:04:48.784322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:48.821305 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:04:48.826345 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:04:48.826345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:04:48.831881 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:04:48.831881 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:04:48.831881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:48.863227 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:04:48.863227 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:04:48.863227 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:04:48.863227 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:04:48.863227 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:04:48.873238 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:04:48.879254 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:48.879254 [debug] [MainThread]: On master: BEGIN
[0m13:04:48.879254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:48.894894 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:04:48.910512 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:48.910512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:04:48.910512 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:04:48.921047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0676AA910>]}
[0m13:04:48.921047 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:48.921581 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:48.921581 [debug] [MainThread]: On master: BEGIN
[0m13:04:48.921581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:04:48.921581 [debug] [MainThread]: On master: COMMIT
[0m13:04:48.921581 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:48.921581 [debug] [MainThread]: On master: COMMIT
[0m13:04:48.921581 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:04:48.921581 [debug] [MainThread]: On master: Close
[0m13:04:48.921581 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:48.921581 [info ] [MainThread]: 
[0m13:04:48.929185 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:04:48.930191 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:04:48.931179 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:04:48.931179 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:04:48.939461 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:04:48.940444 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:04:48.978007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:04:48.979010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:48.979986 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:04:48.979986 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:04:49.018840 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.018840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:49.018840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:04:49.024396 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:04:49.024396 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:49.024396 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:04:49.024396 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.071612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:49.071612 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:04:49.071612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.087334 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:04:49.087334 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:49.087334 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:04:49.087334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.087334 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:04:49.102970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:04:49.102970 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:04:49.102970 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.102970 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:04:49.102970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0649086D0>]}
[0m13:04:49.102970 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:04:49.102970 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:04:49.102970 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:04:49.102970 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:04:49.115824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:04:49.116841 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:04:49.118243 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:04:49.118243 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:04:49.126922 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:04:49.128425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.128425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:04:49.129431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.165215 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.166216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.166216 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:04:49.173278 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:04:49.178253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.178253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:04:49.179222 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.180277 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.180277 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:04:49.180277 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.184788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:04:49.184788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.184788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:04:49.184788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.184788 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:04:49.184788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:04:49.184788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:04:49.184788 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.196306 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:04:49.196306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067C48C10>]}
[0m13:04:49.196306 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.08s]
[0m13:04:49.196306 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:04:49.196306 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:04:49.199650 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:04:49.200671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:04:49.200671 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:04:49.203754 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.204737 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:04:49.208743 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.209774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.210742 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:04:49.210742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.245974 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.247004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.247004 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:04:49.252414 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:04:49.255435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.255435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:04:49.256479 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.256479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.256479 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:04:49.256479 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.256479 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:04:49.256479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.256479 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:04:49.256479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.256479 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:04:49.256479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:04:49.256479 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:04:49.256479 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.272299 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:04:49.272299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067B123D0>]}
[0m13:04:49.272299 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:04:49.272299 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:04:49.272299 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:04:49.276441 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:04:49.277451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:04:49.277451 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:04:49.280458 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:04:49.281524 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:04:49.285133 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:04:49.287131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:04:49.288140 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:04:49.288140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.322686 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.323716 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:04:49.323716 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        shipper_id,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders;
  );
  
[0m13:04:49.324723 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: select * from raw_orders;
                                 ^

[0m13:04:49.324723 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: ROLLBACK
[0m13:04:49.325697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:04:49.330142 [debug] [Thread-1  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_orders;
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m13:04:49.330142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067C61F10>]}
[0m13:04:49.331138 [error] [Thread-1  ]: 4 of 13 ERROR creating sql table model public.stg_orders ....................... [[31mERROR[0m in 0.05s]
[0m13:04:49.332217 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:04:49.332217 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:04:49.332764 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:04:49.333768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:04:49.334769 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:04:49.336799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:04:49.337774 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:04:49.341767 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:04:49.341767 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.342769 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:04:49.342769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.377895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.378915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.378915 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:04:49.384757 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:04:49.388862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.388862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:04:49.388862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.388862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.388862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:04:49.388862 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.388862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:04:49.388862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.388862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:04:49.388862 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.388862 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:04:49.388862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:04:49.388862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:04:49.388862 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.404521 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:04:49.404521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067C7AF70>]}
[0m13:04:49.404521 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:04:49.404521 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:04:49.404521 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:04:49.409428 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:04:49.410436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:04:49.410436 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:04:49.413439 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.414456 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:04:49.420602 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.422122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.423128 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:04:49.423128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.456048 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.457044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.457044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:04:49.458122 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:04:49.458122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.458122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:04:49.458122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.458122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.458122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:04:49.458122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.458122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:04:49.458122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.458122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:04:49.458122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.473905 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:04:49.473905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:04:49.473905 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:04:49.473905 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.473905 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:04:49.473905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067C48C10>]}
[0m13:04:49.473905 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:04:49.483916 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:04:49.484254 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:04:49.484254 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:04:49.485286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:04:49.486277 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:04:49.489281 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.490279 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:04:49.495293 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.496266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.496266 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:04:49.496266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:04:49.539278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.539278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.540278 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:04:49.548276 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:04:49.551348 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.551348 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:04:49.552993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.555072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.555072 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:04:49.555072 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:04:49.555072 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:04:49.555072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.555072 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:04:49.555072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.555072 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:04:49.555072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:04:49.555072 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:04:49.555072 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:04:49.555072 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:04:49.555072 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9f78e2-4c60-44ae-84b5-d6a291dade77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F067CB9340>]}
[0m13:04:49.555072 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:04:49.570897 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:04:49.570897 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:04:49.573033 [info ] [Thread-1  ]: 8 of 13 SKIP relation public.int_monthly_employee_revenue ...................... [[33mSKIP[0m]
[0m13:04:49.574039 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:04:49.574039 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:04:49.575245 [info ] [Thread-1  ]: 9 of 13 SKIP relation public.int_monthly_category_sales ........................ [[33mSKIP[0m]
[0m13:04:49.576283 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:04:49.576283 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:04:49.577281 [info ] [Thread-1  ]: 10 of 13 SKIP relation public.int_monthly_supplier_revenue ..................... [[33mSKIP[0m]
[0m13:04:49.578280 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:04:49.578280 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:04:49.579273 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:04:49.580283 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:04:49.580283 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:04:49.581274 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:04:49.581274 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:04:49.582479 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:04:49.582479 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:04:49.583490 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:04:49.584478 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:49.585520 [debug] [MainThread]: On master: BEGIN
[0m13:04:49.585520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:49.621504 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:04:49.622518 [debug] [MainThread]: On master: COMMIT
[0m13:04:49.622518 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:49.622518 [debug] [MainThread]: On master: COMMIT
[0m13:04:49.623530 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:04:49.623530 [debug] [MainThread]: On master: Close
[0m13:04:49.623530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:49.624535 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:04:49.624693 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:04:49.624693 [debug] [MainThread]: Connection 'model.dbt_dskola_project.stg_suppliers' was properly closed.
[0m13:04:49.624693 [info ] [MainThread]: 
[0m13:04:49.624693 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m13:04:49.628150 [debug] [MainThread]: Command end result
[0m13:04:49.656154 [info ] [MainThread]: 
[0m13:04:49.657157 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:04:49.658159 [info ] [MainThread]: 
[0m13:04:49.659156 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  syntax error at or near ";"
  LINE 22: select * from raw_orders;
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m13:04:49.660156 [info ] [MainThread]: 
[0m13:04:49.660156 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=6 TOTAL=13
[0m13:04:49.662245 [debug] [MainThread]: Command `dbt run` failed at 13:04:49.662245 after 1.64 seconds
[0m13:04:49.662245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F064541C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06654A160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0676DDCA0>]}
[0m13:04:49.663162 [debug] [MainThread]: Flushing usage events
[0m13:05:07.828696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FAF60C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FD9FAE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FD9FAD60>]}


============================== 13:05:07.834274 | d765375f-a639-4faa-bde8-94dfc972d005 ==============================
[0m13:05:07.834274 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:05:07.834274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:07.888344 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:05:07.888344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FAE33160>]}
[0m13:05:07.888344 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:05:07.900602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FAE33190>]}
[0m13:05:08.013930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FAE27490>]}
[0m13:05:08.059389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FCF59670>]}
[0m13:05:08.059389 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:05:08.069772 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:05:08.206716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:08.206716 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_orders.sql
[0m13:05:08.380547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:05:08.399394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE117F10>]}
[0m13:05:08.489507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE0FDC70>]}
[0m13:05:08.489507 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:05:08.489507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE126DC0>]}
[0m13:05:08.493838 [info ] [MainThread]: 
[0m13:05:08.495850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:08.500856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:05:08.556426 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:05:08.556426 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:05:08.556426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:08.587680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:05:08.587680 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:05:08.587680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:05:08.603281 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:05:08.603281 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:05:08.603281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:08.634971 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:05:08.634971 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:05:08.634971 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:08.634971 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:05:08.634971 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:05:08.634971 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:05:08.652025 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:08.652025 [debug] [MainThread]: On master: BEGIN
[0m13:05:08.652025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:08.683282 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:08.686091 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:08.686091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:08.693121 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:05:08.696021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE1B7E20>]}
[0m13:05:08.696021 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:08.696021 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:08.696021 [debug] [MainThread]: On master: BEGIN
[0m13:05:08.699352 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:08.699352 [debug] [MainThread]: On master: COMMIT
[0m13:05:08.699352 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:08.699352 [debug] [MainThread]: On master: COMMIT
[0m13:05:08.699352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:08.699352 [debug] [MainThread]: On master: Close
[0m13:05:08.699352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:08.699352 [info ] [MainThread]: 
[0m13:05:08.705854 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:05:08.706871 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:05:08.707863 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:05:08.707863 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:05:08.717872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:05:08.719871 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:05:08.758944 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:05:08.761047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.761047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:05:08.761944 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:05:08.792641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:08.793647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.793647 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:05:08.797615 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:05:08.797615 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.797615 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:05:08.797615 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:08.851662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.851662 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:05:08.851662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:08.870337 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:05:08.870337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.870337 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:05:08.870337 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:08.875927 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:05:08.875927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:05:08.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:05:08.875927 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:08.875927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:05:08.875927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FB3286D0>]}
[0m13:05:08.875927 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:05:08.891558 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:05:08.891558 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:05:08.893436 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:05:08.894444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:05:08.894444 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:05:08.898441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:05:08.899443 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:05:08.902827 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:05:08.904793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.904793 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:05:08.905795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:08.940348 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:08.941363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.941363 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:05:08.947185 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:05:08.950198 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.950198 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:05:08.951757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:08.951757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.951757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:05:08.951757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:08.951757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:05:08.951757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.951757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:05:08.951757 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:08.951757 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:05:08.951757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:05:08.951757 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:05:08.966609 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:08.967608 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:05:08.968605 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE1B7820>]}
[0m13:05:08.968605 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:05:08.969626 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:05:08.970604 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:05:08.970604 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:05:08.971609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:05:08.972598 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:05:08.975108 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:05:08.976144 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:05:08.980116 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:05:08.981113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:08.982114 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:05:08.982114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:09.016120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.016120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:09.017135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:05:09.020124 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:05:09.022652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:09.022652 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:05:09.022652 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.022652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:09.022652 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:05:09.022652 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.022652 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:05:09.022652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:09.022652 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:05:09.022652 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:09.022652 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:05:09.022652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:05:09.036192 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:05:09.036192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:09.036192 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:05:09.036192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE6428B0>]}
[0m13:05:09.036192 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:05:09.036192 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:05:09.036192 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:05:09.043597 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:05:09.044603 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:05:09.044603 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:05:09.047602 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:05:09.048602 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:05:09.054075 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:05:09.056063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:05:09.056063 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:05:09.056063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:09.090911 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.090911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:05:09.090911 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        shipper_id,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:05:09.090911 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "shipper_id" does not exist
LINE 18:         shipper_id,
                 ^

[0m13:05:09.090911 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: ROLLBACK
[0m13:05:09.090911 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:05:09.098939 [debug] [Thread-1  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  column "shipper_id" does not exist
  LINE 18:         shipper_id,
                   ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m13:05:09.099959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE68C130>]}
[0m13:05:09.099959 [error] [Thread-1  ]: 4 of 13 ERROR creating sql table model public.stg_orders ....................... [[31mERROR[0m in 0.06s]
[0m13:05:09.100952 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:05:09.100952 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:05:09.101964 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:05:09.102957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:05:09.102957 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:05:09.105986 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:05:09.106957 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:05:09.109981 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:05:09.111048 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.111048 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:05:09.112031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:09.149438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.149438 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.150429 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:05:09.152025 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:05:09.152025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.152025 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:05:09.152025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.152025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.152025 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:05:09.152025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.152025 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:05:09.152025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.152025 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:05:09.167717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:09.167717 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:05:09.167717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:05:09.167717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:05:09.167717 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:09.167717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:05:09.177732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE698A60>]}
[0m13:05:09.177732 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:05:09.177732 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:05:09.177732 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:05:09.180050 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:05:09.181057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:05:09.182067 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:05:09.185063 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.185063 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:05:09.192058 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.193069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.194066 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:05:09.194066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:09.228076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.229108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.230112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:05:09.235136 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:05:09.239146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.239146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:05:09.240146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.242146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.242146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:05:09.242146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.242146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:05:09.242146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.242146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:05:09.242146 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:09.242146 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:05:09.242146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:05:09.242146 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:05:09.252849 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:09.252849 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:05:09.252849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FDF68F10>]}
[0m13:05:09.252849 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:05:09.252849 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:05:09.252849 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:05:09.258176 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:05:09.259176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:05:09.259176 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:05:09.262277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.263224 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:05:09.267178 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.268183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.268696 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:05:09.268696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:09.304246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.305280 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.305280 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:05:09.311313 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:05:09.311313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.311313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:05:09.311313 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.311313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.311313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:05:09.311313 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:05:09.311313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:05:09.311313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.311313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:05:09.311313 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:05:09.326846 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:05:09.327873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:05:09.327873 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:05:09.331858 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:05:09.332859 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:05:09.333850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd765375f-a639-4faa-bde8-94dfc972d005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FE6D0520>]}
[0m13:05:09.333850 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.08s]
[0m13:05:09.334851 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:05:09.336356 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:05:09.336356 [info ] [Thread-1  ]: 8 of 13 SKIP relation public.int_monthly_employee_revenue ...................... [[33mSKIP[0m]
[0m13:05:09.337360 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:05:09.337360 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:05:09.337360 [info ] [Thread-1  ]: 9 of 13 SKIP relation public.int_monthly_category_sales ........................ [[33mSKIP[0m]
[0m13:05:09.338370 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:05:09.338370 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:05:09.339375 [info ] [Thread-1  ]: 10 of 13 SKIP relation public.int_monthly_supplier_revenue ..................... [[33mSKIP[0m]
[0m13:05:09.340374 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:05:09.340374 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:05:09.340374 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:05:09.341377 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:05:09.341377 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:05:09.342371 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:05:09.342371 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:05:09.343365 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:05:09.343365 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:05:09.344366 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:05:09.345373 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:09.345373 [debug] [MainThread]: On master: BEGIN
[0m13:05:09.346365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:09.473187 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:05:09.473187 [debug] [MainThread]: On master: COMMIT
[0m13:05:09.473187 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:09.473187 [debug] [MainThread]: On master: COMMIT
[0m13:05:09.473187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:05:09.473187 [debug] [MainThread]: On master: Close
[0m13:05:09.473187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:09.473187 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:05:09.473187 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:05:09.473187 [debug] [MainThread]: Connection 'model.dbt_dskola_project.stg_suppliers' was properly closed.
[0m13:05:09.473187 [info ] [MainThread]: 
[0m13:05:09.473187 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m13:05:09.482558 [debug] [MainThread]: Command end result
[0m13:05:09.511573 [info ] [MainThread]: 
[0m13:05:09.512574 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:05:09.513577 [info ] [MainThread]: 
[0m13:05:09.514577 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  column "shipper_id" does not exist
  LINE 18:         shipper_id,
                   ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m13:05:09.515567 [info ] [MainThread]: 
[0m13:05:09.515567 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=6 TOTAL=13
[0m13:05:09.517578 [debug] [MainThread]: Command `dbt run` failed at 13:05:09.516575 after 1.73 seconds
[0m13:05:09.517578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FAF60C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FDFA0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6FDFA0070>]}
[0m13:05:09.517578 [debug] [MainThread]: Flushing usage events
[0m13:07:18.681414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FFC2ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982697A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9805BA790>]}


============================== 13:07:18.685401 | 98447d41-6e96-468a-89e2-11a09a2b1fa8 ==============================
[0m13:07:18.685401 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:07:18.686398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:07:18.750945 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:07:18.751950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982A83190>]}
[0m13:07:18.751950 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:07:18.753051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982A831C0>]}
[0m13:07:18.869514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982681D90>]}
[0m13:07:18.916236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982A978E0>]}
[0m13:07:18.917638 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:07:18.925161 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:07:19.066868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:07:19.066868 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\staging\stg_orders.sql
[0m13:07:19.245818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:07:19.264666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982F27F40>]}
[0m13:07:19.352118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982F0BE50>]}
[0m13:07:19.352118 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:07:19.352118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982F279A0>]}
[0m13:07:19.360728 [info ] [MainThread]: 
[0m13:07:19.360728 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:19.360728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:07:19.423121 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:07:19.423121 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:07:19.423121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:19.454875 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:07:19.454875 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:07:19.454875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:07:19.470671 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:07:19.470671 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:07:19.470671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:19.502269 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.502269 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:07:19.502269 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:07:19.517024 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:07:19.518208 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:07:19.518208 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:07:19.524202 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.524202 [debug] [MainThread]: On master: BEGIN
[0m13:07:19.527356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:19.549528 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.549528 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.549528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:07:19.565314 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:07:19.565314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982DBC9D0>]}
[0m13:07:19.565314 [debug] [MainThread]: On master: ROLLBACK
[0m13:07:19.565314 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.565314 [debug] [MainThread]: On master: BEGIN
[0m13:07:19.565314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.565314 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.565314 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:19.565314 [debug] [MainThread]: On master: COMMIT
[0m13:07:19.565314 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.565314 [debug] [MainThread]: On master: Close
[0m13:07:19.565314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:07:19.575322 [info ] [MainThread]: 
[0m13:07:19.579082 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:07:19.580075 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:07:19.581081 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:07:19.582065 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:07:19.589077 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:07:19.591097 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:07:19.631152 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:07:19.632231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.632231 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:07:19.633219 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:07:19.778850 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.778850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.778850 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:07:19.778850 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:07:19.794365 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.794365 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:07:19.794365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.826208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.826208 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:07:19.826208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.841933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:07:19.841933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.841933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:07:19.841933 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.858254 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:07:19.858254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:07:19.858254 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:07:19.867759 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.867759 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:07:19.873350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B980007700>]}
[0m13:07:19.873350 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.29s]
[0m13:07:19.873350 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:07:19.873350 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:07:19.877626 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:07:19.877626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:07:19.878786 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:07:19.878786 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:07:19.878786 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:07:19.878786 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:07:19.887709 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.887709 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:07:19.887709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:19.928489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:19.928489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.929491 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:07:19.935489 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:07:19.938514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.939505 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:07:19.939505 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.942485 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.942485 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:07:19.943514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:19.943514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:07:19.943514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.943514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:07:19.943514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:19.943514 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:07:19.943514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:07:19.943514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:07:19.943514 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:19.943514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:07:19.943514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982FEFEE0>]}
[0m13:07:19.943514 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:07:19.943514 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:07:19.943514 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:07:19.958488 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:07:19.960014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:07:19.960014 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:07:19.963032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:07:19.964002 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:07:19.968020 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:07:19.969024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:19.969024 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:07:19.970537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.005064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.005064 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:20.006066 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:07:20.011324 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:07:20.014401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:20.014401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:07:20.014401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.014401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:20.014401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:07:20.014401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.014401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:07:20.014401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:20.014401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:07:20.014401 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.014401 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:07:20.014401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:07:20.014401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:07:20.014401 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:20.030243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:07:20.030243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9833412E0>]}
[0m13:07:20.030243 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:07:20.030243 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:07:20.030243 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:07:20.034665 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:07:20.035673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:07:20.036681 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:07:20.038677 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:07:20.039693 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:07:20.044189 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:07:20.046182 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.046182 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:07:20.047211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.081590 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.081590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.082608 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:07:20.082670 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:07:20.082670 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.082670 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:07:20.082670 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.095175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.095175 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:07:20.095175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.098716 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:07:20.099303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.099303 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:07:20.099303 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.099303 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:07:20.099303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:07:20.099303 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:07:20.099303 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:20.099303 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:07:20.099303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982DA4DC0>]}
[0m13:07:20.099303 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.06s]
[0m13:07:20.099303 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:07:20.099303 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:07:20.099303 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:07:20.111570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:07:20.112584 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:07:20.115585 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:07:20.116603 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:07:20.120600 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:07:20.121585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.121585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:07:20.122586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.158113 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.159145 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.159145 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:07:20.166210 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:07:20.169238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.169238 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:07:20.170233 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.172817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.172817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:07:20.172817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.172817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:07:20.172817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.172817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:07:20.172817 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.172817 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:07:20.172817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:07:20.172817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:07:20.172817 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:20.172817 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:07:20.172817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B980007700>]}
[0m13:07:20.172817 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.06s]
[0m13:07:20.188453 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:07:20.189070 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:07:20.189589 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:07:20.190607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:07:20.190607 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:07:20.193620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.194617 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:07:20.198161 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.200161 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.200161 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:07:20.200161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.235190 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.235190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.236209 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:07:20.241429 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:07:20.242525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.242525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:07:20.242525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.242525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.242525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:07:20.242525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.242525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:07:20.242525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.242525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:07:20.242525 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.242525 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:07:20.242525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:07:20.242525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:07:20.258365 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:20.258365 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:07:20.258365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98343B910>]}
[0m13:07:20.258365 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:07:20.258365 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:07:20.258365 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:07:20.263830 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:07:20.264837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:07:20.264837 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:07:20.268848 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.269367 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:07:20.276386 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.277389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.277389 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:07:20.278384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.312260 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.312260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.312260 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:07:20.312260 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:07:20.312260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.312260 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:07:20.312260 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.328588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.328588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:07:20.328588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:07:20.328588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:07:20.328588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.328588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:07:20.328588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.328588 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:07:20.328588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:07:20.328588 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:07:20.338093 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:07:20.338093 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:07:20.338093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982D77DC0>]}
[0m13:07:20.338093 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:07:20.343617 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:07:20.343617 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:07:20.343617 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:07:20.345359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:07:20.346365 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:07:20.349366 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:07:20.350364 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:07:20.354369 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:07:20.356364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:07:20.356364 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:07:20.357364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.495486 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.503529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:07:20.503529 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:07:20.503529 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 25:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:07:20.503529 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:07:20.503529 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:07:20.503529 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 25:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:07:20.503529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9834C8AC0>]}
[0m13:07:20.503529 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.16s]
[0m13:07:20.503529 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:07:20.503529 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:07:20.503529 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:07:20.512790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:07:20.512790 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:07:20.516801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:07:20.517824 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:07:20.524796 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:07:20.525828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:07:20.525828 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:07:20.526795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.564256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.564256 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:07:20.565272 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:07:20.566356 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:07:20.566356 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:07:20.567261 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:07:20.568271 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:07:20.569260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9834A3FA0>]}
[0m13:07:20.569379 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.06s]
[0m13:07:20.569379 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:07:20.569379 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:07:20.571381 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:07:20.572397 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:07:20.572397 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:07:20.576399 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:07:20.576916 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:07:20.580950 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:07:20.582659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:07:20.582659 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:07:20.583677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:07:20.617214 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.618230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:07:20.618230 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:07:20.620211 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:07:20.620211 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:07:20.621211 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:07:20.622212 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:07:20.622212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98447d41-6e96-468a-89e2-11a09a2b1fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B980007700>]}
[0m13:07:20.622212 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:07:20.623789 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:07:20.623789 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:07:20.624944 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:07:20.625951 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:07:20.625951 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:07:20.626960 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:07:20.626960 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:07:20.627962 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:07:20.627962 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:07:20.628962 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:07:20.629957 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:20.629957 [debug] [MainThread]: On master: BEGIN
[0m13:07:20.629957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:20.665957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:07:20.665957 [debug] [MainThread]: On master: COMMIT
[0m13:07:20.666952 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:20.666952 [debug] [MainThread]: On master: COMMIT
[0m13:07:20.667957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:07:20.667957 [debug] [MainThread]: On master: Close
[0m13:07:20.668950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:20.668950 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:07:20.668950 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:07:20.669949 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:07:20.669949 [info ] [MainThread]: 
[0m13:07:20.669949 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m13:07:20.673489 [debug] [MainThread]: Command end result
[0m13:07:20.704486 [info ] [MainThread]: 
[0m13:07:20.705500 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:07:20.705500 [info ] [MainThread]: 
[0m13:07:20.706509 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 25:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:07:20.707491 [info ] [MainThread]: 
[0m13:07:20.709502 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:07:20.710490 [info ] [MainThread]: 
[0m13:07:20.711492 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:07:20.712498 [info ] [MainThread]: 
[0m13:07:20.713498 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:07:20.715492 [debug] [MainThread]: Command `dbt run` failed at 13:07:20.714502 after 2.08 seconds
[0m13:07:20.715492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9FFC2ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982B589D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B982B58FA0>]}
[0m13:07:20.716490 [debug] [MainThread]: Flushing usage events
[0m13:08:36.986787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96ACCECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D737A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96B64A790>]}


============================== 13:08:36.990802 | 7183b992-4026-4485-b46d-6be013873587 ==============================
[0m13:08:36.990802 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:08:36.990802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:37.051374 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:08:37.053375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7183b992-4026-4485-b46d-6be013873587', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96AB93190>]}
[0m13:08:37.053375 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:08:37.054368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7183b992-4026-4485-b46d-6be013873587', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96AB931C0>]}
[0m13:08:37.181380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D722D90>]}
[0m13:08:37.231160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96ABA68E0>]}
[0m13:08:37.232159 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:08:37.240160 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:08:37.392450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:08:37.392450 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:08:37.583732 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:08:37.602827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DE85EE0>]}
[0m13:08:37.703055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DE59AC0>]}
[0m13:08:37.703055 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:08:37.703055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DE85DC0>]}
[0m13:08:37.706035 [info ] [MainThread]: 
[0m13:08:37.706035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:37.712048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:08:37.766460 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:08:37.766460 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:08:37.766460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:37.811236 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:08:37.811236 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:08:37.811236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:08:37.821261 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:08:37.826284 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:08:37.826284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:37.857751 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:08:37.857751 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:08:37.857751 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:08:37.857751 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:08:37.867763 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:08:37.867763 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:08:37.876514 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:37.876514 [debug] [MainThread]: On master: BEGIN
[0m13:08:37.876514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:37.908293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:37.908810 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:37.908810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:37.915915 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:08:37.915915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DE31160>]}
[0m13:08:37.915915 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:37.915915 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:37.915915 [debug] [MainThread]: On master: BEGIN
[0m13:08:37.915915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:37.920930 [debug] [MainThread]: On master: COMMIT
[0m13:08:37.920930 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:37.920930 [debug] [MainThread]: On master: COMMIT
[0m13:08:37.920930 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:08:37.920930 [debug] [MainThread]: On master: Close
[0m13:08:37.920930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:37.920930 [info ] [MainThread]: 
[0m13:08:37.927082 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:08:37.928081 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:08:37.929074 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:08:37.930083 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:08:37.941073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:08:37.942099 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:08:37.979655 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:08:37.980650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:37.981628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:08:37.981628 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:08:38.003227 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.003227 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:38.003227 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:08:38.014405 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:08:38.024437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:38.024437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:08:38.024437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.062059 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:38.062059 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:08:38.062059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.077259 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:08:38.077259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:38.077259 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:08:38.077259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.077259 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:08:38.092968 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:08:38.092968 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:08:38.092968 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.092968 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:08:38.092968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E2ACE50>]}
[0m13:08:38.092968 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:08:38.103478 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:08:38.103478 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:08:38.103478 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:08:38.106005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:08:38.107044 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:08:38.109637 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:08:38.111180 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:08:38.115751 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:08:38.117399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.117932 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:08:38.117932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.253335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.254352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.254352 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:08:38.260338 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:08:38.263340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.264340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:08:38.264340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.268337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.268337 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:08:38.269346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.271353 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:08:38.271353 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.272352 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:08:38.273387 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.276639 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:08:38.276639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:08:38.276639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:08:38.276639 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.276639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:08:38.283500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E293760>]}
[0m13:08:38.284506 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.18s]
[0m13:08:38.285506 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:08:38.285506 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:08:38.286505 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:08:38.286505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:08:38.287505 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:08:38.289564 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.290540 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:08:38.294547 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.295541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.295541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:08:38.296548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.330799 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.331815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.331815 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:08:38.338228 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:08:38.342225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.342225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:08:38.343243 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.346046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.346046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:08:38.346046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.346046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:08:38.346046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.346046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:08:38.346046 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.346046 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:08:38.346046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:08:38.346046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:08:38.346046 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.346046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:08:38.346046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E3F69D0>]}
[0m13:08:38.346046 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:08:38.361274 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:08:38.362111 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:08:38.362111 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:08:38.363129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:08:38.364125 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:08:38.367128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:08:38.369127 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:08:38.376658 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:08:38.377657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.378651 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:08:38.378651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.419595 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.419595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.419595 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:08:38.423019 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:08:38.423019 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.423019 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:08:38.423019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.423019 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.423019 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:08:38.423019 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.437531 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:08:38.437531 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.437531 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:08:38.437531 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.437531 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:08:38.437531 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:08:38.437531 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:08:38.437531 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.437531 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:08:38.437531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E303D60>]}
[0m13:08:38.453165 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:08:38.453165 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:08:38.453165 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:08:38.456076 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:08:38.458093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:08:38.458093 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:08:38.461092 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:08:38.462095 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:08:38.467097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:08:38.468092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.469424 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:08:38.470083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.513160 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.514156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.514156 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:08:38.521148 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:08:38.524170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.525697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:08:38.526709 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.530708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.531753 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:08:38.532761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.533673 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:08:38.533673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.533673 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:08:38.533673 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.533673 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:08:38.533673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:08:38.533673 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:08:38.546493 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.547019 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:08:38.548534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DCBCE50>]}
[0m13:08:38.549922 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.09s]
[0m13:08:38.550928 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:08:38.551938 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:08:38.551938 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:08:38.552938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:08:38.553928 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:08:38.556939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.556939 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:08:38.561938 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.561938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.562938 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:08:38.562938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.702488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.702488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.704019 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:08:38.707169 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:08:38.715115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.715115 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:08:38.716106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.719119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.719119 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:08:38.720226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.722114 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:08:38.722114 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.723096 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:08:38.724089 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.726112 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:08:38.727112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:08:38.727112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:08:38.730582 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.730582 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:08:38.730582 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DCDDAF0>]}
[0m13:08:38.730582 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.18s]
[0m13:08:38.730582 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:08:38.730582 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:08:38.730582 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:08:38.730582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:08:38.730582 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:08:38.730582 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.730582 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:08:38.744064 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.745039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.746037 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:08:38.746037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.782851 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.783986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.783986 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:08:38.783986 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:08:38.783986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.783986 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:08:38.783986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.783986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.783986 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:08:38.783986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:08:38.799622 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:08:38.799622 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.799622 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:08:38.799622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:08:38.804129 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:08:38.804129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:08:38.804129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:08:38.804129 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:08:38.804129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:08:38.804129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96DCDDAF0>]}
[0m13:08:38.804129 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:08:38.804129 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:08:38.804129 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:08:38.815754 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:08:38.816624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:08:38.817614 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:08:38.820694 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:08:38.821683 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:08:38.827133 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:08:38.828134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:08:38.828134 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:08:38.829141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.866029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.866029 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:08:38.866029 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_TRUNC('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:08:38.868055 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 25:     DATE_TRUNC('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:08:38.869030 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:08:38.869030 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:08:38.872533 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 25:     DATE_TRUNC('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:08:38.872533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CCCA6A0>]}
[0m13:08:38.873628 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.06s]
[0m13:08:38.873628 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:08:38.873628 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:08:38.875286 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:08:38.876301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:08:38.876301 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:08:38.880313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:08:38.880313 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:08:38.886290 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:08:38.887290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:08:38.888290 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:08:38.888290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.926833 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.926833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:08:38.927845 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:08:38.928850 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:08:38.928850 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:08:38.929833 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:08:38.930833 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:08:38.930833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CCCA6A0>]}
[0m13:08:38.931834 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:08:38.932828 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:08:38.932828 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:08:38.933821 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:08:38.934821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:08:38.934821 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:08:38.938256 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:08:38.939269 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:08:38.943239 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:08:38.944235 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:08:38.944235 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:08:38.944235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:08:38.986073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:08:38.986073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:08:38.986970 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:08:38.988041 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:08:38.988958 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:08:38.989574 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:08:38.990962 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:08:38.990962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7183b992-4026-4485-b46d-6be013873587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E3E4910>]}
[0m13:08:38.991966 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.06s]
[0m13:08:38.993051 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:08:38.993051 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:08:38.994003 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:08:38.995008 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:08:38.995008 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:08:38.995008 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:08:38.996008 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:08:38.997016 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:08:38.997016 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:08:38.998007 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:08:38.999015 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:38.999015 [debug] [MainThread]: On master: BEGIN
[0m13:08:38.999015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:39.034503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:08:39.035531 [debug] [MainThread]: On master: COMMIT
[0m13:08:39.035531 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:39.035531 [debug] [MainThread]: On master: COMMIT
[0m13:08:39.036531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:08:39.036531 [debug] [MainThread]: On master: Close
[0m13:08:39.037520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:39.037520 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:08:39.037520 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:08:39.037520 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:08:39.038519 [info ] [MainThread]: 
[0m13:08:39.038519 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m13:08:39.041515 [debug] [MainThread]: Command end result
[0m13:08:39.071511 [info ] [MainThread]: 
[0m13:08:39.073512 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:08:39.075018 [info ] [MainThread]: 
[0m13:08:39.076026 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 25:     DATE_TRUNC('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:08:39.078026 [info ] [MainThread]: 
[0m13:08:39.079033 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:08:39.081026 [info ] [MainThread]: 
[0m13:08:39.081026 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:08:39.083025 [info ] [MainThread]: 
[0m13:08:39.083025 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:08:39.085036 [debug] [MainThread]: Command `dbt run` failed at 13:08:39.085036 after 2.15 seconds
[0m13:08:39.085036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96ACCECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96ABA68E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CCC9730>]}
[0m13:08:39.086041 [debug] [MainThread]: Flushing usage events
[0m13:10:40.977821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A391412C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E77AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E778E0>]}


============================== 13:10:40.977821 | 4672a34b-1fb1-437b-bdad-f889c60fc93c ==============================
[0m13:10:40.977821 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:10:40.977821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'profiles_dir': './', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m13:10:41.047114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:10:41.047114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3912E3160>]}
[0m13:10:41.047114 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:10:41.052021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3912E3190>]}
[0m13:10:41.149406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E59520>]}
[0m13:10:41.196599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A393E82340>]}
[0m13:10:41.196599 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:10:41.210183 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:10:41.342075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:10:41.342075 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:10:41.534418 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:10:41.547411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3945CAF40>]}
[0m13:10:41.629654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394592130>]}
[0m13:10:41.629654 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:10:41.629654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3945BD7F0>]}
[0m13:10:41.640643 [info ] [MainThread]: 
[0m13:10:41.641650 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:41.646650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:10:41.708957 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:10:41.708957 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:10:41.709972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:41.745003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:10:41.746025 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:10:41.747995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:10:41.754017 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:10:41.754017 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:10:41.754017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:41.783299 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:41.783299 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:10:41.783299 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:10:41.783299 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:10:41.791330 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:10:41.791330 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:10:41.798317 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:41.799319 [debug] [MainThread]: On master: BEGIN
[0m13:10:41.799319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:41.828892 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:41.828892 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:41.829912 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:41.837890 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:10:41.839912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A391393220>]}
[0m13:10:41.839912 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:41.840888 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:41.840888 [debug] [MainThread]: On master: BEGIN
[0m13:10:41.840888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:41.841890 [debug] [MainThread]: On master: COMMIT
[0m13:10:41.841890 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:41.841890 [debug] [MainThread]: On master: COMMIT
[0m13:10:41.842958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:41.842958 [debug] [MainThread]: On master: Close
[0m13:10:41.842958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:41.843964 [info ] [MainThread]: 
[0m13:10:41.846964 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:10:41.847992 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:10:41.848972 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:10:41.848972 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:10:41.855975 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:10:41.856978 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:10:41.897592 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:10:41.898595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:41.899611 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:10:41.899611 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:10:41.927490 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:41.927490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:41.933017 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:10:41.933017 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:10:41.981918 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:41.982979 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:10:41.983920 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:41.985920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:41.985920 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:10:41.987169 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:41.992068 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:10:41.992068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:41.992068 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:10:41.992068 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.007301 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:10:42.007301 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:10:42.007301 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:10:42.017394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.017394 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:10:42.017394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A5CDC0>]}
[0m13:10:42.017394 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:10:42.022936 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:10:42.022936 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:10:42.024567 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:10:42.025574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:10:42.025574 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:10:42.029596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:10:42.029596 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:10:42.034583 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:10:42.035581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.036583 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:10:42.036583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.072587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.072587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.072587 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:10:42.078565 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:10:42.082221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.082221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:10:42.082221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.082221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.082221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:10:42.082221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.082221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:10:42.082221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.082221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:10:42.082221 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.082221 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:10:42.082221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:10:42.082221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:10:42.082221 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.097876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:10:42.097876 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A5C190>]}
[0m13:10:42.097876 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:10:42.097876 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:10:42.097876 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:10:42.097876 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:10:42.102817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:10:42.102817 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:10:42.105850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.106834 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:10:42.110811 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.111812 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.111812 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:10:42.111812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.147346 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.147346 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.148386 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:10:42.153665 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:10:42.156670 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.156670 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:10:42.157671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.159695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.159695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:10:42.159695 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.159695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:10:42.159695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.159695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:10:42.159695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.159695 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:10:42.159695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:10:42.159695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:10:42.159695 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.159695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:10:42.159695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A5C190>]}
[0m13:10:42.159695 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:10:42.174407 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:10:42.175413 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:10:42.175413 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:10:42.176850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:10:42.177863 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:10:42.181854 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:10:42.182855 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:10:42.187430 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:10:42.188428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.189437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:10:42.189437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.324154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.324154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.324154 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:10:42.339818 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:10:42.339818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.339818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:10:42.339818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.339818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.339818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:10:42.339818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.339818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:10:42.339818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.339818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:10:42.339818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.354853 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:10:42.354853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:10:42.354853 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:10:42.354853 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.354853 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:10:42.354853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39442F1C0>]}
[0m13:10:42.354853 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.18s]
[0m13:10:42.354853 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:10:42.354853 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:10:42.364624 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:10:42.365630 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:10:42.365630 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:10:42.369628 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:10:42.369628 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:10:42.375167 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:10:42.376181 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.377175 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:10:42.377175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.413107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.414112 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.414112 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:10:42.421120 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:10:42.425617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.426621 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:10:42.426621 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.429687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.429687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:10:42.429687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.429687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:10:42.429687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.429687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:10:42.429687 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.429687 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:10:42.429687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:10:42.429687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:10:42.429687 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.429687 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:10:42.429687 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A3AEB0>]}
[0m13:10:42.429687 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:10:42.429687 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:10:42.429687 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:10:42.445607 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:10:42.446619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:10:42.447607 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:10:42.450606 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.451612 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:10:42.455606 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.456606 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.456606 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:10:42.457607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.491493 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.492584 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.492584 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:10:42.499087 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:10:42.499087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.499087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:10:42.499087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.499087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.499087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:10:42.499087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.499087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:10:42.499087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.499087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:10:42.499087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.499087 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:10:42.499087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:10:42.499087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:10:42.517278 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.519359 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:10:42.519721 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A3AEB0>]}
[0m13:10:42.520728 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:10:42.521723 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:10:42.521723 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:10:42.522722 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:10:42.523722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:10:42.523722 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:10:42.527232 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.527232 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:10:42.532232 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.533518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.534533 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:10:42.534533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.570409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.570409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.570409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:10:42.575425 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:10:42.575425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.575425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:10:42.575425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.575425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.575425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:10:42.584462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:42.584462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:10:42.584462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.584462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:10:42.584462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.584462 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:10:42.584462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:10:42.584462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:10:42.584462 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:42.584462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:10:42.584462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394B4FA60>]}
[0m13:10:42.584462 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.06s]
[0m13:10:42.584462 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:10:42.584462 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:10:42.597885 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:10:42.598892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:10:42.598892 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:10:42.646470 [debug] [Thread-1  ]: Compilation Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  'DATE_TRUNC' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:42.648499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394B7DA00>]}
[0m13:10:42.648499 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.05s]
[0m13:10:42.649454 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:10:42.649454 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:10:42.650455 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:10:42.651448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:10:42.652450 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:10:42.655446 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:10:42.656447 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:10:42.662455 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:10:42.664518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:10:42.665456 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:10:42.666457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.702512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.702512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:10:42.703528 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:10:42.704520 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:10:42.704520 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:10:42.705511 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:10:42.707582 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:10:42.707582 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394974610>]}
[0m13:10:42.707582 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.06s]
[0m13:10:42.707582 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:10:42.707582 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:10:42.710402 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:10:42.710909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:10:42.711930 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:10:42.715927 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:10:42.715927 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:10:42.720929 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:10:42.722173 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:10:42.723174 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:10:42.723174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:42.856881 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.856881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:10:42.856881 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:10:42.866897 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:10:42.866897 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:10:42.866897 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:10:42.866897 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:10:42.866897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4672a34b-1fb1-437b-bdad-f889c60fc93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A394A38790>]}
[0m13:10:42.866897 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.16s]
[0m13:10:42.866897 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:10:42.872421 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:10:42.873435 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:10:42.874441 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:10:42.874441 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:10:42.874441 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:10:42.875948 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:10:42.876961 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:10:42.876961 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:10:42.877959 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:10:42.878960 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:42.878960 [debug] [MainThread]: On master: BEGIN
[0m13:10:42.879978 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:42.917953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:42.917953 [debug] [MainThread]: On master: COMMIT
[0m13:10:42.917953 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:42.918953 [debug] [MainThread]: On master: COMMIT
[0m13:10:42.918953 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:42.918953 [debug] [MainThread]: On master: Close
[0m13:10:42.920076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:42.920076 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:10:42.920954 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:10:42.920954 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:10:42.920954 [info ] [MainThread]: 
[0m13:10:42.921954 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m13:10:42.925961 [debug] [MainThread]: Command end result
[0m13:10:42.964519 [info ] [MainThread]: 
[0m13:10:42.965530 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:10:42.966531 [info ] [MainThread]: 
[0m13:10:42.968248 [error] [MainThread]:   Compilation Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  'DATE_TRUNC' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:42.969254 [info ] [MainThread]: 
[0m13:10:42.970275 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:10:42.971255 [info ] [MainThread]: 
[0m13:10:42.972263 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:10:42.973258 [info ] [MainThread]: 
[0m13:10:42.974265 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:10:42.975772 [debug] [MainThread]: Command `dbt run` failed at 13:10:42.975772 after 2.04 seconds
[0m13:10:42.975772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A391412C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3939E7F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A39442BE80>]}
[0m13:10:42.976779 [debug] [MainThread]: Flushing usage events
[0m13:18:18.309715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF19F2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4457AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF44578E0>]}


============================== 13:18:18.313665 | ba11f550-3d0a-4a08-85a0-529d86822ec2 ==============================
[0m13:18:18.313665 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:18:18.314664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:18:18.376357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:18:18.376357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF18C1160>]}
[0m13:18:18.376357 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:18:18.380186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF18C1190>]}
[0m13:18:18.494937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4439520>]}
[0m13:18:18.546649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4462340>]}
[0m13:18:18.548626 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:18:18.562781 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:18:18.739005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:18.740006 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:18:18.952516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:18:18.967517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4BAB130>]}
[0m13:18:19.074825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4BAD610>]}
[0m13:18:19.076826 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:18:19.077823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF39A40D0>]}
[0m13:18:19.080365 [info ] [MainThread]: 
[0m13:18:19.081342 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:19.090354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:18:19.162802 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:18:19.162802 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:18:19.163906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:19.209146 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:18:19.210675 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:18:19.213566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:18:19.222080 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:18:19.222080 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:18:19.223078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:19.260325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.261344 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:18:19.261344 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:19.267824 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:18:19.269846 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:18:19.270847 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:18:19.280109 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:19.280109 [debug] [MainThread]: On master: BEGIN
[0m13:18:19.280109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:19.312055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.312055 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:19.312055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:19.322061 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:18:19.322061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4B4FBE0>]}
[0m13:18:19.322061 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:19.322061 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:19.322061 [debug] [MainThread]: On master: BEGIN
[0m13:18:19.322061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.322061 [debug] [MainThread]: On master: COMMIT
[0m13:18:19.322061 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:19.322061 [debug] [MainThread]: On master: COMMIT
[0m13:18:19.322061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.322061 [debug] [MainThread]: On master: Close
[0m13:18:19.322061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:19.322061 [info ] [MainThread]: 
[0m13:18:19.332708 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:18:19.334706 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:18:19.335709 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:18:19.336709 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:18:19.344235 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:18:19.347208 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:18:19.385946 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:18:19.385946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.387096 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:18:19.387096 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:18:19.418694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.418694 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.419699 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:18:19.421984 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:18:19.472637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.472637 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:18:19.472637 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.472637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.472637 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:18:19.472637 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.492728 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:18:19.492728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.492728 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:18:19.492728 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.502729 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:18:19.502729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:19.502729 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:18:19.502729 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:19.512735 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:18:19.513079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF502E700>]}
[0m13:18:19.513079 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:18:19.513079 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:18:19.513079 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:18:19.518304 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:18:19.519312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:18:19.520311 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:18:19.523865 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:18:19.524871 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:18:19.529884 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:18:19.530886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.531874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:18:19.531874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:19.665305 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.665305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.665305 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:18:19.675319 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:18:19.675319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.675319 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:18:19.675319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.675319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.685357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:18:19.685357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.685357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:18:19.685357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.685357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:18:19.685357 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.685357 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:18:19.685357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:19.685357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:18:19.695326 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:19.695326 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:18:19.695326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF39E9F40>]}
[0m13:18:19.695326 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.18s]
[0m13:18:19.695326 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:18:19.695326 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:18:19.702997 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:18:19.704014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:18:19.704014 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:18:19.708005 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.709004 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:18:19.713012 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.714003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.715003 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:18:19.715003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:19.749700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.749700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.749700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:18:19.749700 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:18:19.759880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.759880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:18:19.759880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.759880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.759880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:18:19.759880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.759880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:18:19.759880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.759880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:18:19.759880 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.769917 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:18:19.769917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:19.769917 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:18:19.769917 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:19.769917 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:18:19.769917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4FBA310>]}
[0m13:18:19.769917 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:18:19.779924 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:18:19.779924 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:18:19.780815 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:18:19.781848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:18:19.781848 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:18:19.786877 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:18:19.787896 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:18:19.792876 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:18:19.793888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.794884 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:18:19.794884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:19.829132 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.830124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.830124 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:18:19.836124 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:18:19.839220 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.839220 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:18:19.839220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.843462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.843462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:18:19.843462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.843462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:18:19.843462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.843462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:18:19.843462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.849494 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:18:19.849494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:19.849494 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:18:19.849494 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:19.849494 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:18:19.849494 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4FA5040>]}
[0m13:18:19.849494 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:18:19.849494 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:18:19.849494 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:18:19.858350 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:18:19.859367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:18:19.859367 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:18:19.863381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:18:19.864381 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:18:19.869356 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:18:19.870358 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.871367 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:18:19.871367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:19.906910 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.907910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.907910 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:18:19.913902 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:18:19.915986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.915986 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:18:19.915986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.915986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.922489 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:18:19.922818 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.922818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:18:19.922818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.922818 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:18:19.925763 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.925763 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:18:19.925763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:19.925763 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:18:19.925763 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:19.925763 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:18:19.936428 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF193C760>]}
[0m13:18:19.936428 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.08s]
[0m13:18:19.937457 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:18:19.938439 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:18:19.938439 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:18:19.939444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:18:19.939444 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:18:19.942991 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.942991 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:18:19.947027 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.948021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.948021 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:18:19.949018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:19.984166 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:19.985195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.985195 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:18:19.991171 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:18:19.994200 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.994200 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:18:19.995194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.998177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.998177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:18:19.999286 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:19.999286 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:18:19.999286 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.999286 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:18:19.999286 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:19.999286 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:18:19.999286 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:19.999286 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:18:20.008624 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:20.008624 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:18:20.008624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF511BFA0>]}
[0m13:18:20.008624 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:18:20.008624 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:18:20.008624 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:18:20.014181 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:18:20.015196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:18:20.015196 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:18:20.018751 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.019784 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:18:20.023764 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.024765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.024765 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:18:20.025764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:20.059539 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:20.060541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.060541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:18:20.061633 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:18:20.061633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.061633 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:18:20.071771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:20.071771 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.071771 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:18:20.071771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:20.071771 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:18:20.071771 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.071771 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:18:20.071771 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:20.081788 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:18:20.081788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:20.081788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:18:20.081788 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:20.081788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:18:20.081788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF51335E0>]}
[0m13:18:20.081788 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:18:20.081788 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:18:20.081788 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:20.091242 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:18:20.092260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:18:20.092260 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:20.097464 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:20.098465 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:20.102464 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:20.104467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:20.104467 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:18:20.104467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:20.140013 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:20.141016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:20.141016 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    date_trunc('month', ) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:18:20.141790 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 25:     date_trunc('month', ) as month,
                                 ^

[0m13:18:20.141790 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:18:20.141790 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:18:20.146327 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ")"
  LINE 25:     date_trunc('month', ) as month,
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:18:20.147357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4F997C0>]}
[0m13:18:20.147357 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.06s]
[0m13:18:20.148354 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:20.149338 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:20.149338 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:18:20.150335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:18:20.150934 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:20.154019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:20.154019 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:20.158018 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:20.159021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:20.160009 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:18:20.160009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:20.195782 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:20.196801 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:20.196801 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:18:20.197774 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:18:20.198800 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:18:20.198800 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:18:20.199774 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:18:20.200775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF1906910>]}
[0m13:18:20.200775 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:18:20.201774 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:20.202774 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:20.202774 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:18:20.203804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:18:20.203804 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:20.207567 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:20.208567 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:20.211568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:20.213562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:20.213562 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:18:20.214572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:20.249621 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:20.249621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:20.249621 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:18:20.251701 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:18:20.251701 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:18:20.252676 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:18:20.253643 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:18:20.254631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba11f550-3d0a-4a08-85a0-529d86822ec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF513C4C0>]}
[0m13:18:20.255630 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:18:20.255630 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:20.256630 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:18:20.256630 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:18:20.257727 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:18:20.258621 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:18:20.258621 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:18:20.258621 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:18:20.259629 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:18:20.259629 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:18:20.260638 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:18:20.261628 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:20.262188 [debug] [MainThread]: On master: BEGIN
[0m13:18:20.262188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:20.398638 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:20.398638 [debug] [MainThread]: On master: COMMIT
[0m13:18:20.398638 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:20.398638 [debug] [MainThread]: On master: COMMIT
[0m13:18:20.398638 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:20.398638 [debug] [MainThread]: On master: Close
[0m13:18:20.398638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:20.398638 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:18:20.398638 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:18:20.398638 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:18:20.398638 [info ] [MainThread]: 
[0m13:18:20.398638 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m13:18:20.408672 [debug] [MainThread]: Command end result
[0m13:18:20.438909 [info ] [MainThread]: 
[0m13:18:20.438909 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:18:20.439932 [info ] [MainThread]: 
[0m13:18:20.440917 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ")"
  LINE 25:     date_trunc('month', ) as month,
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:18:20.441904 [info ] [MainThread]: 
[0m13:18:20.442909 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:18:20.443903 [info ] [MainThread]: 
[0m13:18:20.443903 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:18:20.445316 [info ] [MainThread]: 
[0m13:18:20.445316 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:18:20.447323 [debug] [MainThread]: Command `dbt run` failed at 13:18:20.447323 after 2.18 seconds
[0m13:18:20.447323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF19F2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF4BAD610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF501C460>]}
[0m13:18:20.448322 [debug] [MainThread]: Flushing usage events
[0m13:18:25.475568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81EA1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8493AE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8493AD60>]}


============================== 13:18:25.475568 | d53625ad-9536-4abf-87d5-5351e0e3d6ad ==============================
[0m13:18:25.475568 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:18:25.475568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:25.540116 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:18:25.540116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81D73160>]}
[0m13:18:25.540116 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:18:25.542595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81D73190>]}
[0m13:18:25.658274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81D67490>]}
[0m13:18:25.705667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D83E9B670>]}
[0m13:18:25.705667 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:18:25.720696 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:18:25.870136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:25.870136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:25.876137 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:18:25.906723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D84EBA130>]}
[0m13:18:26.015808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D84EE4880>]}
[0m13:18:26.016369 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:18:26.017546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D84EDA5B0>]}
[0m13:18:26.019727 [info ] [MainThread]: 
[0m13:18:26.020832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:26.027896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:18:26.106776 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:18:26.107318 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:18:26.107318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:26.144099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:18:26.144099 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:18:26.144099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:18:26.152135 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:18:26.152135 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:18:26.152135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:26.175255 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.175255 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:18:26.175255 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:26.175255 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:18:26.190981 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:18:26.190981 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:18:26.190981 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:26.190981 [debug] [MainThread]: On master: BEGIN
[0m13:18:26.190981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:26.223273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.223273 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:26.223273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:26.238958 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:18:26.238958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D84EC0970>]}
[0m13:18:26.238958 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:26.238958 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:26.238958 [debug] [MainThread]: On master: BEGIN
[0m13:18:26.238958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.238958 [debug] [MainThread]: On master: COMMIT
[0m13:18:26.238958 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:26.238958 [debug] [MainThread]: On master: COMMIT
[0m13:18:26.238958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.238958 [debug] [MainThread]: On master: Close
[0m13:18:26.238958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:26.238958 [info ] [MainThread]: 
[0m13:18:26.249815 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:18:26.250828 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:18:26.252346 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:18:26.252346 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:18:26.260028 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:18:26.262023 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:18:26.299597 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:18:26.300720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.301231 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:18:26.301231 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:18:26.330399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.331522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.331522 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:18:26.338527 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:18:26.344557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.344557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:18:26.345534 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.348528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.349528 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:18:26.349528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.359292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:18:26.359292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.359292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:18:26.359292 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.359292 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:18:26.377612 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:18:26.377612 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:18:26.381355 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.383362 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:18:26.384362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8534EAC0>]}
[0m13:18:26.385362 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.13s]
[0m13:18:26.385877 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:18:26.387269 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:18:26.387269 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:18:26.387269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:18:26.387269 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:18:26.387269 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:18:26.387269 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:18:26.396305 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:18:26.397312 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.398291 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:18:26.398291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.432452 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.433466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.433466 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:18:26.439477 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:18:26.442611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.442611 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:18:26.442611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.442611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.442611 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:18:26.442611 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.442611 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:18:26.449599 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.449599 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:18:26.450854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.452363 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:18:26.453368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:18:26.453368 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:18:26.456552 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.458575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:18:26.458575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8534E610>]}
[0m13:18:26.459558 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:18:26.460565 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:18:26.460565 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:18:26.461562 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:18:26.462552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:18:26.462552 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:18:26.466087 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.466087 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:18:26.471115 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.472099 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.472099 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:18:26.473133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.507888 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.508922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.508922 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:18:26.512946 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:18:26.512946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.512946 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:18:26.512946 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.552677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.552677 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:18:26.552677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.560808 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:18:26.560808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.560808 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:18:26.560808 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.560808 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:18:26.560808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:18:26.560808 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:18:26.570814 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.570814 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:18:26.570814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D854B1C70>]}
[0m13:18:26.570814 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.11s]
[0m13:18:26.570814 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:18:26.576330 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:18:26.576330 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:18:26.577287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:18:26.578292 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:18:26.581420 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:18:26.582440 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:18:26.586437 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:18:26.587468 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.588446 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:18:26.588446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.625665 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.625665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.626689 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:18:26.630739 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:18:26.630739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.630739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:18:26.630739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.630739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.630739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:18:26.630739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.630739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:18:26.630739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.630739 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:18:26.630739 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.647075 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:18:26.647075 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:18:26.647075 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:18:26.652594 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.652594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:18:26.652594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D854B4340>]}
[0m13:18:26.652594 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.08s]
[0m13:18:26.652594 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:18:26.652594 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:18:26.657706 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:18:26.658713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:18:26.659721 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:18:26.663739 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:18:26.663739 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:18:26.668752 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:18:26.669717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.669717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:18:26.670747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.717237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.717237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.718749 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:18:26.726567 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:18:26.731559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.731559 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:18:26.732559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.735557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.736559 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:18:26.737559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.740575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:18:26.741351 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.741351 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:18:26.741351 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.741351 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:18:26.741351 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:18:26.741351 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:18:26.751415 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.752933 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:18:26.754013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D8529A370>]}
[0m13:18:26.754939 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.10s]
[0m13:18:26.755940 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:18:26.756940 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:18:26.756940 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:18:26.757965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:18:26.757965 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:18:26.760951 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.762078 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:18:26.767305 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.769088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.769088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:18:26.770082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.804681 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.804681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.804681 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:18:26.804681 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:18:26.820411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.820411 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:18:26.820411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.820411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.820411 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:18:26.820411 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:26.820411 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:18:26.820411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.820411 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:18:26.820411 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:26.830440 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:18:26.830440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:18:26.830440 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:18:26.830440 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:26.836468 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:18:26.836468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D85481850>]}
[0m13:18:26.836468 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.08s]
[0m13:18:26.836468 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:18:26.840287 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:18:26.840287 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:18:26.841311 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:18:26.841311 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:18:26.844316 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:18:26.845429 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:18:26.849437 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:18:26.851624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:26.852134 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:18:26.852134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:26.995921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:26.997005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:26.997005 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:18:27.004930 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:18:27.007953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:27.008943 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:18:27.009932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:27.011946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:27.012944 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:18:27.013928 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:27.014920 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:18:27.015944 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:27.015944 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:18:27.016925 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:18:27.019943 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:18:27.020027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:18:27.020027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:18:27.020027 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:18:27.020027 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:18:27.020027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D85481850>]}
[0m13:18:27.020027 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.18s]
[0m13:18:27.020027 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:18:27.020027 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:27.028028 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:18:27.029052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:18:27.030041 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:27.035579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:27.036576 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:27.041621 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:27.042623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:27.042623 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:18:27.043615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:27.077213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:27.077213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:18:27.077213 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    date_trunc('month', ) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:18:27.077213 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 25:     date_trunc('month', ) as month,
                                 ^

[0m13:18:27.077213 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:18:27.077213 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:18:27.077213 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ")"
  LINE 25:     date_trunc('month', ) as month,
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:18:27.077213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D854668B0>]}
[0m13:18:27.077213 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.05s]
[0m13:18:27.077213 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:18:27.077213 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:27.087113 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:18:27.088120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:18:27.088120 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:27.092128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:27.093131 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:27.098130 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:27.099119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:27.100120 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:18:27.100120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:27.142008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:27.142008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:18:27.143067 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:18:27.143997 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:18:27.143997 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:18:27.145082 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:18:27.147004 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:18:27.147004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D854817C0>]}
[0m13:18:27.147996 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.06s]
[0m13:18:27.149004 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:18:27.149004 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:27.150004 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:18:27.150990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:18:27.150990 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:27.154529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:27.155563 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:27.159546 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:27.161546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:27.161546 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:18:27.161546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:27.199646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:18:27.200650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:18:27.200650 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:18:27.202410 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:18:27.202410 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:18:27.203424 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:18:27.204417 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:18:27.204417 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53625ad-9536-4abf-87d5-5351e0e3d6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D84F7E0D0>]}
[0m13:18:27.205417 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:18:27.206429 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:18:27.206429 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:18:27.207684 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:18:27.208696 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:18:27.208696 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:18:27.209695 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:18:27.209695 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:18:27.210701 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:18:27.210701 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:18:27.211839 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:18:27.212685 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:27.213685 [debug] [MainThread]: On master: BEGIN
[0m13:18:27.213685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:27.253958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:27.253958 [debug] [MainThread]: On master: COMMIT
[0m13:18:27.253958 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:27.254994 [debug] [MainThread]: On master: COMMIT
[0m13:18:27.254994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:27.254994 [debug] [MainThread]: On master: Close
[0m13:18:27.256003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:27.256003 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:18:27.257000 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:18:27.257000 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:18:27.257000 [info ] [MainThread]: 
[0m13:18:27.258085 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m13:18:27.260004 [debug] [MainThread]: Command end result
[0m13:18:27.291286 [info ] [MainThread]: 
[0m13:18:27.292287 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:18:27.293285 [info ] [MainThread]: 
[0m13:18:27.295285 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  syntax error at or near ")"
  LINE 25:     date_trunc('month', ) as month,
                                   ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:18:27.295285 [info ] [MainThread]: 
[0m13:18:27.296295 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:18:27.297300 [info ] [MainThread]: 
[0m13:18:27.297300 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:18:27.298300 [info ] [MainThread]: 
[0m13:18:27.299300 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:18:27.300298 [debug] [MainThread]: Command `dbt run` failed at 13:18:27.300298 after 1.86 seconds
[0m13:18:27.301311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81EA1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81DB6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D81DB6B20>]}
[0m13:18:27.302293 [debug] [MainThread]: Flushing usage events
[0m13:20:07.366629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DD51C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF407ECE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF407ECD60>]}


============================== 13:20:07.366629 | 97905f04-1d6e-4a74-83a5-cf92902a00d4 ==============================
[0m13:20:07.366629 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:20:07.366629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:07.450996 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:20:07.451994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DC23160>]}
[0m13:20:07.452995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:20:07.453997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DC23190>]}
[0m13:20:07.581523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DC17490>]}
[0m13:20:07.634723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3FD45670>]}
[0m13:20:07.635723 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:20:07.643950 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:20:07.800549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:07.801122 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:20:07.968139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:20:07.985561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40F15EB0>]}
[0m13:20:08.083877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40EEEB50>]}
[0m13:20:08.084886 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:20:08.085876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40F15FD0>]}
[0m13:20:08.086877 [info ] [MainThread]: 
[0m13:20:08.087878 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:20:08.092877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:20:08.151945 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:20:08.151945 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:20:08.152936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:08.191338 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:20:08.192591 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:20:08.195603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:20:08.200657 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:20:08.201655 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:20:08.201655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:08.340353 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.340353 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:20:08.341378 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:20:08.345352 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:20:08.347381 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:20:08.347381 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:20:08.354387 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:08.355374 [debug] [MainThread]: On master: BEGIN
[0m13:20:08.355374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:08.388981 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.388981 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:08.388981 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:20:08.397989 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:20:08.398989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40ECA130>]}
[0m13:20:08.398989 [debug] [MainThread]: On master: ROLLBACK
[0m13:20:08.399992 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:08.399992 [debug] [MainThread]: On master: BEGIN
[0m13:20:08.401002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.401002 [debug] [MainThread]: On master: COMMIT
[0m13:20:08.401002 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:08.402007 [debug] [MainThread]: On master: COMMIT
[0m13:20:08.402007 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:20:08.402007 [debug] [MainThread]: On master: Close
[0m13:20:08.403006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:08.403994 [info ] [MainThread]: 
[0m13:20:08.406018 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:20:08.407000 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:20:08.407994 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:20:08.407994 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:20:08.415540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:20:08.416540 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:20:08.451737 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:20:08.452750 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.452750 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:20:08.453743 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:20:08.496123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.497153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.497153 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:20:08.505142 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:20:08.512139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.512139 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:20:08.513157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.550338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.550338 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:20:08.550338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.566198 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:20:08.566198 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.566198 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:20:08.566198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:08.576228 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:20:08.581743 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:20:08.581743 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:20:08.581743 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:08.581743 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:20:08.581743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41339E20>]}
[0m13:20:08.581743 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:20:08.581743 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:20:08.581743 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:20:08.581743 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:20:08.592434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:20:08.593458 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:20:08.596443 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:20:08.597443 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:20:08.603448 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:20:08.604449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.605456 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:20:08.605456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:08.642350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.643389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.643389 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:20:08.649355 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:20:08.651383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.651383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:20:08.651383 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.651383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.651383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:20:08.651383 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.651383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:20:08.651383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.651383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:20:08.651383 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:08.651383 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:20:08.651383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:20:08.651383 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:20:08.667694 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:08.669778 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:20:08.670450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40D71D00>]}
[0m13:20:08.671658 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.08s]
[0m13:20:08.673054 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:20:08.673983 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:20:08.674529 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:20:08.675668 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:20:08.676295 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:20:08.679034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.680138 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:20:08.687076 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.688605 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.688605 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:20:08.688605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:08.737525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.738577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.739532 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:20:08.748531 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:20:08.752527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.753524 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:20:08.755523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.760542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.761525 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:20:08.762533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.765641 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:20:08.765641 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.766623 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:20:08.768144 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:08.771172 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:20:08.771172 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:20:08.772172 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:20:08.775159 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:08.777152 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:20:08.778157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF4142ED30>]}
[0m13:20:08.779152 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.10s]
[0m13:20:08.780152 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:20:08.781151 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:20:08.782152 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:20:08.783497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:20:08.784506 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:20:08.788519 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:20:08.791000 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:20:08.799012 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:20:08.800028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.801020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:20:08.801020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:08.838335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:08.838335 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.838335 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:20:08.838335 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:20:08.850163 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.850163 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:20:08.852242 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.854468 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.855473 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:20:08.855473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:08.857470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:20:08.857470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.858468 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:20:08.859461 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:08.859461 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:20:08.859461 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:20:08.859461 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:20:08.859461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:08.859461 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:20:08.859461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF41392910>]}
[0m13:20:08.869476 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.08s]
[0m13:20:08.869476 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:20:08.869476 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:20:08.871337 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:20:08.872355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:20:08.873347 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:20:08.877069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:20:08.879057 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:20:08.887064 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:20:08.888057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:08.889067 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:20:08.889067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.047775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.047775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:09.047775 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:20:09.047775 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:20:09.047775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:09.047775 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:20:09.047775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.062437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:09.062437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:20:09.062437 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.062437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:20:09.062437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:09.062437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:20:09.062437 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:09.062437 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:20:09.062437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:20:09.062437 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:20:09.074648 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:09.075179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:20:09.075179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DCC5FD0>]}
[0m13:20:09.075179 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.20s]
[0m13:20:09.078185 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:20:09.078185 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:20:09.079402 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:20:09.080409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:20:09.081409 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:20:09.085408 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.086407 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:20:09.092408 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.093407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.094430 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:20:09.094430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.224950 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.240605 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.240605 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:20:09.248301 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:20:09.251316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.251316 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:20:09.252298 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.255444 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.255972 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:20:09.255972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.257999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:20:09.259000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.259000 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:20:09.259985 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:09.262103 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:20:09.262103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:20:09.262103 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:20:09.265619 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:09.265619 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:20:09.265619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40DAAAC0>]}
[0m13:20:09.265619 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.19s]
[0m13:20:09.265619 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:20:09.265619 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:20:09.270964 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:20:09.271979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:20:09.271979 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:20:09.274977 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.275977 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:20:09.280989 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.281970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.282971 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:20:09.282971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.427389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.427389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.427389 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:20:09.427389 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:20:09.427389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.427389 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:20:09.443042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.443042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.443042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:20:09.443042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:20:09.443042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:20:09.443042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.443042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:20:09.443042 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:20:09.443042 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:20:09.443042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:20:09.443042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:20:09.443042 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:20:09.443042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:20:09.443042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40DAAAC0>]}
[0m13:20:09.443042 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.17s]
[0m13:20:09.459354 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:20:09.459354 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:20:09.460503 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:20:09.461508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:20:09.461508 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:20:09.465507 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:20:09.465507 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:20:09.471017 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:20:09.472017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:20:09.473018 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:20:09.473018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.617550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.617550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:20:09.617550 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_FORMAT(order_date, '%Y-%m-01') as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:20:09.622571 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_format(text, unknown) does not exist
LINE 25:     DATE_FORMAT(order_date, '%Y-%m-01') as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:20:09.622571 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:20:09.622571 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:20:09.622571 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_format(text, unknown) does not exist
  LINE 25:     DATE_FORMAT(order_date, '%Y-%m-01') as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:20:09.622571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40DAAAC0>]}
[0m13:20:09.622571 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.16s]
[0m13:20:09.622571 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:20:09.622571 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:20:09.622571 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:20:09.631118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:20:09.631118 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:20:09.635129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:20:09.636123 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:20:09.641492 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:20:09.643137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:20:09.643137 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:20:09.643137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.680499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.680499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:20:09.680499 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:20:09.680499 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:20:09.680499 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:20:09.680499 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:20:09.680499 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:20:09.680499 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40F38CA0>]}
[0m13:20:09.680499 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:20:09.680499 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:20:09.680499 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:20:09.689916 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:20:09.690916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:20:09.690916 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:20:09.694917 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:20:09.695916 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:20:09.702258 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:20:09.702258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:20:09.703628 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:20:09.703628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:20:09.745086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.745086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:20:09.746090 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:20:09.747084 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:20:09.747084 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:20:09.748084 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:20:09.749267 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:20:09.749267 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97905f04-1d6e-4a74-83a5-cf92902a00d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DC6B670>]}
[0m13:20:09.749267 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.06s]
[0m13:20:09.749267 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:20:09.752586 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:20:09.752586 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:20:09.753625 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:20:09.753625 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:20:09.754602 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:20:09.755602 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:20:09.755602 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:20:09.756597 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:20:09.756597 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:20:09.758607 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:09.758607 [debug] [MainThread]: On master: BEGIN
[0m13:20:09.758607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:09.796167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:20:09.797170 [debug] [MainThread]: On master: COMMIT
[0m13:20:09.797170 [debug] [MainThread]: Using postgres connection "master"
[0m13:20:09.797170 [debug] [MainThread]: On master: COMMIT
[0m13:20:09.798145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:20:09.798145 [debug] [MainThread]: On master: Close
[0m13:20:09.798145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:09.799171 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:20:09.799171 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:20:09.799171 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:20:09.800168 [info ] [MainThread]: 
[0m13:20:09.801150 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m13:20:09.803164 [debug] [MainThread]: Command end result
[0m13:20:09.834113 [info ] [MainThread]: 
[0m13:20:09.835120 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:20:09.836122 [info ] [MainThread]: 
[0m13:20:09.836122 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function date_format(text, unknown) does not exist
  LINE 25:     DATE_FORMAT(order_date, '%Y-%m-01') as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:20:09.837122 [info ] [MainThread]: 
[0m13:20:09.838120 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:20:09.839115 [info ] [MainThread]: 
[0m13:20:09.841121 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:20:09.842122 [info ] [MainThread]: 
[0m13:20:09.843136 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:20:09.848120 [debug] [MainThread]: Command `dbt run` failed at 13:20:09.847127 after 2.52 seconds
[0m13:20:09.848120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3DD51C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3FD01490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF40ECA6A0>]}
[0m13:20:09.849140 [debug] [MainThread]: Flushing usage events
[0m13:21:00.308044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D69BECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9413CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D94133A0>]}


============================== 13:21:00.313125 | 8c08a540-5f97-418f-a58f-effd99e72a51 ==============================
[0m13:21:00.313125 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:21:00.314045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:21:00.387507 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:21:00.389506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D68911C0>]}
[0m13:21:00.390513 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:21:00.391506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D68911F0>]}
[0m13:21:00.505311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D733A850>]}
[0m13:21:00.545197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D92EB070>]}
[0m13:21:00.545197 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:21:00.561608 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:21:00.702909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:00.703926 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:21:00.927794 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:21:00.943799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9B39F10>]}
[0m13:21:01.056096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9B6CAC0>]}
[0m13:21:01.057098 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:21:01.058097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9B39790>]}
[0m13:21:01.059109 [info ] [MainThread]: 
[0m13:21:01.060097 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:01.067108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:21:01.137681 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:21:01.138679 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:21:01.139680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:01.185225 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:21:01.188307 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:21:01.190313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:21:01.197312 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:21:01.197312 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:21:01.197312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:01.234530 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.235525 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:21:01.236526 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:21:01.241533 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:21:01.244528 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:21:01.244528 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:21:01.252548 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:01.253542 [debug] [MainThread]: On master: BEGIN
[0m13:21:01.253542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:01.288053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.289083 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:01.289083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:01.299070 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:21:01.301091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9B6CD00>]}
[0m13:21:01.301091 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:01.302063 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:01.302063 [debug] [MainThread]: On master: BEGIN
[0m13:21:01.303067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.303067 [debug] [MainThread]: On master: COMMIT
[0m13:21:01.303067 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:01.303067 [debug] [MainThread]: On master: COMMIT
[0m13:21:01.303067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.304582 [debug] [MainThread]: On master: Close
[0m13:21:01.305574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:01.306569 [info ] [MainThread]: 
[0m13:21:01.310567 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:21:01.311585 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:21:01.313576 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:21:01.313576 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:21:01.324136 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:21:01.326115 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:21:01.368118 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:21:01.369111 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.369111 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:21:01.369111 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:21:01.512320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.513315 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.513315 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:21:01.523320 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:21:01.531862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.532842 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:21:01.534833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.598708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.598708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:21:01.599712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.619401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:21:01.620401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.620401 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:21:01.622400 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.629399 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:21:01.633418 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:21:01.633418 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:21:01.638412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:01.640393 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:21:01.642400 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D9FACE80>]}
[0m13:21:01.643401 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.33s]
[0m13:21:01.644407 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:21:01.645402 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:21:01.645402 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:21:01.646392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:21:01.647402 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:21:01.649416 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:21:01.651394 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:21:01.656404 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:21:01.657402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.658402 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:21:01.659403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:01.699333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.700347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.701346 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:21:01.709852 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:21:01.713866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.714851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:21:01.715979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.718854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.718854 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:21:01.719854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.722850 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:21:01.722850 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.723851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:21:01.724854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.729397 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:21:01.729397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:21:01.730413 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:21:01.732627 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:01.734636 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:21:01.735635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249DA0F6640>]}
[0m13:21:01.736632 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.09s]
[0m13:21:01.737640 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:21:01.737640 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:21:01.737640 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:21:01.738633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:21:01.739643 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:21:01.742657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.743659 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:21:01.748640 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.749658 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.750639 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:21:01.750639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:01.783291 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.783291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.783291 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:21:01.783291 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:21:01.783291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.783291 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:21:01.793300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.793300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.793300 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:21:01.793300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.793300 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:21:01.793300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.793300 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:21:01.793300 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.793300 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:21:01.803347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:21:01.803347 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:21:01.803347 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:01.803347 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:21:01.803347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249DA09F760>]}
[0m13:21:01.803347 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:21:01.813983 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:21:01.814913 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:21:01.815921 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:21:01.816920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:21:01.817932 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:21:01.823438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:21:01.825908 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:21:01.834899 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:21:01.835906 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.836892 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:21:01.836892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:01.882229 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.882229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.883204 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:21:01.889257 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:21:01.893249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.893249 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:21:01.894250 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.897250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.897250 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:21:01.898249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.899249 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:21:01.900250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.900250 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:21:01.901251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.903754 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:21:01.904759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:21:01.904759 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:21:01.907852 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:01.909760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:21:01.909760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249DA005D30>]}
[0m13:21:01.910759 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.09s]
[0m13:21:01.911759 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:21:01.911759 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:21:01.912759 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:21:01.912759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:21:01.913759 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:21:01.916760 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:21:01.918265 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:21:01.922269 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:21:01.923270 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.924271 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:21:01.924271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:01.959733 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:01.960751 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.960751 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:21:01.963798 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:21:01.963798 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.963798 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:21:01.963798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.973842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.974120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:21:01.974120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:01.974120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:21:01.974120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.974120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:21:01.974120 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:01.974120 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:21:01.974120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:21:01.974120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:21:01.984147 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:01.984147 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:21:01.984147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D99DD130>]}
[0m13:21:01.984147 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:21:01.984147 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:21:01.984147 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:21:01.988580 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:21:01.989586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:21:01.989586 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:21:01.992587 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:21:01.993587 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:21:01.998592 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:21:01.999614 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.000593 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:21:02.000593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:02.146646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.146646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.156783 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:21:02.156783 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:21:02.156783 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.156783 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:21:02.166789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:02.166789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.166789 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:21:02.166789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:02.166789 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:21:02.166789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.166789 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:21:02.166789 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:02.166789 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:21:02.176796 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:21:02.176796 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:21:02.176796 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:02.176796 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:21:02.176796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D99D4790>]}
[0m13:21:02.176796 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.19s]
[0m13:21:02.176796 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:21:02.176796 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:21:02.185462 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:21:02.186482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:21:02.186482 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:21:02.189513 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.190513 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:21:02.196514 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.197513 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.197513 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:21:02.198517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:02.355011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.355011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.355011 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:21:02.355011 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:21:02.365135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.365135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:21:02.365135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:02.365135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.365135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:21:02.365135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:21:02.365135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:21:02.365135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.365135 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:21:02.365135 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:21:02.375177 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:21:02.375177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:21:02.375177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:21:02.375177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:21:02.375177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:21:02.375177 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D99D4640>]}
[0m13:21:02.375177 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.19s]
[0m13:21:02.375177 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:21:02.375177 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:21:02.385159 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:21:02.386184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:21:02.386184 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:21:02.389272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:21:02.390305 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:21:02.395278 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:21:02.396284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:21:02.397284 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:21:02.397284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:02.542328 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.542328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:21:02.542328 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    strftime('%Y-%m-01', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:21:02.552378 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function strftime(unknown, text) does not exist
LINE 25:     strftime('%Y-%m-01', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:21:02.552378 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:21:02.552378 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:21:02.552378 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function strftime(unknown, text) does not exist
  LINE 25:     strftime('%Y-%m-01', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:21:02.552378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D99D4790>]}
[0m13:21:02.552378 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.17s]
[0m13:21:02.552378 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:21:02.552378 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:21:02.552378 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:21:02.560705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:21:02.561712 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:21:02.564710 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:21:02.565710 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:21:02.571714 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:21:02.572710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:21:02.572710 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:21:02.573711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:02.610168 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.610168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:21:02.610168 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    date_trunc('month', order_date) as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:21:02.611440 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:21:02.612470 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:21:02.612470 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:21:02.614446 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:21:02.614446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249DA11CD00>]}
[0m13:21:02.615445 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:21:02.616444 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:21:02.616444 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:21:02.617446 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:21:02.617446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:21:02.618452 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:21:02.620867 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:21:02.621861 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:21:02.626839 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:21:02.626839 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:21:02.627838 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:21:02.627838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:02.662884 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.663903 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:21:02.663903 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    date_trunc('month', order_date) as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:21:02.664958 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function date_trunc(unknown, text) does not exist
LINE 35:     date_trunc('month', order_date) as month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:21:02.664958 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:21:02.666487 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:21:02.666487 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:21:02.666487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c08a540-5f97-418f-a58f-effd99e72a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249DA0F6640>]}
[0m13:21:02.666487 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:21:02.666487 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:21:02.666487 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:21:02.666487 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:21:02.672168 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:21:02.672168 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:21:02.672168 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:21:02.673164 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:21:02.674156 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:21:02.674156 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:21:02.674936 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:21:02.675949 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:02.675949 [debug] [MainThread]: On master: BEGIN
[0m13:21:02.675949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:02.714546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:21:02.714546 [debug] [MainThread]: On master: COMMIT
[0m13:21:02.715558 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:02.715558 [debug] [MainThread]: On master: COMMIT
[0m13:21:02.716550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:21:02.716550 [debug] [MainThread]: On master: Close
[0m13:21:02.716550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:02.717584 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:21:02.717716 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:21:02.717716 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:21:02.718556 [info ] [MainThread]: 
[0m13:21:02.720553 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m13:21:02.722552 [debug] [MainThread]: Command end result
[0m13:21:02.757800 [info ] [MainThread]: 
[0m13:21:02.758807 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:21:02.759828 [info ] [MainThread]: 
[0m13:21:02.760814 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function strftime(unknown, text) does not exist
  LINE 25:     strftime('%Y-%m-01', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:21:02.761799 [info ] [MainThread]: 
[0m13:21:02.761799 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:21:02.762829 [info ] [MainThread]: 
[0m13:21:02.763808 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function date_trunc(unknown, text) does not exist
  LINE 35:     date_trunc('month', order_date) as month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:21:02.765799 [info ] [MainThread]: 
[0m13:21:02.766810 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:21:02.767806 [debug] [MainThread]: Command `dbt run` failed at 13:21:02.767806 after 2.51 seconds
[0m13:21:02.768800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D69BECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D92EB070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D6EE1A30>]}
[0m13:21:02.768800 [debug] [MainThread]: Flushing usage events
[0m13:28:14.915045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3701C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F619BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F619BD60>]}


============================== 13:28:14.919175 | 1470c2c4-4781-4d62-bef0-f42fe870299d ==============================
[0m13:28:14.919175 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:28:14.920150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:14.982830 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:28:14.983830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F35D3160>]}
[0m13:28:14.983830 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:28:14.984831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F35D3190>]}
[0m13:28:15.088246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F35C7490>]}
[0m13:28:15.136778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F56FB670>]}
[0m13:28:15.138774 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:28:15.146769 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:28:15.287336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:28:15.287336 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:28:15.287336 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:28:15.287336 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:28:15.488569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:28:15.502714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F68AEA00>]}
[0m13:28:15.595896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3C0ABB0>]}
[0m13:28:15.595896 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:28:15.596924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3C0AF40>]}
[0m13:28:15.598926 [info ] [MainThread]: 
[0m13:28:15.599538 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:15.604553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:28:15.657657 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:28:15.667700 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:28:15.667700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:15.704302 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:28:15.704302 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:28:15.704302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:28:15.704302 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:28:15.704302 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:28:15.704302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:15.736028 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:28:15.736028 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:28:15.736028 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:28:15.751793 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m13:28:15.752324 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:28:15.752324 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:28:15.752324 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:15.752324 [debug] [MainThread]: On master: BEGIN
[0m13:28:15.752324 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:15.783477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:28:15.783477 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:15.783477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:15.799142 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:28:15.799142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6821280>]}
[0m13:28:15.799142 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:15.799142 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:15.799142 [debug] [MainThread]: On master: BEGIN
[0m13:28:15.799142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:28:15.799142 [debug] [MainThread]: On master: COMMIT
[0m13:28:15.799142 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:15.799142 [debug] [MainThread]: On master: COMMIT
[0m13:28:15.799142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:28:15.799142 [debug] [MainThread]: On master: Close
[0m13:28:15.799142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:28:15.799142 [info ] [MainThread]: 
[0m13:28:15.808295 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:28:15.809293 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:28:15.810288 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:28:15.810288 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:28:15.819065 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:28:15.820087 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:28:15.855828 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:28:15.856807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.856807 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:28:15.857805 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:28:15.900368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:15.901385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.901385 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:28:15.907666 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:28:15.938577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.938577 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:28:15.938577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:15.954973 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.954973 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:28:15.954973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:15.970118 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:28:15.970118 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.970118 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:28:15.970118 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:15.980134 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:28:15.980134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:28:15.980134 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:28:15.985702 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:15.985702 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:28:15.985702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6CE4E80>]}
[0m13:28:15.985702 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:28:15.985702 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:28:15.985702 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:28:15.997808 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:28:15.998829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:28:15.998829 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:28:16.001827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:28:16.002826 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:28:16.007825 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:28:16.009826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.009826 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:28:16.009826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.044785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.045802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.045802 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:28:16.053814 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:28:16.056819 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.057819 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:28:16.057819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.062080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.062080 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:28:16.062080 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.062080 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:28:16.062080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.062080 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:28:16.062080 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.062080 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:28:16.062080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:28:16.062080 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:28:16.072090 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.072090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:28:16.072090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6DCD3A0>]}
[0m13:28:16.072090 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:28:16.072090 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:28:16.072090 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:28:16.072090 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:28:16.076803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:28:16.077822 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:28:16.080898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.081937 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:28:16.084937 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.085937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.086938 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:28:16.086938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.121998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.122999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.124016 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:28:16.128516 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:28:16.129556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.129556 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:28:16.129556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.129556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.129556 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:28:16.129556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.129556 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:28:16.129556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.129556 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:28:16.129556 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.129556 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:28:16.129556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:28:16.129556 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:28:16.145898 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.145898 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:28:16.145898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6DCEBE0>]}
[0m13:28:16.145898 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:28:16.145898 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:28:16.145898 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:28:16.151780 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:28:16.152787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:28:16.153795 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:28:16.157791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:28:16.158788 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:28:16.163448 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:28:16.164455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.164455 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:28:16.165466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.297007 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.298024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.298024 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:28:16.303216 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:28:16.303216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.303216 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:28:16.303216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.311343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.311343 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:28:16.312383 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.313371 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:28:16.314408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.314408 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:28:16.315382 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.318375 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:28:16.319375 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:28:16.319375 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:28:16.322379 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.324105 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:28:16.324105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F68649A0>]}
[0m13:28:16.324105 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.17s]
[0m13:28:16.324105 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:28:16.324105 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:28:16.324105 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:28:16.324105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:28:16.324105 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:28:16.331053 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:28:16.331053 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:28:16.335099 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:28:16.336098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.336098 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:28:16.337065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.370735 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.371760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.371760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:28:16.378258 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:28:16.381254 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.382252 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:28:16.383202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.387208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.387284 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:28:16.387284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.387284 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:28:16.387284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.387284 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:28:16.387284 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.387284 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:28:16.387284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:28:16.387284 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:28:16.387284 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.387284 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:28:16.387284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6E1B5B0>]}
[0m13:28:16.387284 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.06s]
[0m13:28:16.387284 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:28:16.387284 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:28:16.401927 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:28:16.402934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:28:16.402934 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:28:16.405966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.406957 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:28:16.410958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.411933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.412936 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:28:16.412936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.457473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.458472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.459471 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:28:16.468479 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:28:16.473814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.474897 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:28:16.475978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.480894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.481427 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:28:16.483024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.485738 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:28:16.486250 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.486796 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:28:16.488414 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.491628 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:28:16.492701 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:28:16.493231 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:28:16.497040 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.499134 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:28:16.499655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F56FA7C0>]}
[0m13:28:16.500174 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.10s]
[0m13:28:16.501237 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:28:16.501758 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:28:16.502059 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:28:16.503153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:28:16.503676 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:28:16.510163 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.511265 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:28:16.517735 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.519866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.520872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:28:16.521550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.571455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.572518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.573044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:28:16.581169 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:28:16.585666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.585666 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:28:16.587289 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.589889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.589889 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:28:16.592698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.594884 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:28:16.595405 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.595405 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:28:16.597582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.600537 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:28:16.601593 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:28:16.602116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:28:16.606297 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.607867 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:28:16.608387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F56FA7C0>]}
[0m13:28:16.608911 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.11s]
[0m13:28:16.609963 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:28:16.610484 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:28:16.610867 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:28:16.611930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:28:16.612465 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:28:16.615799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.617471 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:28:16.624429 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.625989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.626514 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:28:16.626514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.664728 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.665729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.666744 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:28:16.680266 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:28:16.684255 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.685254 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:28:16.686243 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.688249 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:28:16.688249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.688249 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:28:16.690251 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.693262 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:28:16.693796 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:28:16.694338 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:28:16.694861 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.697011 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:28:16.698106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F56FA7C0>]}
[0m13:28:16.699178 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.09s]
[0m13:28:16.700777 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:28:16.701306 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:28:16.701850 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:28:16.702395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:28:16.703400 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:28:16.708531 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.709413 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:28:16.715411 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.717410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.717410 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:28:16.717410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.760027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.761030 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.761030 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:28:16.778617 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:28:16.782119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.782119 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:28:16.783122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.785130 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:28:16.785130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.785130 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:28:16.786130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.789238 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:28:16.789238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:28:16.789238 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:28:16.789238 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.789238 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:28:16.789238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6E50AC0>]}
[0m13:28:16.789238 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.09s]
[0m13:28:16.789238 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:28:16.789238 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:28:16.789238 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:28:16.789238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:28:16.796246 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:28:16.799264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.800265 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:28:16.805914 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.807657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.808713 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:28:16.809257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.852072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.853087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.853087 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:28:16.875140 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:28:16.875140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.875140 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:28:16.875140 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:16.875140 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:28:16.875140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.875140 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:28:16.875140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:28:16.890771 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:28:16.890771 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:28:16.890771 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:28:16.890771 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:16.890771 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:28:16.890771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6E53A60>]}
[0m13:28:16.890771 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.10s]
[0m13:28:16.890771 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:28:16.890771 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:28:16.899172 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:28:16.900180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:28:16.901178 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:28:16.905201 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:28:16.906309 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:28:16.911182 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:28:16.912187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:28:16.913185 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:28:16.913185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:16.949619 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:16.949619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:28:16.949619 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1;
  );
  
[0m13:28:16.949619 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: where rank = 1;
                       ^

[0m13:28:16.949619 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m13:28:16.949619 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:28:16.949619 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ";"
  LINE 29: where rank = 1;
                         ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:28:16.949619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6E8E7C0>]}
[0m13:28:16.949619 [error] [Thread-1  ]: 11 of 13 ERROR creating sql table model public.datamart_monthly_best_employee .. [[31mERROR[0m in 0.05s]
[0m13:28:16.949619 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:28:16.949619 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:28:16.960340 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:28:16.961994 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:28:16.962986 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:28:16.966986 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:28:16.967986 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:28:16.973533 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:28:16.974505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:28:16.974505 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:28:16.975631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:17.013236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:17.013236 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:28:17.013236 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1;
  );
  
[0m13:28:17.013236 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29: where rank = 1;
                       ^

[0m13:28:17.013236 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: ROLLBACK
[0m13:28:17.016751 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:28:17.016751 [debug] [Thread-1  ]: Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ";"
  LINE 29: where rank = 1;
                         ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m13:28:17.016751 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6EEB3D0>]}
[0m13:28:17.016751 [error] [Thread-1  ]: 12 of 13 ERROR creating sql table model public.datamart_monthly_category_sold .. [[31mERROR[0m in 0.05s]
[0m13:28:17.016751 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:28:17.016751 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:28:17.020934 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:28:17.021942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:28:17.021942 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:28:17.026954 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:28:17.027953 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:28:17.032481 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:28:17.034486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:28:17.034486 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:28:17.034486 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:17.070477 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:17.071479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:28:17.071479 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id;
  );
  
[0m13:28:17.072329 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: on imsr.supplier_id = s.supplier_id;
                                            ^

[0m13:28:17.072329 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m13:28:17.073347 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:28:17.074452 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  syntax error at or near ";"
  LINE 19: on imsr.supplier_id = s.supplier_id;
                                              ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:28:17.074452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1470c2c4-4781-4d62-bef0-f42fe870299d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F6E292E0>]}
[0m13:28:17.074452 [error] [Thread-1  ]: 13 of 13 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m13:28:17.074452 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:28:17.077304 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:17.078331 [debug] [MainThread]: On master: BEGIN
[0m13:28:17.078331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:17.111736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:28:17.112765 [debug] [MainThread]: On master: COMMIT
[0m13:28:17.112765 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:17.112765 [debug] [MainThread]: On master: COMMIT
[0m13:28:17.113764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:28:17.113764 [debug] [MainThread]: On master: Close
[0m13:28:17.113764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:17.114768 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:28:17.114768 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:28:17.114768 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:28:17.115866 [info ] [MainThread]: 
[0m13:28:17.115866 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m13:28:17.118792 [debug] [MainThread]: Command end result
[0m13:28:17.148761 [info ] [MainThread]: 
[0m13:28:17.150761 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:28:17.151768 [info ] [MainThread]: 
[0m13:28:17.151768 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  syntax error at or near ";"
  LINE 29: where rank = 1;
                         ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:28:17.152767 [info ] [MainThread]: 
[0m13:28:17.153772 [error] [MainThread]:   Database Error in model datamart_monthly_category_sold (models\marts\datamart_monthly_category_sold.sql)
  syntax error at or near ";"
  LINE 29: where rank = 1;
                         ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_category_sold.sql
[0m13:28:17.154767 [info ] [MainThread]: 
[0m13:28:17.155756 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  syntax error at or near ";"
  LINE 19: on imsr.supplier_id = s.supplier_id;
                                              ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:28:17.156755 [info ] [MainThread]: 
[0m13:28:17.156755 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=0 TOTAL=13
[0m13:28:17.158764 [debug] [MainThread]: Command `dbt run` failed at 13:28:17.158764 after 2.29 seconds
[0m13:28:17.158764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F3701C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F68C7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205F341EF40>]}
[0m13:28:17.159767 [debug] [MainThread]: Flushing usage events
[0m13:29:34.084813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F8A1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5233BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5233BD60>]}


============================== 13:29:34.084813 | 29dff9a4-1946-4467-bcc0-9606678d2158 ==============================
[0m13:29:34.084813 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:29:34.084813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:29:34.147436 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:29:34.152940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F763160>]}
[0m13:29:34.152940 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:29:34.154008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F763190>]}
[0m13:29:34.278276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F757490>]}
[0m13:29:34.328892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5189B670>]}
[0m13:29:34.329912 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:29:34.341930 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:29:34.511949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:29:34.511949 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:29:34.511949 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:29:34.511949 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m13:29:34.722482 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:29:34.736512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52A4FA00>]}
[0m13:29:34.833965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52A2A100>]}
[0m13:29:34.834965 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:29:34.834965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52A3E520>]}
[0m13:29:34.836975 [info ] [MainThread]: 
[0m13:29:34.837975 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:29:34.843221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:29:34.904607 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:29:34.905608 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:29:34.905608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:34.939797 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:29:34.941801 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:29:34.943795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:29:34.950341 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:29:34.950341 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:29:34.951341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:34.981510 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:29:34.982534 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:29:34.982534 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:29:34.987517 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:29:34.989517 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:29:34.990516 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:29:34.997659 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:34.997659 [debug] [MainThread]: On master: BEGIN
[0m13:29:34.998653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:29:35.033877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.033877 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:35.034877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:29:35.042878 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:29:35.044873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52A2ADF0>]}
[0m13:29:35.044873 [debug] [MainThread]: On master: ROLLBACK
[0m13:29:35.045877 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:35.045877 [debug] [MainThread]: On master: BEGIN
[0m13:29:35.046879 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.046879 [debug] [MainThread]: On master: COMMIT
[0m13:29:35.046879 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:35.046879 [debug] [MainThread]: On master: COMMIT
[0m13:29:35.046879 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.048389 [debug] [MainThread]: On master: Close
[0m13:29:35.048389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:35.049401 [info ] [MainThread]: 
[0m13:29:35.052402 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:29:35.052402 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:29:35.053419 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:29:35.053419 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:29:35.061405 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:29:35.062405 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:29:35.100619 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:29:35.101619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.102617 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:29:35.102617 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:29:35.136460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.136460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.136460 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:29:35.136460 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:29:35.188420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.188420 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:29:35.188420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.188420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.188420 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:29:35.188420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.204130 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:29:35.204130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.204130 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:29:35.204130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.204130 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:29:35.204130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:29:35.204130 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:29:35.220614 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.220614 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:29:35.220614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4FC686D0>]}
[0m13:29:35.220614 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:29:35.220614 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:29:35.220614 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:29:35.220614 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:29:35.230571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:29:35.230571 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:29:35.233674 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:29:35.234685 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:29:35.239687 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:29:35.241675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.241675 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:29:35.242687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.281753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.281753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.281753 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:29:35.289755 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:29:35.290851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.290851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:29:35.290851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.290851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.290851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:29:35.290851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.290851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:29:35.290851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.290851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:29:35.290851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.290851 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:29:35.290851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:29:35.290851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:29:35.306675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.306675 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:29:35.306675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52E47640>]}
[0m13:29:35.306675 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.08s]
[0m13:29:35.306675 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:29:35.313514 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:29:35.314530 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:29:35.315530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:29:35.315530 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:29:35.320060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.321056 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:29:35.327063 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.327063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.328061 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:29:35.328061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.362715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.363734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.363734 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:29:35.368715 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:29:35.371730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.371730 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:29:35.372790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.372790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.372790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:29:35.372790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.372790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:29:35.372790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.372790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:29:35.380295 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.380295 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:29:35.380295 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:29:35.380295 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:29:35.380295 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.380295 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:29:35.380295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52EAA670>]}
[0m13:29:35.388800 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:29:35.388800 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:29:35.388800 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:29:35.391313 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:29:35.392343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:29:35.393327 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:29:35.397321 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:29:35.398328 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:29:35.402323 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:29:35.403327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.404327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:29:35.404327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.438587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.439609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.439609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:29:35.442046 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:29:35.448090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.448090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:29:35.448090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.448090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.448090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:29:35.448090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.456443 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:29:35.456528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.457037 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:29:35.458436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.460724 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:29:35.461331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:29:35.461331 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:29:35.464579 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.465728 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:29:35.466272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD518997C0>]}
[0m13:29:35.466810 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:29:35.467318 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:29:35.467318 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:29:35.468814 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:29:35.469827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:29:35.470820 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:29:35.473820 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:29:35.473820 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:29:35.478821 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:29:35.479830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.480821 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:29:35.480821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.516819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.517844 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.517844 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:29:35.525127 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:29:35.529141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.529671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:29:35.529671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.532779 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.532779 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:29:35.532779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.532779 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:29:35.532779 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.532779 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:29:35.532779 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.532779 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:29:35.532779 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:29:35.532779 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:29:35.544595 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.546608 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:29:35.546608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52FB2130>]}
[0m13:29:35.548121 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.08s]
[0m13:29:35.549154 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:29:35.549154 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:29:35.550127 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:29:35.551126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:29:35.551126 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:29:35.554139 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.555138 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:29:35.559125 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.560228 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.560228 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:29:35.561133 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.593800 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.594802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.594802 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:29:35.600793 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:29:35.603768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.604797 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:29:35.604797 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.607796 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.607796 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:29:35.608772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.610790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:29:35.610790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.610790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:29:35.612381 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.614411 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:29:35.615415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:29:35.615598 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:29:35.615598 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.615598 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:29:35.615598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52FB77C0>]}
[0m13:29:35.615598 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:29:35.615598 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:29:35.615598 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:29:35.622745 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:29:35.623708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:29:35.624709 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:29:35.628724 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.628724 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:29:35.633251 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.634263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.635264 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:29:35.635264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.768353 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.768353 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.768353 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:29:35.773364 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:29:35.773364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.773364 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:29:35.773364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.773364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.783899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:29:35.783899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.783899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:29:35.783899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.783899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:29:35.783899 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.783899 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:29:35.783899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:29:35.783899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:29:35.783899 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.783899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:29:35.783899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52FBBD30>]}
[0m13:29:35.783899 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.16s]
[0m13:29:35.783899 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:29:35.783899 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:29:35.798644 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:29:35.799653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:29:35.800652 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:29:35.803652 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.804652 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:29:35.809663 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.810651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.810651 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:29:35.811675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:35.946946 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:35.946946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.946946 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:29:35.956070 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:29:35.956070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.956070 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:29:35.956070 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.966098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.966098 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:29:35.966098 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:35.966098 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:29:35.966098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.971117 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:29:35.971117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:35.971117 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:29:35.971117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:29:35.971117 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:29:35.971117 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:35.971117 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:29:35.971117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52F6C880>]}
[0m13:29:35.971117 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.17s]
[0m13:29:35.971117 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:29:35.971117 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:29:35.971117 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:29:35.984522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:29:35.985542 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:29:35.989540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:35.989540 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:29:35.993540 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:35.995559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:35.995559 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:29:35.996541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.031097 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.032108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:36.032108 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:29:36.039166 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:29:36.039166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:36.049185 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:29:36.049185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.049185 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:36.049185 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:29:36.049185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.049185 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:29:36.055360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:36.055885 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:29:36.055885 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.055885 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:29:36.055885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:29:36.055885 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:29:36.055885 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:36.065418 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:29:36.065418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5301D280>]}
[0m13:29:36.065418 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:29:36.065418 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:29:36.065418 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:29:36.069859 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:29:36.070894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:29:36.070894 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:29:36.075002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.076002 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:29:36.080992 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.082000 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.082000 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:29:36.083001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.120389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.120389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.121418 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:29:36.128660 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:29:36.138165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.138165 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:29:36.138165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.138165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.138165 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:29:36.138165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.138165 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:29:36.138165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.138165 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:29:36.138165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.149200 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:29:36.149200 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:29:36.149200 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:29:36.149200 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:36.154238 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:29:36.154238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD530189A0>]}
[0m13:29:36.154238 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:29:36.154238 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:29:36.154238 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:29:36.158451 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:29:36.158451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:29:36.159471 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:29:36.162469 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.163468 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:29:36.167470 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.168472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.168472 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:29:36.169681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.203465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.204482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.204482 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
  );
  
[0m13:29:36.206456 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:29:36.206456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.206456 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:29:36.206456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.206456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.206456 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:29:36.206456 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.206456 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:29:36.222161 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.222337 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:29:36.222337 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.222337 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:29:36.222337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:29:36.222337 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:29:36.222337 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:36.222337 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:29:36.222337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD53016190>]}
[0m13:29:36.232354 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.06s]
[0m13:29:36.232354 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:29:36.232354 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:29:36.235034 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:29:36.236040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:29:36.236040 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:29:36.239068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.240061 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:29:36.244050 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.245060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.246039 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:29:36.246039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.385616 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.385616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.385616 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:29:36.401269 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:29:36.401269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.401269 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:29:36.401269 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.401269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.401269 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:29:36.401269 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.415650 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:29:36.415650 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.416205 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:29:36.417369 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.417369 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:29:36.417369 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:29:36.417369 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:29:36.417369 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:36.417369 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:29:36.417369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5300F970>]}
[0m13:29:36.417369 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.18s]
[0m13:29:36.427374 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:29:36.427374 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:29:36.429065 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:29:36.430070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:29:36.430070 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:29:36.433071 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.434072 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:29:36.438075 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.440075 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.440075 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:29:36.440075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:29:36.578204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.578719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.578719 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:29:36.585140 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:29:36.589799 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.590311 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:29:36.591442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.594809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.594809 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:29:36.594809 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:29:36.594809 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:29:36.599931 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.599931 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:29:36.601584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.603733 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:29:36.604808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:29:36.605328 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:29:36.608707 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:29:36.610312 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:29:36.610911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29dff9a4-1946-4467-bcc0-9606678d2158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD53010070>]}
[0m13:29:36.611417 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.18s]
[0m13:29:36.612489 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:29:36.614102 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:36.614889 [debug] [MainThread]: On master: BEGIN
[0m13:29:36.615570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:29:36.652729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:29:36.653257 [debug] [MainThread]: On master: COMMIT
[0m13:29:36.653800 [debug] [MainThread]: Using postgres connection "master"
[0m13:29:36.653800 [debug] [MainThread]: On master: COMMIT
[0m13:29:36.654320 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:29:36.654856 [debug] [MainThread]: On master: Close
[0m13:29:36.655964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:36.655964 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:29:36.656506 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:29:36.656506 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:29:36.657043 [info ] [MainThread]: 
[0m13:29:36.657563 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m13:29:36.659704 [debug] [MainThread]: Command end result
[0m13:29:36.693802 [info ] [MainThread]: 
[0m13:29:36.695412 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:36.696475 [info ] [MainThread]: 
[0m13:29:36.697689 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:29:36.698784 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:36.698784 after 2.65 seconds
[0m13:29:36.699366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD4F8A1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5189BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD52F9F0D0>]}
[0m13:29:36.699883 [debug] [MainThread]: Flushing usage events
[0m13:33:05.804664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C50ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967EF62CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967EF623A0>]}


============================== 13:33:05.807668 | b53722f0-3566-46c7-9ac8-4e3198d717f8 ==============================
[0m13:33:05.807668 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:33:05.808649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:33:05.873216 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:33:05.874726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C3E31C0>]}
[0m13:33:05.875738 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:33:05.876731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C3E31F0>]}
[0m13:33:05.993519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967CE8A850>]}
[0m13:33:06.043078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967EE3C070>]}
[0m13:33:06.044066 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:33:06.053053 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:33:06.190422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:33:06.190422 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:33:06.366083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:33:06.383196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F6C7F10>]}
[0m13:33:06.470720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F6AF430>]}
[0m13:33:06.470720 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:33:06.476921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F6D8070>]}
[0m13:33:06.479099 [info ] [MainThread]: 
[0m13:33:06.480099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:06.485102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:33:06.533012 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:33:06.533012 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:33:06.533012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:06.574408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:33:06.579989 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:33:06.579989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:33:06.579989 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:33:06.579989 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:33:06.579989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:06.732809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:33:06.733346 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:33:06.733880 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:06.739805 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:33:06.741933 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:33:06.742464 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:33:06.752297 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:06.752897 [debug] [MainThread]: On master: BEGIN
[0m13:33:06.753463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:06.789840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:06.789840 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:06.790774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:06.801721 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:33:06.804170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C213B80>]}
[0m13:33:06.804693 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:06.805764 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:06.806318 [debug] [MainThread]: On master: BEGIN
[0m13:33:06.806855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:06.807392 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.807919 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:06.807919 [debug] [MainThread]: On master: COMMIT
[0m13:33:06.808458 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:06.808987 [debug] [MainThread]: On master: Close
[0m13:33:06.810067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:06.811142 [info ] [MainThread]: 
[0m13:33:06.815025 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:33:06.815581 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:33:06.816692 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:33:06.817239 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:33:06.824949 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:33:06.826054 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:33:06.868709 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:33:06.870236 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.870236 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:33:06.870236 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:33:06.901383 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:06.901383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.902413 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:33:06.909471 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:33:06.915492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.917022 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:33:06.917022 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:06.961806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.962771 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:33:06.963772 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:06.980327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:33:06.981332 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.981332 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:33:06.982338 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:06.988539 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:33:06.992535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:33:06.992535 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:33:06.996471 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:06.998463 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:33:07.000461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FAE5640>]}
[0m13:33:07.000461 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:33:07.002055 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:33:07.002595 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:33:07.003136 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:33:07.004353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:33:07.004353 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:33:07.007577 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:33:07.008143 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:33:07.012001 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:33:07.013041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.013570 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:33:07.013570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.049025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.050031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.050031 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:33:07.056329 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:33:07.059363 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.060335 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:33:07.060335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.063463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.064364 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:33:07.064364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.066357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:33:07.066357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.067357 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:33:07.068220 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.071248 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:33:07.072248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:33:07.072248 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:33:07.073834 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.073834 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:33:07.073834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FA6CCD0>]}
[0m13:33:07.073834 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:33:07.073834 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:33:07.073834 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:33:07.073834 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:33:07.080727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:33:07.080727 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:33:07.084740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.084740 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:33:07.088734 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.089734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.089734 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:33:07.090732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.125695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.126708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.126708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:33:07.132906 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:33:07.135919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.135919 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:33:07.136999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.136999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.136999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:33:07.136999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.136999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:33:07.136999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.136999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:33:07.136999 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.136999 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:33:07.136999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:33:07.136999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:33:07.136999 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.136999 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:33:07.152626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FADFDF0>]}
[0m13:33:07.152626 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:33:07.152626 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:33:07.155566 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:33:07.155566 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:33:07.157574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:33:07.157574 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:33:07.160595 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:33:07.161602 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:33:07.166596 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:33:07.167583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.168883 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:33:07.169582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.205859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.205859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.205859 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:33:07.212871 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:33:07.213937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.213937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:33:07.213937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.213937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.213937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:33:07.213937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.213937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:33:07.213937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.213937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:33:07.213937 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.213937 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:33:07.213937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:33:07.213937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:33:07.230076 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.230076 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:33:07.230076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FBDCD60>]}
[0m13:33:07.230076 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:33:07.230076 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:33:07.230076 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:33:07.235318 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:33:07.236333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:33:07.236333 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:33:07.239858 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:33:07.239858 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:33:07.243905 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:33:07.245870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.246872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:33:07.246872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.393872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.393872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.393872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:33:07.393872 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:33:07.393872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.393872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:33:07.393872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.393872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.393872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:33:07.409594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.409594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:33:07.409594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.409594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:33:07.409594 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.409594 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:33:07.409594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:33:07.409594 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:33:07.419679 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.419679 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:33:07.419679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F50F400>]}
[0m13:33:07.419679 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.18s]
[0m13:33:07.419679 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:33:07.419679 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:33:07.424725 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:33:07.425749 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:33:07.425749 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:33:07.428742 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.429744 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:33:07.434282 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.435276 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.436275 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:33:07.436275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.470833 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.470833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.471837 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:33:07.477902 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:33:07.477902 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.477902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:33:07.477902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.477902 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.477902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:33:07.477902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.477902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:33:07.477902 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.477902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:33:07.477902 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.477902 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:33:07.477902 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:33:07.477902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:33:07.494291 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.494291 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:33:07.494291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F513C40>]}
[0m13:33:07.494291 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:33:07.494291 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:33:07.500567 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:33:07.500567 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:33:07.501584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:33:07.502574 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:33:07.505573 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.506573 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:33:07.512572 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.513588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.514573 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:33:07.514573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.657984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.657984 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.668073 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:33:07.673585 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:33:07.673585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.673585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:33:07.673585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.673585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.673585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:33:07.673585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.673585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:33:07.673585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.673585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:33:07.673585 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.673585 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:33:07.673585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:33:07.673585 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:33:07.689216 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.689216 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:33:07.689216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FBDBB50>]}
[0m13:33:07.689216 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.19s]
[0m13:33:07.689216 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:33:07.689216 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:33:07.696271 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:33:07.697291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:33:07.697291 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:33:07.701279 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.702277 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:33:07.706286 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.707303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.708277 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:33:07.708277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.744716 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.745743 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.745743 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:33:07.758397 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:33:07.761366 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.761366 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:33:07.762382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.766396 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.766396 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:33:07.767366 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.768403 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:33:07.768403 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.768403 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:33:07.768403 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.768403 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:33:07.768403 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:33:07.768403 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:33:07.777767 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.779265 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:33:07.780270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967E509520>]}
[0m13:33:07.781270 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:33:07.782271 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:33:07.782271 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:33:07.783270 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:33:07.784271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:33:07.784461 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:33:07.788040 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.788040 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:33:07.792044 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.794026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.794026 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:33:07.795033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:07.834478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:07.834478 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.835474 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:33:07.845690 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:33:07.845690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.845690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:33:07.845690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.845690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.845690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:33:07.845690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:07.845690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:33:07.845690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.845690 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:33:07.845690 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:07.861621 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:33:07.861621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:33:07.861621 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:33:07.861621 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:07.861621 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:33:07.861621 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967E509520>]}
[0m13:33:07.861621 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:33:07.871627 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:33:07.871627 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:33:07.872796 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:33:07.873814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:33:07.874816 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:33:07.878886 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:07.879894 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:33:07.883832 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:07.884809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:07.885810 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:33:07.885810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:08.013211 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:08.013211 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:08.013211 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    TO_CHAR(order_date::date, 'Month') as month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:33:08.031972 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:33:08.031972 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:08.031972 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:33:08.031972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.044562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:08.044562 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:33:08.044562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.044562 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:33:08.044562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:08.044562 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:33:08.044562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:08.051442 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:33:08.052447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:33:08.052447 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:33:08.054795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:08.056803 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:33:08.056803 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F512430>]}
[0m13:33:08.057800 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.18s]
[0m13:33:08.058812 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:33:08.059926 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:33:08.059926 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:33:08.060800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:33:08.061811 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:33:08.064810 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.065812 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:33:08.068915 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.070441 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.071462 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:33:08.071462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:08.216988 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:08.217124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.217124 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month desc
  );
  
[0m13:33:08.217124 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:33:08.227157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.227157 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:33:08.227157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.232204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.232204 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:33:08.232204 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.232204 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:33:08.232204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.232204 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:33:08.232204 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:08.232204 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:33:08.232204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:33:08.232204 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:33:08.232204 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:08.232204 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:33:08.232204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C49C7F0>]}
[0m13:33:08.232204 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.17s]
[0m13:33:08.246981 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:33:08.246981 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:33:08.247995 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:33:08.248987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:33:08.248987 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:33:08.252014 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.253021 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:33:08.257014 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.258010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.258993 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:33:08.258993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:08.296174 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:08.296174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.297195 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:33:08.303403 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:33:08.307409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.307409 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:33:08.308402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.310535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.311492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:33:08.311492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.311492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:33:08.311492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.311492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:33:08.311492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:08.311492 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:33:08.311492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:33:08.311492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:33:08.321003 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:08.321003 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:33:08.321003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967FCCC3A0>]}
[0m13:33:08.321003 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:33:08.321003 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:33:08.321003 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:33:08.326870 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:33:08.327376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:33:08.328384 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:33:08.332143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.333192 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:33:08.338180 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.339237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.339776 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:33:08.339776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:08.377312 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:08.377312 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.378323 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:33:08.384317 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:33:08.386374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.386374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:33:08.386374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.386374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.386374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:33:08.386374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:08.386374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:33:08.386374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.386374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:33:08.386374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:33:08.386374 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:33:08.386374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:33:08.386374 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:33:08.386374 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:08.402023 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:33:08.402023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b53722f0-3566-46c7-9ac8-4e3198d717f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F51BE20>]}
[0m13:33:08.402023 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.07s]
[0m13:33:08.402023 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:33:08.407120 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:08.407120 [debug] [MainThread]: On master: BEGIN
[0m13:33:08.408165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:08.551296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:08.551296 [debug] [MainThread]: On master: COMMIT
[0m13:33:08.551296 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:08.551296 [debug] [MainThread]: On master: COMMIT
[0m13:33:08.551296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:08.551296 [debug] [MainThread]: On master: Close
[0m13:33:08.551296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:08.551296 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:33:08.551296 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:33:08.551296 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:33:08.551296 [info ] [MainThread]: 
[0m13:33:08.551296 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m13:33:08.559007 [debug] [MainThread]: Command end result
[0m13:33:08.590177 [info ] [MainThread]: 
[0m13:33:08.591260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:08.591260 [info ] [MainThread]: 
[0m13:33:08.592230 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:33:08.593259 [debug] [MainThread]: Command `dbt run` succeeded at 13:33:08.593259 after 2.83 seconds
[0m13:33:08.593259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967C50ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967EAE5E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001967F6190D0>]}
[0m13:33:08.594267 [debug] [MainThread]: Flushing usage events
[0m13:37:08.995326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4979ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C208A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4A11A790>]}


============================== 13:37:08.995326 | af34f68d-3dd3-46f4-b50f-53a1d7d56393 ==============================
[0m13:37:08.995326 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:37:08.995326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:09.053194 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:37:09.053194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F49670190>]}
[0m13:37:09.053194 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:37:09.065536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F496701C0>]}
[0m13:37:09.173710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C1F2D90>]}
[0m13:37:09.215700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F496858E0>]}
[0m13:37:09.215700 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:37:09.225202 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:37:09.373387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:37:09.373387 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:09.373387 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:09.373387 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:37:09.546957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:37:09.567626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C951EE0>]}
[0m13:37:09.649223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C929FA0>]}
[0m13:37:09.649223 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:37:09.649223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C93E8B0>]}
[0m13:37:09.660857 [info ] [MainThread]: 
[0m13:37:09.661873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:09.667713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:37:09.722500 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:37:09.722500 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:37:09.722500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:09.760898 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:37:09.760898 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:37:09.760898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:37:09.760898 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:37:09.760898 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:37:09.770927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:09.792494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:37:09.792494 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:37:09.792494 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:37:09.808274 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:37:09.808274 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:37:09.808274 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:37:09.808274 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.808274 [debug] [MainThread]: On master: BEGIN
[0m13:37:09.818305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:09.839613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:09.839613 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.839613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:09.861238 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:37:09.862238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C9021F0>]}
[0m13:37:09.862238 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:09.863248 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.863248 [debug] [MainThread]: On master: BEGIN
[0m13:37:09.863248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:09.864237 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.864237 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.864237 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.864237 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:37:09.864237 [debug] [MainThread]: On master: Close
[0m13:37:09.865748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:09.865748 [info ] [MainThread]: 
[0m13:37:09.869760 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:37:09.869760 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:37:09.870884 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:37:09.871398 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:37:09.878409 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:37:09.879410 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:37:09.915973 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:37:09.915973 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:09.916974 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:37:09.916974 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:37:09.948428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:09.948428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:09.948428 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:37:09.956850 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:37:10.002934 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:10.002934 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:37:10.003934 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.006932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:10.006932 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:37:10.007869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.025005 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:37:10.025005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:10.025005 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:37:10.027029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.032131 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:37:10.036131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:10.037131 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:37:10.039891 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.042890 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:37:10.043890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F49B68700>]}
[0m13:37:10.044889 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:37:10.045891 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:37:10.045891 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:37:10.046890 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:37:10.047890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:37:10.047890 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:37:10.050902 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:37:10.051901 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:37:10.055902 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:37:10.056904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.057902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:37:10.057902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.092236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.092236 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.093252 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:37:10.096322 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:37:10.096322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.096322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:37:10.096322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.096322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.096322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:37:10.096322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.096322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:37:10.096322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.096322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:37:10.096322 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.112105 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:37:10.112105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:10.112105 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:37:10.112105 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.112105 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:37:10.112105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CEB1040>]}
[0m13:37:10.112105 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m13:37:10.122122 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:37:10.122122 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:37:10.123485 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:37:10.124506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:37:10.125499 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:37:10.128572 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.129506 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:37:10.133496 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.135490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.135490 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:37:10.135490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.171131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.171131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.171131 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:37:10.171131 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:37:10.171131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.171131 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:37:10.181671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.181671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.181671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:37:10.181671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.187179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:37:10.187179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.187179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:37:10.187179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.187179 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:37:10.187179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:10.187179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:37:10.187179 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.187179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:37:10.187179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CEB1040>]}
[0m13:37:10.187179 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:37:10.187179 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:37:10.187179 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:37:10.202389 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:37:10.203398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:37:10.203398 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:37:10.209419 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:37:10.211401 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:37:10.218703 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:37:10.219402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.220400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:37:10.220400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.247598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.247598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.247598 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:37:10.263368 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:37:10.263368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.263368 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:37:10.263368 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.273646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.273646 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:37:10.273646 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.273646 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:37:10.273646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.273646 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:37:10.279163 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.281671 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:37:10.281671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:10.281671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:37:10.281671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.281671 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:37:10.281671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CEB1040>]}
[0m13:37:10.289890 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.08s]
[0m13:37:10.289890 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:37:10.292392 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:37:10.293408 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:37:10.294558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:37:10.295073 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:37:10.298080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:37:10.299087 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:37:10.304088 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:37:10.305081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.305081 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:37:10.306089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.337537 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.337537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.337537 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:37:10.349576 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:37:10.353576 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.353576 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:37:10.354577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.358583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.359602 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:37:10.360615 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.361576 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:37:10.362582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.362582 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:37:10.363582 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.365435 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:37:10.365435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:10.365435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:37:10.365435 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.365435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:37:10.365435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CE609D0>]}
[0m13:37:10.365435 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:37:10.365435 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:37:10.365435 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:37:10.376509 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:37:10.377544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:37:10.378525 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:37:10.381527 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.382640 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:37:10.387143 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.388156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.389150 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:37:10.389150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.424711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.424711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.425715 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:37:10.427780 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:37:10.427780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.427780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:37:10.427780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.427780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.427780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:37:10.427780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.427780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:37:10.427780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.427780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:37:10.443500 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.443500 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:37:10.443500 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:10.443500 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:37:10.450366 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.452393 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:37:10.452393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CE609D0>]}
[0m13:37:10.453397 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:37:10.454365 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:37:10.455360 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:37:10.455504 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:37:10.456505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:37:10.456505 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:37:10.461529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.462513 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:37:10.466511 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.466511 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.467513 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:37:10.467513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.501577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.501577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.502595 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:37:10.504811 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:37:10.504811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.504811 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:37:10.504811 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.504811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.504811 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:37:10.504811 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:10.504811 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:37:10.504811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.504811 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:37:10.504811 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.519535 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:37:10.519535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:10.519535 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:37:10.519535 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:10.519535 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:37:10.519535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4CE609D0>]}
[0m13:37:10.519535 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.06s]
[0m13:37:10.519535 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:37:10.519535 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:10.528648 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:37:10.529653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:37:10.529653 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:10.533658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:10.534657 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:10.538907 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:10.540125 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:10.540125 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:37:10.540125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.576478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.576478 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:10.577532 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    EXTRACT(month FROM date_column) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:37:10.578557 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date_column" does not exist
LINE 25:     EXTRACT(month FROM date_column) AS month,
                                ^

[0m13:37:10.578557 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:37:10.579541 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:37:10.582082 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  column "date_column" does not exist
  LINE 25:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:10.582082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C97E910>]}
[0m13:37:10.582082 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.05s]
[0m13:37:10.582082 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:10.582082 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:10.585473 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:37:10.586487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:37:10.586487 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:10.591478 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:10.592478 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:10.596478 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:10.597479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:10.597479 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:37:10.598478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.629613 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.629613 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:10.629613 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    EXTRACT(month FROM date_column) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:37:10.629613 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date_column" does not exist
LINE 35:     EXTRACT(month FROM date_column) AS month,
                                ^

[0m13:37:10.629613 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:37:10.629613 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:37:10.629613 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  column "date_column" does not exist
  LINE 35:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:37:10.629613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C1FC520>]}
[0m13:37:10.629613 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.04s]
[0m13:37:10.629613 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:10.629613 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:10.642579 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:37:10.643589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:37:10.643589 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:10.647596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:10.648605 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:10.652595 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:10.653596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:10.654597 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:37:10.654597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:10.690535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.691537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:10.691537 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    EXTRACT(month FROM date_column) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:37:10.694051 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "date_column" does not exist
LINE 35:     EXTRACT(month FROM date_column) AS month,
                                ^

[0m13:37:10.694578 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:37:10.695112 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:37:10.696749 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  column "date_column" does not exist
  LINE 35:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:10.697275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af34f68d-3dd3-46f4-b50f-53a1d7d56393', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C7E0220>]}
[0m13:37:10.697798 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.05s]
[0m13:37:10.698937 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:10.699481 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:37:10.699650 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:37:10.700745 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:37:10.700745 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:37:10.701283 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:37:10.701828 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:37:10.702368 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:37:10.702899 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:37:10.703438 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:37:10.704522 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:10.705049 [debug] [MainThread]: On master: BEGIN
[0m13:37:10.705049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:10.739957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:10.741043 [debug] [MainThread]: On master: COMMIT
[0m13:37:10.741043 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:10.741043 [debug] [MainThread]: On master: COMMIT
[0m13:37:10.741043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:37:10.741043 [debug] [MainThread]: On master: Close
[0m13:37:10.741043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:10.741043 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:37:10.741043 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:37:10.741043 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:37:10.741043 [info ] [MainThread]: 
[0m13:37:10.741043 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m13:37:10.750665 [debug] [MainThread]: Command end result
[0m13:37:10.782356 [info ] [MainThread]: 
[0m13:37:10.783608 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:37:10.784622 [info ] [MainThread]: 
[0m13:37:10.785236 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  column "date_column" does not exist
  LINE 25:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:10.785236 [info ] [MainThread]: 
[0m13:37:10.786242 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  column "date_column" does not exist
  LINE 35:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:37:10.787241 [info ] [MainThread]: 
[0m13:37:10.787241 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  column "date_column" does not exist
  LINE 35:     EXTRACT(month FROM date_column) AS month,
                                  ^
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:10.788248 [info ] [MainThread]: 
[0m13:37:10.788248 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:37:10.790242 [debug] [MainThread]: Command `dbt run` failed at 13:37:10.789248 after 1.83 seconds
[0m13:37:10.790242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4979ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C5C3D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4C79A2E0>]}
[0m13:37:10.790242 [debug] [MainThread]: Flushing usage events
[0m13:37:35.128725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0195ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B043C7A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B022DA790>]}


============================== 13:37:35.129471 | 790c651e-e358-48bb-946a-e3588736024e ==============================
[0m13:37:35.129471 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:37:35.129471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:35.177796 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:37:35.193421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B01833190>]}
[0m13:37:35.193421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:37:35.195024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B018331C0>]}
[0m13:37:35.308211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B043B3D90>]}
[0m13:37:35.351414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B018468E0>]}
[0m13:37:35.351414 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:37:35.370666 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:37:35.514410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:37:35.514410 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:35.514410 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:37:35.514410 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:35.702025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:37:35.715699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04ACFEE0>]}
[0m13:37:35.807132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04AFCFD0>]}
[0m13:37:35.808132 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:37:35.809132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04AEE8E0>]}
[0m13:37:35.811132 [info ] [MainThread]: 
[0m13:37:35.811132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:35.816679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:37:35.875375 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:37:35.875375 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:37:35.876378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:36.024269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:37:36.025270 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:37:36.027270 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:37:36.033291 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:37:36.033291 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:37:36.033291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:36.172143 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.172143 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:37:36.172143 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:37:36.172143 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:37:36.172143 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:37:36.172143 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:37:36.188461 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:36.188461 [debug] [MainThread]: On master: BEGIN
[0m13:37:36.188461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:36.215031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.215031 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:36.219771 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:36.219771 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:37:36.229799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04B1D460>]}
[0m13:37:36.229799 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:36.229799 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:36.229799 [debug] [MainThread]: On master: BEGIN
[0m13:37:36.229799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.229799 [debug] [MainThread]: On master: COMMIT
[0m13:37:36.229799 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:36.229799 [debug] [MainThread]: On master: COMMIT
[0m13:37:36.229799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.229799 [debug] [MainThread]: On master: Close
[0m13:37:36.229799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:36.229799 [info ] [MainThread]: 
[0m13:37:36.238959 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:37:36.238959 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:37:36.239955 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:37:36.240955 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:37:36.248344 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:37:36.249345 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:37:36.284941 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:37:36.285914 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.285914 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:37:36.286930 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:37:36.322507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.323507 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.323507 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:37:36.330317 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:37:36.378057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.378057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:37:36.379033 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.382065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.382065 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:37:36.383057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.399943 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:37:36.399943 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.400972 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:37:36.402272 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.407849 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:37:36.411896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:37:36.412526 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:37:36.415244 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:36.417541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:37:36.418631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B01D27700>]}
[0m13:37:36.419635 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:37:36.420773 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:37:36.420773 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:37:36.420773 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:37:36.420773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:37:36.420773 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:37:36.420773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:37:36.420773 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:37:36.429798 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:37:36.430790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.430790 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:37:36.430790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:36.465818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.465818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.466813 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:37:36.469457 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:37:36.469457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.469457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:37:36.469457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.469457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.469457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:37:36.469457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.469457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:37:36.469457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.469457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:37:36.469457 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.485120 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:37:36.485120 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:37:36.485120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:37:36.485120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:36.485120 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:37:36.485120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04F47670>]}
[0m13:37:36.485120 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m13:37:36.485120 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:37:36.495944 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:37:36.495944 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:37:36.497627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:37:36.497627 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:37:36.498247 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.498247 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:37:36.506068 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.507086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.508068 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:37:36.508068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:36.543834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.543834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.544835 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:37:36.549834 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:37:36.552899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.552899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:37:36.552899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.552899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.552899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:37:36.552899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.552899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:37:36.552899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.552899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:37:36.552899 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.552899 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:37:36.552899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:37:36.552899 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:37:36.552899 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:36.569318 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:37:36.569318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0502A4F0>]}
[0m13:37:36.569318 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:37:36.569318 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:37:36.569318 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:37:36.572835 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:37:36.573853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:37:36.574850 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:37:36.578872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:37:36.579400 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:37:36.583431 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:37:36.584412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.585417 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:37:36.585417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:36.728223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.728223 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.728223 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:37:36.733733 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:37:36.733733 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.733733 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:37:36.733733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.733733 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.733733 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:37:36.733733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.733733 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:37:36.749372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.749372 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:37:36.749372 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.749372 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:37:36.749372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:37:36.749372 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:37:36.749372 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:36.749372 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:37:36.749372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0395A6A0>]}
[0m13:37:36.749372 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.18s]
[0m13:37:36.749372 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:37:36.749372 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:37:36.763768 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:37:36.764869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:37:36.764869 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:37:36.767775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:37:36.768800 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:37:36.773802 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:37:36.775313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.775313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:37:36.776333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:36.915969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:36.915969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.915969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:37:36.926773 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:37:36.931492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.932087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:37:36.933122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.937869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.937869 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:37:36.939018 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:36.940651 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:37:36.941214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.941889 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:37:36.942929 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:36.946122 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:37:36.947174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:37:36.947776 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:37:36.951305 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:36.953046 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:37:36.954129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B05023040>]}
[0m13:37:36.954663 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.19s]
[0m13:37:36.955747 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:37:36.956691 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:37:36.957237 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:37:36.958305 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:37:36.958853 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:37:36.961626 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:37:36.962692 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:37:36.969033 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:37:36.970641 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:36.971748 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:37:36.972454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:37.010857 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.011434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:37.011434 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:37:37.018693 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:37:37.023943 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:37.024478 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:37:37.025526 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:37.029367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:37.029890 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:37:37.030996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:37.033640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:37:37.034178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:37.034178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:37:37.035767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:37.038487 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:37:37.039008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:37:37.039547 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:37:37.042241 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:37.043881 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:37:37.044596 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B01D27700>]}
[0m13:37:37.045190 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.09s]
[0m13:37:37.046221 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:37:37.047286 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:37:37.048325 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:37:37.049364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:37:37.049882 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:37:37.054271 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.055351 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:37:37.060690 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.061221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.061754 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:37:37.062279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:37.095178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.095178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.095178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:37:37.095178 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:37:37.095178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.095178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:37:37.095178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:37.095178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.095178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:37:37.095178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:37:37.110827 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:37:37.110827 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.110827 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:37:37.110827 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:37:37.115863 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:37:37.115863 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:37:37.115863 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:37:37.115863 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:37:37.121396 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:37:37.121396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B01D27700>]}
[0m13:37:37.121396 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:37:37.121396 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:37:37.124250 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:37.124847 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:37:37.125854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:37:37.125854 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:37.128851 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:37.129887 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:37.133852 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:37.135853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:37.135853 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:37:37.135853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:37.169340 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.170357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:37:37.170357 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    EXTRACT(month FROM order_date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:37:37.171448 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function pg_catalog.extract(unknown, text) does not exist
LINE 25:     EXTRACT(month FROM order_date) AS month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:37:37.171448 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: ROLLBACK
[0m13:37:37.171448 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:37:37.171448 [debug] [Thread-1  ]: Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 25:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:37.171448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04971550>]}
[0m13:37:37.171448 [error] [Thread-1  ]: 8 of 13 ERROR creating sql table model public.int_monthly_employee_revenue ..... [[31mERROR[0m in 0.05s]
[0m13:37:37.171448 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:37:37.171448 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:37.171448 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:37:37.180175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:37:37.180175 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:37.184207 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:37.185199 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:37.189198 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:37.190181 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:37.191182 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:37:37.191182 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:37.226640 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.227171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:37:37.227171 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    EXTRACT(month FROM order_date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:37:37.227171 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function pg_catalog.extract(unknown, text) does not exist
LINE 35:     EXTRACT(month FROM order_date) AS month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:37:37.227171 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: ROLLBACK
[0m13:37:37.227171 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:37:37.227171 [debug] [Thread-1  ]: Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 35:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:37:37.227171 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B050750A0>]}
[0m13:37:37.227171 [error] [Thread-1  ]: 9 of 13 ERROR creating sql table model public.int_monthly_category_sales ....... [[31mERROR[0m in 0.05s]
[0m13:37:37.227171 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:37:37.227171 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:37.233733 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:37:37.234748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:37:37.234748 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:37.237767 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:37.238763 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:37.243911 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:37.244911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:37.245896 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:37:37.245896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:37:37.275186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.275186 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:37:37.275186 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    EXTRACT(month FROM order_date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:37:37.275186 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function pg_catalog.extract(unknown, text) does not exist
LINE 35:     EXTRACT(month FROM order_date) AS month,
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:37:37.275186 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: ROLLBACK
[0m13:37:37.275186 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:37:37.275186 [debug] [Thread-1  ]: Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 35:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:37.275186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '790c651e-e358-48bb-946a-e3588736024e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B043BDD00>]}
[0m13:37:37.275186 [error] [Thread-1  ]: 10 of 13 ERROR creating sql table model public.int_monthly_supplier_revenue .... [[31mERROR[0m in 0.04s]
[0m13:37:37.275186 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:37:37.275186 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:37:37.275186 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m13:37:37.290390 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:37:37.291396 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:37:37.292405 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m13:37:37.293405 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:37:37.293405 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:37:37.293405 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m13:37:37.294395 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:37:37.295403 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:37.296405 [debug] [MainThread]: On master: BEGIN
[0m13:37:37.296405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:37.330432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:37:37.330432 [debug] [MainThread]: On master: COMMIT
[0m13:37:37.330432 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:37.330432 [debug] [MainThread]: On master: COMMIT
[0m13:37:37.330432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:37:37.330432 [debug] [MainThread]: On master: Close
[0m13:37:37.330432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:37.330432 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:37:37.330432 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:37:37.330432 [debug] [MainThread]: Connection 'model.dbt_dskola_project.int_monthly_supplier_revenue' was properly closed.
[0m13:37:37.330432 [info ] [MainThread]: 
[0m13:37:37.330432 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m13:37:37.341359 [debug] [MainThread]: Command end result
[0m13:37:37.369621 [info ] [MainThread]: 
[0m13:37:37.370604 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m13:37:37.371609 [info ] [MainThread]: 
[0m13:37:37.372608 [error] [MainThread]:   Database Error in model int_monthly_employee_revenue (models\intermediate\int_monthly_employee_revenue.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 25:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_employee_revenue.sql
[0m13:37:37.373625 [info ] [MainThread]: 
[0m13:37:37.374975 [error] [MainThread]:   Database Error in model int_monthly_category_sales (models\intermediate\int_monthly_category_sales.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 35:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_category_sales.sql
[0m13:37:37.376982 [info ] [MainThread]: 
[0m13:37:37.377991 [error] [MainThread]:   Database Error in model int_monthly_supplier_revenue (models\intermediate\int_monthly_supplier_revenue.sql)
  function pg_catalog.extract(unknown, text) does not exist
  LINE 35:     EXTRACT(month FROM order_date) AS month,
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\intermediate\int_monthly_supplier_revenue.sql
[0m13:37:37.378990 [info ] [MainThread]: 
[0m13:37:37.379990 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 TOTAL=13
[0m13:37:37.381989 [debug] [MainThread]: Command `dbt run` failed at 13:37:37.380991 after 2.29 seconds
[0m13:37:37.381989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0195ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B04B10E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B03959730>]}
[0m13:37:37.382988 [debug] [MainThread]: Flushing usage events
[0m13:38:13.548840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154891AED00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548BC4DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548BC4DE20>]}


============================== 13:38:13.558958 | 8175c069-76bc-40af-9b83-fdca5e51b876 ==============================
[0m13:38:13.558958 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:38:13.558958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:13.615676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:38:13.615676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154890831F0>]}
[0m13:38:13.615676 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:38:13.623403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015489083220>]}
[0m13:38:13.731055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015489016A90>]}
[0m13:38:13.775891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548B7B7DF0>]}
[0m13:38:13.777652 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:38:13.785268 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:38:13.924996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:38:13.924996 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:38:13.924996 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:38:13.924996 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:38:14.098541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:38:14.122584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C360F40>]}
[0m13:38:14.211009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C313490>]}
[0m13:38:14.211009 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:38:14.211009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548BFAD220>]}
[0m13:38:14.215062 [info ] [MainThread]: 
[0m13:38:14.216091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:14.221592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:38:14.267771 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:38:14.277312 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:38:14.277312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:14.308879 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:38:14.308879 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:38:14.308879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:38:14.318907 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:38:14.318907 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:38:14.318907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:14.340090 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.340090 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:38:14.340090 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:38:14.355692 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:38:14.359731 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:38:14.359731 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:38:14.366269 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.366269 [debug] [MainThread]: On master: BEGIN
[0m13:38:14.366269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:14.388575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.388575 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.388575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:14.404256 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:38:14.404256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C319580>]}
[0m13:38:14.404256 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:14.404256 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.404256 [debug] [MainThread]: On master: BEGIN
[0m13:38:14.404256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.404256 [debug] [MainThread]: On master: COMMIT
[0m13:38:14.404256 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:14.404256 [debug] [MainThread]: On master: COMMIT
[0m13:38:14.404256 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.404256 [debug] [MainThread]: On master: Close
[0m13:38:14.404256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:14.404256 [info ] [MainThread]: 
[0m13:38:14.420452 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:38:14.421452 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:38:14.422453 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:38:14.422453 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:38:14.429972 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:38:14.430985 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:38:14.466718 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:38:14.467607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.468583 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:38:14.468583 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:38:14.596643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.596643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.596643 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:38:14.611776 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:38:14.664391 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.665389 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:38:14.666389 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.668929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.668929 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:38:14.669953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.688755 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:38:14.688755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.689749 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:38:14.690727 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.696749 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:38:14.698610 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:38:14.698610 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:38:14.698610 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:14.707575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:38:14.709577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C7896D0>]}
[0m13:38:14.709577 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.29s]
[0m13:38:14.710552 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:38:14.711560 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:38:14.711560 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:38:14.712552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:38:14.712552 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:38:14.716080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:38:14.717099 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:38:14.722102 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:38:14.723091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.724092 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:38:14.724092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:14.758427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.759445 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.759445 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:38:14.765585 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:38:14.768002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.768002 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:38:14.768002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.768002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.768002 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:38:14.768002 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.768002 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:38:14.768002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.768002 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:38:14.768002 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.768002 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:38:14.768002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:38:14.768002 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:38:14.783868 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:14.784396 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:38:14.784396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C7976D0>]}
[0m13:38:14.784396 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:38:14.784396 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:38:14.784396 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:38:14.789095 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:38:14.790108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:38:14.790108 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:38:14.793106 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.794140 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:38:14.797450 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.798443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.799552 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:38:14.800064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:14.830746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.830746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.830746 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:38:14.830746 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:38:14.830746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.830746 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:38:14.830746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.830746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.830746 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:38:14.830746 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.846397 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:38:14.846397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.846397 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:38:14.846397 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.846397 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:38:14.846397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:38:14.846397 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:38:14.846397 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:14.846397 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:38:14.846397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C879AF0>]}
[0m13:38:14.846397 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:38:14.846397 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:38:14.846397 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:38:14.859070 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:38:14.860601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:38:14.861609 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:38:14.865618 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:38:14.866620 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:38:14.870608 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:38:14.872121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.872121 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:38:14.872121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:14.906736 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.906736 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.907750 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:38:14.914777 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:38:14.918335 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.918335 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:38:14.919339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.920765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.920765 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:38:14.920765 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.920765 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:38:14.920765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.920765 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:38:14.920765 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.928693 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:38:14.929689 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:38:14.929689 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:38:14.931839 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:14.933866 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:38:14.933866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C1E2700>]}
[0m13:38:14.934851 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:38:14.935844 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:38:14.935844 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:38:14.936844 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:38:14.937844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:38:14.937844 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:38:14.940850 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:38:14.941876 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:38:14.945876 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:38:14.946882 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.946882 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:38:14.946882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:14.980204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:14.980204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.981221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:38:14.983317 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:38:14.983317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.983317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:38:14.983317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.983317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.983317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:38:14.983317 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:14.983317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:38:14.983317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.983317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:38:14.999012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:14.999012 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:38:14.999012 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:38:14.999012 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:38:14.999012 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:14.999012 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:38:14.999012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C88E190>]}
[0m13:38:14.999012 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.06s]
[0m13:38:14.999012 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:38:14.999012 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:38:15.011676 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:38:15.012683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:38:15.012683 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:38:15.015383 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.016390 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:38:15.020359 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.021383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.022366 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:38:15.022366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.054925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.055942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.055942 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:38:15.060924 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:38:15.060924 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.060924 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:38:15.060924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.060924 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.060924 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:38:15.060924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.070496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:38:15.070496 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.070496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:38:15.070496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.070496 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:38:15.070496 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:38:15.070496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:38:15.076001 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.076001 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:38:15.076001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C88E190>]}
[0m13:38:15.076001 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:38:15.076001 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:38:15.076001 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:38:15.083514 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:38:15.084539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:38:15.084539 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:38:15.088532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.089548 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:38:15.095519 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.096520 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.097522 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:38:15.097522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.137862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.137862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.137862 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:38:15.153478 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:38:15.153478 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.153478 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:38:15.153478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.160995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.160995 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:38:15.160995 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.160995 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:38:15.160995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.160995 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:38:15.160995 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.160995 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:38:15.160995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:38:15.160995 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:38:15.169725 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.169725 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:38:15.169725 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C88E190>]}
[0m13:38:15.169725 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.09s]
[0m13:38:15.169725 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:38:15.169725 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:38:15.176334 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:38:15.177339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:38:15.177990 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:38:15.180002 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.180002 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:38:15.184626 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.186631 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.187630 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:38:15.187630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.223024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.224054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.224054 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
  );
  
[0m13:38:15.233705 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:38:15.233705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.233705 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:38:15.233705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.233705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.233705 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:38:15.233705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.233705 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:38:15.233705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.233705 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:38:15.233705 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.233705 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:38:15.249412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:38:15.249412 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:38:15.249412 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.249412 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:38:15.249412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C88E190>]}
[0m13:38:15.249412 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.07s]
[0m13:38:15.249412 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:38:15.249412 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:38:15.249412 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:38:15.259859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:38:15.259859 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:38:15.263998 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.264996 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:38:15.267978 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.269971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.269971 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:38:15.269971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.302696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.302696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.302696 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
  );
  
[0m13:38:15.302696 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:38:15.317873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.317873 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:38:15.317873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.317873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.317873 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:38:15.317873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.317873 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:38:15.317873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.317873 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:38:15.317873 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.327948 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:38:15.327948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:38:15.327948 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:38:15.333465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.333465 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:38:15.333465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C92F310>]}
[0m13:38:15.333465 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.07s]
[0m13:38:15.339108 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:38:15.339108 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:38:15.340122 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:38:15.341113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:38:15.341113 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:38:15.344338 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.345339 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:38:15.349351 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.350343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.351343 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:38:15.351343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.380618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.380618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.380618 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
  );
  
[0m13:38:15.380618 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:38:15.396271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.396271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:38:15.396271 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.396271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.396271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:38:15.396271 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.396271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:38:15.396271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.396271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:38:15.396271 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.396271 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:38:15.396271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:38:15.396271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:38:15.412100 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.412100 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:38:15.412100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C9290D0>]}
[0m13:38:15.412100 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m13:38:15.412100 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:38:15.412100 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:38:15.417080 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:38:15.418085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:38:15.418085 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:38:15.421085 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.422612 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:38:15.426642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.428008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.428519 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:38:15.429558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.560617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.560617 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.560617 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month desc
  );
  
[0m13:38:15.568154 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:38:15.573671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.573671 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:38:15.573671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.573671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.573671 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:38:15.573671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.573671 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:38:15.573671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.573671 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:38:15.573671 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.573671 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:38:15.573671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:38:15.573671 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:38:15.589360 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.589360 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:38:15.589360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154890D5340>]}
[0m13:38:15.589360 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.17s]
[0m13:38:15.589360 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:38:15.589360 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:38:15.596249 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:38:15.596249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:38:15.597268 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:38:15.600267 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.601267 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:38:15.605357 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.607266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.607266 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:38:15.607266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.636676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.636676 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.636676 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:38:15.636676 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:38:15.651710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.651710 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:38:15.651710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.651710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.651710 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:38:15.651710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.651710 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:38:15.651710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.651710 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:38:15.651710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.660727 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:38:15.660727 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:38:15.660727 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:38:15.660727 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.667743 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:38:15.667943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C9163D0>]}
[0m13:38:15.667943 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:38:15.667943 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:38:15.667943 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:38:15.671480 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:38:15.672486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:38:15.673489 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:38:15.676486 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.676486 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:38:15.680997 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.681999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.683117 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:38:15.683623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:38:15.713038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.713038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.713038 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:38:15.713038 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:38:15.713038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.713038 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:38:15.713038 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.728954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.728954 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:38:15.728954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:38:15.728954 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:38:15.728954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.728954 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:38:15.728954 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.728954 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:38:15.728954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:38:15.728954 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:38:15.738974 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:38:15.738974 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:38:15.738974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8175c069-76bc-40af-9b83-fdca5e51b876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C91DF40>]}
[0m13:38:15.738974 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.07s]
[0m13:38:15.738974 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:38:15.744981 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:15.746006 [debug] [MainThread]: On master: BEGIN
[0m13:38:15.746006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:15.779732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:38:15.780767 [debug] [MainThread]: On master: COMMIT
[0m13:38:15.780767 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:15.780767 [debug] [MainThread]: On master: COMMIT
[0m13:38:15.781757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:38:15.781757 [debug] [MainThread]: On master: Close
[0m13:38:15.782737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:15.782737 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:38:15.782737 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:38:15.782737 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:38:15.783738 [info ] [MainThread]: 
[0m13:38:15.783738 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m13:38:15.786762 [debug] [MainThread]: Command end result
[0m13:38:15.813855 [info ] [MainThread]: 
[0m13:38:15.814839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:15.815832 [info ] [MainThread]: 
[0m13:38:15.815832 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:38:15.817832 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:15.817832 after 2.30 seconds
[0m13:38:15.817832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154891AED00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548C3781F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001548B7883D0>]}
[0m13:38:15.818833 [debug] [MainThread]: Flushing usage events
[0m13:39:48.222633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9440E2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A946B46AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A946B468E0>]}


============================== 13:39:48.222633 | 17441293-57a1-405b-a966-7ac72ae38330 ==============================
[0m13:39:48.222633 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:39:48.222633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:48.288645 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:39:48.290155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A943FB3160>]}
[0m13:39:48.291179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:39:48.291179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A943FB3190>]}
[0m13:39:48.405426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A946B29520>]}
[0m13:39:48.451960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A946B51340>]}
[0m13:39:48.453943 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:39:48.461777 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:39:48.616530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:39:48.616530 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:39:48.616530 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:39:48.616530 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:39:48.811106 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:39:48.824677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94728D9A0>]}
[0m13:39:48.922274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94727EB80>]}
[0m13:39:48.922274 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:39:48.923282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9472A72E0>]}
[0m13:39:48.924787 [info ] [MainThread]: 
[0m13:39:48.925793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:48.931378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:39:49.000062 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:39:49.001064 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:39:49.001064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:49.039406 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:39:49.040419 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:39:49.042704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:39:49.048708 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:39:49.048708 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:39:49.048708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:49.079896 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.079896 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:39:49.080907 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:39:49.086572 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:39:49.087572 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:39:49.088573 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:39:49.095314 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:49.096307 [debug] [MainThread]: On master: BEGIN
[0m13:39:49.096307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:49.127794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.128326 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:49.128326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:49.137799 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:39:49.138816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9472431C0>]}
[0m13:39:49.138816 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:49.139797 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:49.139797 [debug] [MainThread]: On master: BEGIN
[0m13:39:49.140798 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.140798 [debug] [MainThread]: On master: COMMIT
[0m13:39:49.140798 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:49.141798 [debug] [MainThread]: On master: COMMIT
[0m13:39:49.141798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.141798 [debug] [MainThread]: On master: Close
[0m13:39:49.142799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:49.142799 [info ] [MainThread]: 
[0m13:39:49.145791 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:39:49.146797 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:39:49.147681 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:39:49.148194 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:39:49.155207 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:39:49.156206 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:39:49.192272 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:39:49.193271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.194273 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:39:49.194273 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:39:49.224767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.224767 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.225772 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:39:49.232778 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:39:49.280627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.280627 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:39:49.281827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.284851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.284851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:39:49.286011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.291435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:39:49.291435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.291435 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:39:49.303952 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.303952 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:39:49.303952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:39:49.303952 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:39:49.303952 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.303952 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:39:49.319858 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9444A7670>]}
[0m13:39:49.319858 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:39:49.319858 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:39:49.323241 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:39:49.324257 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:39:49.325251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:39:49.325251 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:39:49.328324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:39:49.329321 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:39:49.334415 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:39:49.336069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.337078 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:39:49.337078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.467199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.467199 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.467199 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:39:49.477210 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:39:49.482747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.482747 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:39:49.482747 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.482747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.482747 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:39:49.482747 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.482747 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:39:49.482747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.482747 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:39:49.491759 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.491759 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:39:49.491759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:39:49.491759 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:39:49.491759 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.498794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:39:49.498794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9477F24C0>]}
[0m13:39:49.498794 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.17s]
[0m13:39:49.498794 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:39:49.498794 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:39:49.502357 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:39:49.503363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:39:49.504365 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:39:49.507393 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.507393 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:39:49.511372 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.513387 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.513387 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:39:49.514528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.548499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.548499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.549533 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:39:49.552558 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:39:49.552558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.552558 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:39:49.552558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.552558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.552558 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:39:49.552558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.552558 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:39:49.552558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.552558 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:39:49.552558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.552558 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:39:49.552558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:39:49.568209 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:39:49.568429 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.568429 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:39:49.568429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9444A7670>]}
[0m13:39:49.568429 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:39:49.568429 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:39:49.568429 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:39:49.576696 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:39:49.577721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:39:49.577721 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:39:49.582033 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:39:49.583051 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:39:49.586686 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:39:49.587669 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.588663 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:39:49.588663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.615634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.615634 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.615634 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:39:49.625660 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:39:49.631327 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.631833 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:39:49.632583 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.635831 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.636376 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:39:49.636931 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.638774 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:39:49.639317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.639880 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:39:49.640978 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.643299 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:39:49.643881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:39:49.644454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:39:49.647093 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.648686 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:39:49.649246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9460DAF40>]}
[0m13:39:49.650442 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:39:49.651490 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:39:49.652033 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:39:49.653103 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:39:49.654175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:39:49.654175 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:39:49.657925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:39:49.659566 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:39:49.665123 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:39:49.666118 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.666118 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:39:49.667129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.703599 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.704615 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.704615 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:39:49.712450 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:39:49.716480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.716480 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:39:49.717985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.723994 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.725005 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:39:49.726379 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.728381 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:39:49.729391 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.730393 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:39:49.731380 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.734411 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:39:49.734411 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:39:49.735387 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:39:49.737654 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.738660 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:39:49.739660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9477F11F0>]}
[0m13:39:49.740658 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.09s]
[0m13:39:49.741659 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:39:49.741659 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:39:49.742691 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:39:49.743659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:39:49.743659 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:39:49.746687 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.747659 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:39:49.751688 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.751688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.752697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:39:49.752697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.781711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.781711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.781711 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:39:49.793045 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:39:49.797083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.797083 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:39:49.798055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.800062 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.801061 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:39:49.801061 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.803132 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:39:49.803132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.803132 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:39:49.803132 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.803132 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:39:49.803132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:39:49.803132 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:39:49.811629 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.812637 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:39:49.813636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9477A9190>]}
[0m13:39:49.813636 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:39:49.814633 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:39:49.815644 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:39:49.815644 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:39:49.816635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:39:49.816635 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:39:49.821624 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.821624 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:39:49.825624 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.826624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.828129 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:39:49.828129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:49.964280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:49.964280 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.964280 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:39:49.964280 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:39:49.973806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.973806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:39:49.973806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.973806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.973806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:39:49.973806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:49.979325 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:39:49.979325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.979325 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:39:49.979325 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:49.979325 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:39:49.979325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:39:49.979325 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:39:49.979325 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:49.979325 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:39:49.979325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9477FBFD0>]}
[0m13:39:49.992332 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.16s]
[0m13:39:49.992332 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:39:49.992332 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:39:49.994820 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:39:49.995836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:39:49.996987 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:39:50.000136 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.001117 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:39:50.006117 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.007116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.007116 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:39:50.008118 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.134546 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.134546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.134546 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month
  );
  
[0m13:39:50.150252 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:39:50.150252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.150252 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:39:50.150252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.150252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.150252 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:39:50.150252 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.164990 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:39:50.166098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.166098 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:39:50.167656 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.169631 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:39:50.170816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:39:50.170816 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:39:50.173816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.174823 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:39:50.176351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9476B9040>]}
[0m13:39:50.176351 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.18s]
[0m13:39:50.177356 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:39:50.178361 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:39:50.178361 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:39:50.179363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:39:50.180374 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:39:50.183372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.184373 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:39:50.189379 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.190375 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.191362 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:39:50.191362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.228413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.229415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.229415 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month
  );
  
[0m13:39:50.240154 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:39:50.240154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.240154 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:39:50.240154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.240154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.240154 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:39:50.240154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.240154 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:39:50.240154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.240154 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:39:50.255287 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.258976 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:39:50.259972 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:39:50.259972 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:39:50.263200 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.264123 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:39:50.265638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9470C9B20>]}
[0m13:39:50.265638 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:39:50.266653 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:39:50.267830 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:39:50.267996 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:39:50.269004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:39:50.270007 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:39:50.273004 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.274022 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:39:50.279060 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.281028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.281028 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:39:50.282031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.320044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.320044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.321033 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month
  );
  
[0m13:39:50.324637 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:39:50.324637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.324637 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:39:50.324637 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.339855 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.340871 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:39:50.341871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.343871 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:39:50.343871 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.344870 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:39:50.345871 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.348860 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:39:50.349871 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:39:50.349871 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:39:50.351992 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.351992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:39:50.351992 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A947859430>]}
[0m13:39:50.351992 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:39:50.351992 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:39:50.357132 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:39:50.357132 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:39:50.358125 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:39:50.358125 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:39:50.362144 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.363141 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:39:50.367305 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.368842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.369831 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:39:50.370830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.404892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.405915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.405915 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month desc
  );
  
[0m13:39:50.413012 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:39:50.416897 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.417897 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:39:50.418890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.420685 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.420685 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:39:50.423197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.423197 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:39:50.423197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.423197 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:39:50.423197 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.429654 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:39:50.430670 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:39:50.430670 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:39:50.433659 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.434672 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:39:50.435689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9477F11F0>]}
[0m13:39:50.436665 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.08s]
[0m13:39:50.437665 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:39:50.437665 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:39:50.438664 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:39:50.438664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:39:50.439663 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:39:50.442666 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.442666 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:39:50.447690 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.447690 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.448673 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:39:50.448673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.584084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.585090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.585090 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:39:50.593091 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:39:50.595656 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.596648 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:39:50.596648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.599647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.599647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:39:50.600663 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.601169 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:39:50.601169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.601169 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:39:50.601169 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.601169 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:39:50.601169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:39:50.601169 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:39:50.601169 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.601169 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:39:50.601169 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94784C430>]}
[0m13:39:50.601169 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.16s]
[0m13:39:50.601169 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:39:50.601169 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:39:50.615881 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:39:50.616751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:39:50.617766 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:39:50.620760 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.620760 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:39:50.624740 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.626277 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.627291 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:39:50.627291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:39:50.661338 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.661338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.662369 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:39:50.664470 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:39:50.664470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.664470 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:39:50.664470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.674005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.674005 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:39:50.674005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:39:50.674005 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:39:50.674005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.674005 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:39:50.674005 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.682331 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:39:50.682872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:39:50.683501 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:39:50.686465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:39:50.687710 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:39:50.688301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17441293-57a1-405b-a966-7ac72ae38330', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9470E8250>]}
[0m13:39:50.688804 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.07s]
[0m13:39:50.689936 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:39:50.691450 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:50.691976 [debug] [MainThread]: On master: BEGIN
[0m13:39:50.691976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:50.724921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:39:50.724921 [debug] [MainThread]: On master: COMMIT
[0m13:39:50.725945 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:50.725945 [debug] [MainThread]: On master: COMMIT
[0m13:39:50.725945 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:39:50.726929 [debug] [MainThread]: On master: Close
[0m13:39:50.726929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:50.727923 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:39:50.727923 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:39:50.727923 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:39:50.728922 [info ] [MainThread]: 
[0m13:39:50.729922 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m13:39:50.732952 [debug] [MainThread]: Command end result
[0m13:39:50.763958 [info ] [MainThread]: 
[0m13:39:50.764986 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:50.765923 [info ] [MainThread]: 
[0m13:39:50.766923 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:39:50.767883 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:50.767883 after 2.59 seconds
[0m13:39:50.768964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9440E2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A947893BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A947893CD0>]}
[0m13:39:50.768964 [debug] [MainThread]: Flushing usage events
[0m13:42:38.558398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9681C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC11BD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC11BC40>]}


============================== 13:42:38.562433 | 9b297d38-f52f-4d40-bc42-70232d6516b4 ==============================
[0m13:42:38.562433 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:42:38.563404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'profiles_dir': './', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m13:42:38.628013 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:42:38.628991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9553160>]}
[0m13:42:38.629991 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:42:38.630992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9553190>]}
[0m13:42:38.741526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC0DD5E0>]}
[0m13:42:38.790452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC0E7040>]}
[0m13:42:38.792239 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:42:38.799097 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:42:38.948211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:38.948211 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:42:39.136900 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:42:39.154928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC837E80>]}
[0m13:42:39.251867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC80DA90>]}
[0m13:42:39.252868 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:42:39.252868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC8372E0>]}
[0m13:42:39.254867 [info ] [MainThread]: 
[0m13:42:39.255867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:42:39.261274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:42:39.320785 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:42:39.321793 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:42:39.321793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:39.357974 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:42:39.358984 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:42:39.360985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:42:39.366530 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:42:39.367558 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:42:39.367558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:39.404230 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.405241 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:42:39.405241 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:42:39.411240 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:42:39.412237 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:42:39.413240 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:42:39.419749 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:39.420762 [debug] [MainThread]: On master: BEGIN
[0m13:42:39.420762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:39.451174 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.452187 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:39.452187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:42:39.461186 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:42:39.463186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CBF9EDF0>]}
[0m13:42:39.463186 [debug] [MainThread]: On master: ROLLBACK
[0m13:42:39.464186 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:39.464186 [debug] [MainThread]: On master: BEGIN
[0m13:42:39.464186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.464186 [debug] [MainThread]: On master: COMMIT
[0m13:42:39.465691 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:39.465691 [debug] [MainThread]: On master: COMMIT
[0m13:42:39.466211 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:42:39.466211 [debug] [MainThread]: On master: Close
[0m13:42:39.467224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:42:39.467224 [info ] [MainThread]: 
[0m13:42:39.471217 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:42:39.472218 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:42:39.473225 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:42:39.473225 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:42:39.480268 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:42:39.481258 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:42:39.516255 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:42:39.517625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.517625 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:42:39.517625 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:42:39.549249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.549249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.550251 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:42:39.556767 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:42:39.563774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.564773 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:42:39.564773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.607972 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.607972 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:42:39.607972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.627503 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:42:39.628502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.628502 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:42:39.630485 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:39.636485 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:42:39.639502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:42:39.640504 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:42:39.643489 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:39.646491 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:42:39.648477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCC585B0>]}
[0m13:42:39.649656 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:42:39.650666 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:42:39.650666 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:42:39.651682 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:42:39.652682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:42:39.652682 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:42:39.655678 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:42:39.655678 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:42:39.659674 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:42:39.661673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.661673 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:42:39.661673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:39.810545 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.810545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.811544 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:42:39.820662 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:42:39.825035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.826028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:42:39.827041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.830093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.831101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:42:39.832093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.834093 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:42:39.835100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.835100 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:42:39.836100 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:39.840118 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:42:39.841100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:42:39.841100 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:42:39.845094 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:39.846095 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:42:39.847093 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC692C40>]}
[0m13:42:39.848095 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.20s]
[0m13:42:39.849102 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:42:39.849102 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:42:39.850101 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:42:39.851102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:42:39.851102 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:42:39.855114 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.855114 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:42:39.860114 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.861110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.862116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:42:39.862116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:39.901319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.902322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.902322 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:42:39.907303 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:42:39.912095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.912095 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:42:39.913119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.916102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.916102 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:42:39.917101 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:39.919107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:42:39.919107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.919107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:42:39.921631 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:39.923630 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:42:39.924630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:42:39.925700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:42:39.929240 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:39.930224 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:42:39.931243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC8D5190>]}
[0m13:42:39.932219 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.08s]
[0m13:42:39.933219 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:42:39.933219 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:42:39.934400 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:42:39.935401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:42:39.935401 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:42:39.938409 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:42:39.939408 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:42:39.947092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:42:39.948102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:39.949092 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:42:39.949092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:39.986054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:39.987073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:39.987073 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:42:39.994052 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:42:39.998057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:39.998057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:42:39.999055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.002070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:40.003045 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:42:40.004053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.006044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:42:40.006044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:40.007045 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:42:40.008052 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.011051 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:42:40.012051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:42:40.012051 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:42:40.016050 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.017050 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:42:40.018158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CB67A7F0>]}
[0m13:42:40.019058 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.08s]
[0m13:42:40.020058 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:42:40.020058 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:42:40.021051 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:42:40.022059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:42:40.023054 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:42:40.026053 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:42:40.027045 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:42:40.030573 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:42:40.031578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.032575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:42:40.032575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.073213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.073213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.073213 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:42:40.078776 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:42:40.083778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.083778 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:42:40.084792 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.087202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.087202 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:42:40.087202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.087202 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:42:40.087202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.087202 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:42:40.087202 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.087202 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:42:40.087202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:42:40.087202 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:42:40.087202 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.103554 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:42:40.103554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CB67A7F0>]}
[0m13:42:40.104555 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.08s]
[0m13:42:40.105553 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:42:40.106546 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:42:40.106546 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:42:40.107546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:42:40.107546 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:42:40.111547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.112547 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:42:40.116568 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.118557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.119554 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:42:40.120555 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.162533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.163539 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.164541 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:42:40.172068 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:42:40.175575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.176575 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:42:40.177575 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.180578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.181577 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:42:40.182576 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.184574 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:42:40.184574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.184574 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:42:40.186574 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.188573 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:42:40.189573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:42:40.189573 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:42:40.192335 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.194351 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:42:40.194351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC692C40>]}
[0m13:42:40.195334 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.09s]
[0m13:42:40.196335 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:42:40.196335 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:42:40.197337 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:42:40.198336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:42:40.198336 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:42:40.201338 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.202351 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:42:40.207331 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.209336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.210346 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:42:40.210346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.256045 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.256045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.256045 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:42:40.266051 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:42:40.267780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.267780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:42:40.267780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.267780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.267780 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:42:40.275452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.277456 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:42:40.277456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.277456 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:42:40.279330 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.281368 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:42:40.282347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:42:40.282347 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:42:40.285343 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.287448 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:42:40.287448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCC336D0>]}
[0m13:42:40.288442 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.09s]
[0m13:42:40.289442 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:42:40.289442 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:42:40.290451 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:42:40.291441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:42:40.291441 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:42:40.294474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.295447 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:42:40.299448 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.300448 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.301465 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:42:40.301465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.336923 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.338014 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.338524 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month
  );
  
[0m13:42:40.348536 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:42:40.351538 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.352551 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:42:40.353549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.356566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.357552 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:42:40.358547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.359552 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:42:40.360550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.360550 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:42:40.361555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.364565 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:42:40.365567 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:42:40.365567 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:42:40.368442 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.369532 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:42:40.370442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC68DE20>]}
[0m13:42:40.370442 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:42:40.371441 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:42:40.372443 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:42:40.372443 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:42:40.373442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:42:40.373442 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:42:40.377441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.377441 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:42:40.381952 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.382952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.382952 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:42:40.383952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.418556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.419557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.419557 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month
  );
  
[0m13:42:40.434054 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:42:40.434384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.434384 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:42:40.434384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.441291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.441291 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:42:40.442306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.444305 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:42:40.444305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.444305 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:42:40.446304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.449306 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:42:40.450332 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:42:40.450332 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:42:40.453301 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.455649 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:42:40.455649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC68DE20>]}
[0m13:42:40.456654 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:42:40.457655 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:42:40.458655 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:42:40.458655 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:42:40.459656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:42:40.460655 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:42:40.465655 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.465655 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:42:40.471175 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.472191 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.473173 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:42:40.474167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.511238 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.511238 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.512237 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month
  );
  
[0m13:42:40.524597 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:42:40.528589 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.528589 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:42:40.529596 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.532613 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.532613 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:42:40.533595 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.535588 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:42:40.535588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.536588 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:42:40.537588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.539588 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:42:40.540588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:42:40.540588 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:42:40.543697 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.545213 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:42:40.545213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCDB7220>]}
[0m13:42:40.546214 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.09s]
[0m13:42:40.547207 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:42:40.547207 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:42:40.548205 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:42:40.549205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:42:40.549205 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:42:40.552437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:42:40.553446 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:42:40.558643 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:42:40.559649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:42:40.560649 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:42:40.560649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.595611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.596642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:42:40.596642 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    TO_CHAR(month),
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:42:40.597639 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function to_char(double precision) does not exist
LINE 26:     TO_CHAR(month),
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:42:40.598640 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m13:42:40.598640 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:42:40.601616 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function to_char(double precision) does not exist
  LINE 26:     TO_CHAR(month),
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:42:40.602616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCDCE280>]}
[0m13:42:40.602616 [error] [Thread-1  ]: 11 of 13 ERROR creating sql table model public.datamart_monthly_best_employee .. [[31mERROR[0m in 0.05s]
[0m13:42:40.603584 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:42:40.603584 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:42:40.604596 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:42:40.605589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:42:40.605589 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:42:40.609598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.610597 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:42:40.615701 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.616596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.617851 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:42:40.617851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.656774 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.657804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.658777 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:42:40.665778 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:42:40.670317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.670558 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:42:40.671566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.674077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.674077 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:42:40.675075 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.677075 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:42:40.678193 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.679075 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:42:40.680101 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.682086 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:42:40.683086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:42:40.683086 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:42:40.684665 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.684665 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:42:40.684665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCDB7220>]}
[0m13:42:40.684665 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.08s]
[0m13:42:40.684665 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:42:40.684665 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:42:40.691350 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:42:40.691350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:42:40.692944 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:42:40.697283 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.698341 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:42:40.705894 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.706894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.708178 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:42:40.708713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:42:40.744428 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.745459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.745459 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:42:40.751841 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:42:40.758458 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.758458 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:42:40.759459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.762474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.763477 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:42:40.764452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:42:40.765475 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:42:40.766458 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.766458 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:42:40.767844 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.769983 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:42:40.770849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:42:40.770849 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:42:40.773700 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:42:40.775888 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:42:40.775888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b297d38-f52f-4d40-bc42-70232d6516b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCDB7220>]}
[0m13:42:40.776871 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.08s]
[0m13:42:40.777864 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:42:40.778866 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:40.778866 [debug] [MainThread]: On master: BEGIN
[0m13:42:40.778866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:40.817339 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:42:40.818338 [debug] [MainThread]: On master: COMMIT
[0m13:42:40.819336 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:40.819336 [debug] [MainThread]: On master: COMMIT
[0m13:42:40.819336 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:42:40.820370 [debug] [MainThread]: On master: Close
[0m13:42:40.820370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:40.821363 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:42:40.821363 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:42:40.821363 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:42:40.821363 [info ] [MainThread]: 
[0m13:42:40.822384 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m13:42:40.825370 [debug] [MainThread]: Command end result
[0m13:42:40.856468 [info ] [MainThread]: 
[0m13:42:40.858381 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:42:40.859381 [info ] [MainThread]: 
[0m13:42:40.860385 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  function to_char(double precision) does not exist
  LINE 26:     TO_CHAR(month),
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:42:40.861373 [info ] [MainThread]: 
[0m13:42:40.862381 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:42:40.864381 [debug] [MainThread]: Command `dbt run` failed at 13:42:40.864381 after 2.35 seconds
[0m13:42:40.865403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230C9681C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CC71E340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230CCE10130>]}
[0m13:42:40.865403 [debug] [MainThread]: Flushing usage events
[0m13:43:15.874372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022320A9ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223234F3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223234F33A0>]}


============================== 13:43:15.890017 | be786144-fc0b-48e0-90c0-8f4075481651 ==============================
[0m13:43:15.890017 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:43:15.890017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:15.948423 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:43:15.948423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223209731C0>]}
[0m13:43:15.948423 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:43:15.948423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223209731F0>]}
[0m13:43:16.045031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232141A850>]}
[0m13:43:16.092149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223233CB070>]}
[0m13:43:16.092149 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:43:16.103483 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:43:16.238649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:16.238649 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:43:16.397016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:43:16.424050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323C57F10>]}
[0m13:43:16.514038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323C3A430>]}
[0m13:43:16.514038 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:43:16.514038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323C67070>]}
[0m13:43:16.517847 [info ] [MainThread]: 
[0m13:43:16.518853 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:16.524386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:43:16.576469 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:43:16.576469 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:43:16.576469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:16.607820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:43:16.607820 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:43:16.617829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:43:16.617829 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:43:16.617829 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:43:16.617829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:16.652893 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:43:16.652893 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:43:16.653917 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:43:16.658900 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:43:16.658900 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:43:16.658900 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:43:16.658900 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:16.658900 [debug] [MainThread]: On master: BEGIN
[0m13:43:16.658900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:16.700033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:43:16.700600 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:16.701167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:43:16.706439 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:43:16.706439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223207A3B80>]}
[0m13:43:16.706439 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:16.706439 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:16.706439 [debug] [MainThread]: On master: BEGIN
[0m13:43:16.706439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:43:16.706439 [debug] [MainThread]: On master: COMMIT
[0m13:43:16.706439 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:16.706439 [debug] [MainThread]: On master: COMMIT
[0m13:43:16.706439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:43:16.706439 [debug] [MainThread]: On master: Close
[0m13:43:16.706439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:16.706439 [info ] [MainThread]: 
[0m13:43:16.718119 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:43:16.719120 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:43:16.720119 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:43:16.720119 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:43:16.728119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:43:16.729111 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:43:16.765445 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:43:16.765445 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.766431 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:43:16.766431 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:43:16.785536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:16.785536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.785536 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:43:16.801171 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:43:16.801171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.801171 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:43:16.801171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:16.848516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.848516 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:43:16.848516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:16.864234 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:43:16.864234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.864234 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:43:16.864234 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:16.874345 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:43:16.874345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:43:16.879930 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:43:16.879930 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:16.879930 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:43:16.879930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022324071640>]}
[0m13:43:16.879930 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:43:16.879930 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:43:16.879930 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:43:16.890069 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:43:16.891087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:43:16.891087 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:43:16.895098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:43:16.896088 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:43:16.899086 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:43:16.901096 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.901096 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:43:16.902076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:16.937120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:16.938124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.938124 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:43:16.943575 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:43:16.946608 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.947609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:43:16.948274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:16.948274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.948274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:43:16.948274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:16.948274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:43:16.948274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.948274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:43:16.948274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:16.948274 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:43:16.948274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:43:16.948274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:43:16.948274 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:16.963414 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:43:16.963948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223240A6CD0>]}
[0m13:43:16.963948 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:43:16.963948 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:43:16.963948 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:43:16.966653 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:43:16.967658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:43:16.968659 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:43:16.971024 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:43:16.972019 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:43:16.975575 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:43:16.976554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:16.977561 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:43:16.977561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.010745 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.010745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:17.010745 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:43:17.010745 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:43:17.010745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:17.010745 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:43:17.020789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.020789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:17.020789 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:43:17.020789 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.020789 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:43:17.026329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:17.026329 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:43:17.026329 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.030340 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:43:17.030340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:43:17.030340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:43:17.030340 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.030340 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:43:17.030340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022324065AC0>]}
[0m13:43:17.030340 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:43:17.037912 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:43:17.037912 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:43:17.038903 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:43:17.039910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:43:17.039910 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:43:17.042909 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:43:17.043909 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:43:17.048906 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:43:17.049910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.050928 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:43:17.050928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.086482 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.087164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.087164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:43:17.087164 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:43:17.087164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.087164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:43:17.087164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.102184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.102184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:43:17.102184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.102184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:43:17.102184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.102184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:43:17.102184 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.102184 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:43:17.102184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:43:17.102184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:43:17.102184 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.102184 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:43:17.118040 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223240A9280>]}
[0m13:43:17.118040 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.08s]
[0m13:43:17.118040 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:43:17.121074 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:43:17.122081 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:43:17.123084 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:43:17.123084 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:43:17.126151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:43:17.127161 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:43:17.132524 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:43:17.133528 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.134439 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:43:17.134439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.177418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.177942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.177942 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:43:17.187249 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:43:17.191135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.191647 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:43:17.192712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.197357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.197902 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:43:17.199025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.200655 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:43:17.201726 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.202319 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:43:17.203956 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.206992 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:43:17.207527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:43:17.208075 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:43:17.211986 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.213601 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:43:17.214148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232407D9A0>]}
[0m13:43:17.215205 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.09s]
[0m13:43:17.216262 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:43:17.216803 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:43:17.217537 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:43:17.219128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:43:17.219929 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:43:17.224956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.226423 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:43:17.234281 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.236580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.237103 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:43:17.237657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.287384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.288433 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.289481 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:43:17.299408 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:43:17.302869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.304034 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:43:17.304548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.308303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.308840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:43:17.309918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.312060 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:43:17.312595 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.313117 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:43:17.314970 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.317728 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:43:17.318865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:43:17.318865 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:43:17.322120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.323798 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:43:17.324307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232407D910>]}
[0m13:43:17.324853 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.11s]
[0m13:43:17.325380 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:43:17.326707 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:43:17.326707 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:43:17.327714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:43:17.328714 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:43:17.331247 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.332262 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:43:17.338254 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.339253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.339253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:43:17.340253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.371797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.371797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.371797 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:43:17.371797 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:43:17.371797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.371797 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:43:17.387595 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.388107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.388107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:43:17.388107 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.388107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:43:17.388107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.388107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:43:17.388107 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.388107 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:43:17.388107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:43:17.388107 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:43:17.388107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.403142 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:43:17.403142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323A7AA60>]}
[0m13:43:17.403142 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.08s]
[0m13:43:17.403142 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:43:17.403142 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:43:17.407083 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:43:17.408088 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:43:17.408088 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:43:17.411094 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.412118 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:43:17.416109 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.417123 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.418099 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:43:17.418099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.455203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.455203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.455203 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month
  );
  
[0m13:43:17.455203 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:43:17.455203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.455203 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:43:17.471024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.471024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.471024 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:43:17.471024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.471024 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:43:17.471024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.471024 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:43:17.471024 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.481104 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:43:17.481104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:43:17.481104 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:43:17.481104 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.481104 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:43:17.486818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223241E48B0>]}
[0m13:43:17.487325 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:43:17.487325 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:43:17.489700 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:43:17.489700 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:43:17.491706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:43:17.491706 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:43:17.495728 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.495728 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:43:17.500732 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.501729 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.502908 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:43:17.502908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.539676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.540770 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.540770 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month
  );
  
[0m13:43:17.545582 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:43:17.545582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.545582 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:43:17.545582 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.560710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.560710 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:43:17.560710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.560710 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:43:17.560710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.560710 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:43:17.560710 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.560710 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:43:17.560710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:43:17.560710 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:43:17.570755 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.570755 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:43:17.570755 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323A9FD00>]}
[0m13:43:17.570755 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:43:17.576262 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:43:17.576262 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:43:17.577880 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:43:17.578893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:43:17.578893 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:43:17.583908 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.584914 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:43:17.588896 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.589886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.590893 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:43:17.590893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.626098 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.626098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.627123 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month
  );
  
[0m13:43:17.630688 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:43:17.630688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.630688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:43:17.630688 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.630688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.630688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:43:17.645192 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.645192 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:43:17.645192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.645192 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:43:17.645192 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.645192 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:43:17.645192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:43:17.645192 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:43:17.645192 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.645192 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:43:17.645192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223240599A0>]}
[0m13:43:17.645192 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m13:43:17.645192 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:43:17.660874 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:43:17.661353 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:43:17.662363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:43:17.663460 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:43:17.666553 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.667539 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:43:17.671469 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.671980 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.672994 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:43:17.672994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.706072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.706072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.706072 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month desc
  );
  
[0m13:43:17.706072 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:43:17.706072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.706072 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:43:17.706072 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.721728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.721728 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:43:17.721728 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.721728 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:43:17.721728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.721728 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:43:17.721728 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.732297 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:43:17.732297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:43:17.732297 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:43:17.732297 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.737849 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:43:17.737849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232416A610>]}
[0m13:43:17.737849 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.08s]
[0m13:43:17.737849 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:43:17.737849 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:43:17.741918 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:43:17.742926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:43:17.742926 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:43:17.746924 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.747926 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:43:17.751956 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.752923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.754292 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:43:17.754826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.787709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.788728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.788793 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:43:17.788793 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:43:17.788793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.788793 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:43:17.788793 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.788793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.788793 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:43:17.788793 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.788793 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:43:17.804544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.805058 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:43:17.805592 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.805592 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:43:17.805592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:43:17.805592 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:43:17.805592 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.805592 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:43:17.805592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232425D3A0>]}
[0m13:43:17.805592 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.06s]
[0m13:43:17.805592 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:43:17.805592 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:43:17.818733 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:43:17.819870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:43:17.819870 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:43:17.822746 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.823762 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:43:17.827768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.828776 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.830287 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:43:17.830287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:17.865378 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.865378 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.865378 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:43:17.870904 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:43:17.870904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.870904 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:43:17.870904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.870904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.870904 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:43:17.881492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:43:17.881492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:43:17.881492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.881492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:43:17.881492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.881492 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:43:17.881492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:43:17.881492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:43:17.881492 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:43:17.881492 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:43:17.881492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be786144-fc0b-48e0-90c0-8f4075481651', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223240D0CA0>]}
[0m13:43:17.881492 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.06s]
[0m13:43:17.881492 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:43:17.896120 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:17.896120 [debug] [MainThread]: On master: BEGIN
[0m13:43:17.897126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:17.931591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:43:17.932611 [debug] [MainThread]: On master: COMMIT
[0m13:43:17.932611 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:17.932611 [debug] [MainThread]: On master: COMMIT
[0m13:43:17.933611 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:43:17.933611 [debug] [MainThread]: On master: Close
[0m13:43:17.934609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:17.934609 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:43:17.934609 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:43:17.934609 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:43:17.935609 [info ] [MainThread]: 
[0m13:43:17.936610 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m13:43:17.939609 [debug] [MainThread]: Command end result
[0m13:43:17.968610 [info ] [MainThread]: 
[0m13:43:17.968610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:17.970130 [info ] [MainThread]: 
[0m13:43:17.971147 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:43:17.972151 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:17.972151 after 2.13 seconds
[0m13:43:17.973149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022320A9ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323AC8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022323074E80>]}
[0m13:43:17.973149 [debug] [MainThread]: Flushing usage events
[0m13:45:22.836346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D6D1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126016CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126016CC40>]}


============================== 13:45:22.842353 | 8c0db91f-cf39-444f-9357-f3c4aacaac14 ==============================
[0m13:45:22.842353 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:45:22.843353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m13:45:22.928984 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:45:22.929993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D5A3160>]}
[0m13:45:22.930992 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:45:22.930992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D5A3190>]}
[0m13:45:23.054108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126012D5E0>]}
[0m13:45:23.108199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260138040>]}
[0m13:45:23.111205 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:45:23.119848 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:45:23.307639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:45:23.308641 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:45:23.309571 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:45:23.531198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:45:23.550721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126083AEE0>]}
[0m13:45:23.658008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260870BE0>]}
[0m13:45:23.658988 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:45:23.659988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126083AD00>]}
[0m13:45:23.661991 [info ] [MainThread]: 
[0m13:45:23.661991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:23.670619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:45:23.731725 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:45:23.732749 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:45:23.732749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:23.775987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:45:23.776973 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:45:23.779972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:45:23.786965 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:45:23.787977 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:45:23.787977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:23.816976 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:45:23.817973 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:45:23.817973 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:45:23.824065 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:45:23.826047 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:45:23.826047 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:45:23.833593 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:23.833593 [debug] [MainThread]: On master: BEGIN
[0m13:45:23.834610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:23.862814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:23.863835 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:23.863835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:23.872445 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:45:23.873439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126087EC40>]}
[0m13:45:23.874443 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:23.874443 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:23.874443 [debug] [MainThread]: On master: BEGIN
[0m13:45:23.875954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:23.875954 [debug] [MainThread]: On master: COMMIT
[0m13:45:23.875954 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:23.875954 [debug] [MainThread]: On master: COMMIT
[0m13:45:23.877163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:23.877163 [debug] [MainThread]: On master: Close
[0m13:45:23.877163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:23.878168 [info ] [MainThread]: 
[0m13:45:23.878652 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:45:23.878652 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:45:23.878652 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:45:23.878652 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:45:23.889713 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:45:23.890690 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:45:23.927227 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:45:23.928227 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:23.928227 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:45:23.929226 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:45:23.955077 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:23.955077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:23.955077 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:45:23.965199 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:45:24.005529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:24.005529 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:45:24.005529 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.005529 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:24.015628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:45:24.015628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.025728 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:45:24.025728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:24.025728 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:45:24.034758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.035851 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:45:24.035851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:45:24.035851 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:45:24.048865 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.050892 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:45:24.051901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125DA986A0>]}
[0m13:45:24.052881 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:45:24.053876 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:45:24.054870 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:45:24.054870 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:45:24.055870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:45:24.055870 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:45:24.058893 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:45:24.059894 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:45:24.064910 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:45:24.065893 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.066889 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:45:24.066889 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.103374 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.103374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.104369 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:45:24.110010 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:45:24.114043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.114043 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:45:24.115021 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.118016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.119014 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:45:24.119014 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.120517 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:45:24.121522 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.121939 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:45:24.121939 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.121939 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:45:24.121939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:45:24.121939 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:45:24.121939 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.121939 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:45:24.121939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D5A3FA0>]}
[0m13:45:24.121939 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:45:24.131965 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:45:24.131965 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:45:24.133899 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:45:24.134907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:45:24.135412 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:45:24.138437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.139417 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:45:24.145417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.146417 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.147417 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:45:24.148418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.186217 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.186217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.187216 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:45:24.192234 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:45:24.195222 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.196221 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:45:24.196221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.198196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.198196 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:45:24.198196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.198196 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:45:24.198196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.198196 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:45:24.198196 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.206299 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:45:24.207299 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:45:24.207299 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:45:24.211288 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.212294 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:45:24.213295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125DA986A0>]}
[0m13:45:24.213295 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.08s]
[0m13:45:24.214315 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:45:24.215298 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:45:24.215298 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:45:24.216297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:45:24.216297 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:45:24.220845 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:45:24.221843 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:45:24.225846 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:45:24.226843 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.226843 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:45:24.226843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.253685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.253685 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.253685 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:45:24.263311 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:45:24.263311 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.263311 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:45:24.263311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.273339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.273339 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:45:24.273339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.273339 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:45:24.273339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.273339 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:45:24.273339 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.273339 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:45:24.273339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:45:24.273339 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:45:24.283997 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.283997 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:45:24.283997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260921E50>]}
[0m13:45:24.283997 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:45:24.283997 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:45:24.283997 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:45:24.290672 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:45:24.291678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:45:24.292685 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:45:24.295701 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:45:24.296679 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:45:24.301684 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:45:24.303702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.304681 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:45:24.304681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.334826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.334826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.340854 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:45:24.349355 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:45:24.352514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.352514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:45:24.352514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.352514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.352514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:45:24.352514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.352514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:45:24.352514 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.352514 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:45:24.362643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.362643 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:45:24.362643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:45:24.362643 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:45:24.362643 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.362643 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:45:24.362643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260DEB5B0>]}
[0m13:45:24.372694 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:45:24.372694 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:45:24.372694 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:45:24.374659 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:45:24.375665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:45:24.375665 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:45:24.378671 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.379688 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:45:24.384688 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.386667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.386667 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:45:24.387666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.421865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.421865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.421865 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:45:24.431910 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:45:24.434915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.434915 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:45:24.434915 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.434915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.434915 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:45:24.442645 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.442645 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:45:24.442645 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.442645 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:45:24.442645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.442645 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:45:24.442645 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:45:24.442645 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:45:24.452176 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.452176 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:45:24.452176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260CB2A60>]}
[0m13:45:24.452176 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.08s]
[0m13:45:24.452176 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:45:24.452176 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:45:24.459763 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:45:24.460770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:45:24.461771 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:45:24.468773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.470768 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:45:24.476797 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.478331 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.479336 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:45:24.479336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.514147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.514147 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.514937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:45:24.514937 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:45:24.514937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.524449 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:45:24.524449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.524449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.524449 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:45:24.524449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.524449 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:45:24.524449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.524449 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:45:24.524449 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.535018 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:45:24.535018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:45:24.535018 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:45:24.535018 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.535018 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:45:24.535018 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260DEE130>]}
[0m13:45:24.535018 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:45:24.535018 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:45:24.545413 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:45:24.545413 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:45:24.546420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:45:24.547420 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:45:24.550437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.551436 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:45:24.557436 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.558438 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.558438 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:45:24.559418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.595033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.595033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.595033 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month
  );
  
[0m13:45:24.605059 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:45:24.605059 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.605059 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:45:24.605059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.615231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.615231 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:45:24.615231 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.615231 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:45:24.615231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.615231 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:45:24.615231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.615231 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:45:24.615231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:45:24.615231 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:45:24.625295 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.625295 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:45:24.625295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212606D77F0>]}
[0m13:45:24.625295 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:45:24.625295 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:45:24.625295 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:45:24.625295 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:45:24.631808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:45:24.632816 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:45:24.638344 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.642333 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:45:24.652601 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.654600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.655599 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:45:24.655599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.688339 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.688339 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.688339 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month
  );
  
[0m13:45:24.708473 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:45:24.709001 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.709001 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:45:24.709001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.709001 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.709001 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:45:24.709001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.709001 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:45:24.709001 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.709001 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:45:24.719026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.719026 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:45:24.719026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:45:24.719026 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:45:24.719026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.729070 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:45:24.729070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260E501F0>]}
[0m13:45:24.729070 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.10s]
[0m13:45:24.729070 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:45:24.729070 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:45:24.732771 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:45:24.733785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:45:24.735297 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:45:24.738324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.738324 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:45:24.743308 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.745309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.746335 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:45:24.747301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.781736 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.781736 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.781736 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month desc
  );
  
[0m13:45:24.791777 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:45:24.791777 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.791777 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:45:24.791777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.791777 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.791777 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:45:24.791777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:24.801762 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:45:24.801762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.801762 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:45:24.801762 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:24.801762 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:45:24.801762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:45:24.801762 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:45:24.801762 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:24.811904 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:45:24.811904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260E4AE80>]}
[0m13:45:24.811904 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:45:24.811904 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:45:24.811904 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:45:24.815300 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:45:24.816306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:45:24.816306 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:45:24.819311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:45:24.820328 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:45:24.825895 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:45:24.826893 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:45:24.826893 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:45:24.826893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:24.970655 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:24.970655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:45:24.970655 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    TO_CHAR(month, 'Month'),
    total_gross_revenue
from employee_ranked
where rank = 1
  );
  
[0m13:45:24.970655 [debug] [Thread-1  ]: Postgres adapter: Postgres error: "." is not a number

[0m13:45:24.970655 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: ROLLBACK
[0m13:45:24.970655 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:45:24.985161 [debug] [Thread-1  ]: Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  "." is not a number
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:45:24.985161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260E8A370>]}
[0m13:45:24.985161 [error] [Thread-1  ]: 11 of 13 ERROR creating sql table model public.datamart_monthly_best_employee .. [[31mERROR[0m in 0.17s]
[0m13:45:24.985161 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:45:24.985161 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:45:24.991969 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:45:24.992975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:45:24.992975 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:45:24.995980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:24.996999 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:45:25.000998 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.002005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.002983 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:45:25.002983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:25.031632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:25.035642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.035642 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
  );
  
[0m13:45:25.035642 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:45:25.035642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.035642 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:45:25.035642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:25.047647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.047647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:45:25.047647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:25.047647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:45:25.047647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.047647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:45:25.047647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:25.047647 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:45:25.047647 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:45:25.047647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:45:25.047647 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:25.047647 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:45:25.047647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260E8ABE0>]}
[0m13:45:25.047647 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.06s]
[0m13:45:25.047647 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:45:25.047647 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:45:25.063403 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:45:25.063403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:45:25.064340 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:45:25.067337 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.068338 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:45:25.072337 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.072337 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.073855 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:45:25.073855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:25.108024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:45:25.108024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.108024 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:45:25.108024 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:45:25.108024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.108024 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:45:25.108024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:25.108024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.123700 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:45:25.124309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:45:25.124309 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:45:25.124309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.124309 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:45:25.124309 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:45:25.124309 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:45:25.124309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:45:25.124309 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:45:25.124309 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:45:25.134320 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:45:25.134320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0db91f-cf39-444f-9357-f3c4aacaac14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260DF90D0>]}
[0m13:45:25.135835 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.07s]
[0m13:45:25.135835 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:45:25.137931 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.138938 [debug] [MainThread]: On master: BEGIN
[0m13:45:25.138938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:25.176944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:45:25.176944 [debug] [MainThread]: On master: COMMIT
[0m13:45:25.177960 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:25.177960 [debug] [MainThread]: On master: COMMIT
[0m13:45:25.178945 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:45:25.178945 [debug] [MainThread]: On master: Close
[0m13:45:25.178945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:25.178945 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:45:25.180458 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:45:25.180458 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:45:25.180458 [info ] [MainThread]: 
[0m13:45:25.181472 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m13:45:25.184245 [debug] [MainThread]: Command end result
[0m13:45:25.212256 [info ] [MainThread]: 
[0m13:45:25.213274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:25.214257 [info ] [MainThread]: 
[0m13:45:25.215335 [error] [MainThread]:   Database Error in model datamart_monthly_best_employee (models\marts\datamart_monthly_best_employee.sql)
  "." is not a number
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_best_employee.sql
[0m13:45:25.217254 [info ] [MainThread]: 
[0m13:45:25.217254 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:45:25.219261 [debug] [MainThread]: Command `dbt run` failed at 13:45:25.219261 after 2.45 seconds
[0m13:45:25.219261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D6D1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021260E1FF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002125D5DB370>]}
[0m13:45:25.220262 [debug] [MainThread]: Flushing usage events
[0m13:47:08.574225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADEC2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FAE807AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB0928D00>]}


============================== 13:47:08.574225 | f59ab0ab-a6b6-4701-b748-cedb4a40e121 ==============================
[0m13:47:08.574225 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:47:08.579838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:08.628621 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:47:08.628621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADD91160>]}
[0m13:47:08.628621 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:47:08.643664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADD91190>]}
[0m13:47:08.738988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FAE8331F0>]}
[0m13:47:08.787160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB091C730>]}
[0m13:47:08.787160 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:47:08.798726 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:47:08.950591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:47:08.951650 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_employee_revenue.sql
[0m13:47:08.952212 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_category_sales.sql
[0m13:47:08.952212 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\intermediate\int_monthly_supplier_revenue.sql
[0m13:47:08.952773 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_best_employee.sql
[0m13:47:08.953334 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_category_sold.sql
[0m13:47:09.124501 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:47:09.152644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB107E130>]}
[0m13:47:09.232465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB103A8E0>]}
[0m13:47:09.232465 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:47:09.232465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADE40160>]}
[0m13:47:09.246143 [info ] [MainThread]: 
[0m13:47:09.248171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:47:09.253156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:47:09.302268 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:47:09.302268 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:47:09.302268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:09.349384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:47:09.349384 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:47:09.349384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:47:09.349384 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:47:09.349384 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:47:09.349384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:09.381275 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.381275 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:47:09.381275 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:47:09.396288 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:47:09.397322 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:47:09.397322 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:47:09.397322 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.397322 [debug] [MainThread]: On master: BEGIN
[0m13:47:09.397322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:09.538283 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.553985 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.553985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:47:09.553985 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:47:09.553985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB103A970>]}
[0m13:47:09.553985 [debug] [MainThread]: On master: ROLLBACK
[0m13:47:09.553985 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.553985 [debug] [MainThread]: On master: BEGIN
[0m13:47:09.553985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.553985 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.553985 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:09.553985 [debug] [MainThread]: On master: COMMIT
[0m13:47:09.553985 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.553985 [debug] [MainThread]: On master: Close
[0m13:47:09.569792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:09.569792 [info ] [MainThread]: 
[0m13:47:09.574961 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:47:09.575948 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:47:09.576948 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:47:09.576948 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:47:09.585389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:47:09.585918 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:47:09.620932 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:47:09.622060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.622060 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:47:09.622060 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:47:09.649555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.649555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.649555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:47:09.649555 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:47:09.697834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.697834 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:47:09.697834 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.712970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.712970 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:47:09.712970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.728554 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:47:09.728554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.728554 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:47:09.728554 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.728554 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:47:09.728554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:47:09.728554 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:47:09.744209 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:09.744209 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:47:09.744209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB14EA5E0>]}
[0m13:47:09.744209 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:47:09.744209 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:47:09.744209 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:47:09.753027 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:47:09.754041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:47:09.754041 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:47:09.757038 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:47:09.758055 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:47:09.762041 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:47:09.764039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.764039 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:47:09.764039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:09.796581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.796581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.798108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:47:09.802959 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:47:09.802959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.802959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:47:09.802959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.802959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.802959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:47:09.802959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.802959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:47:09.802959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.802959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:47:09.802959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.802959 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:47:09.802959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:47:09.818657 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:47:09.819394 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:09.819394 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:47:09.819394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB159B280>]}
[0m13:47:09.819394 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:47:09.819394 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:47:09.819394 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:47:09.819394 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:47:09.827134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:47:09.828150 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:47:09.831727 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.832748 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:47:09.836744 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.837720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.838726 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:47:09.838726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:09.864749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:09.864749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.864749 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:47:09.864749 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:47:09.864749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.864749 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:47:09.864749 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.880640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.880640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:47:09.880640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:09.880640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:47:09.880640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.880640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:47:09.880640 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:09.880640 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:47:09.880640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:47:09.880640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:47:09.890653 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:09.890653 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:47:09.890653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB14F2760>]}
[0m13:47:09.890653 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:47:09.896180 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:47:09.896863 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:47:09.896863 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:47:09.898004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:47:09.899017 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:47:09.903037 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:47:09.904037 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:47:09.909033 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:47:09.910038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:09.910038 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:47:09.911037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.042961 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.042961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:10.042961 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:47:10.058707 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:47:10.058707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:10.058707 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:47:10.058707 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.058707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:10.058707 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:47:10.058707 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.068727 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:47:10.068727 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:10.068727 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:47:10.068727 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.068727 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:47:10.068727 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:47:10.068727 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:47:10.074310 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.074310 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:47:10.074310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB15CED90>]}
[0m13:47:10.074310 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.18s]
[0m13:47:10.074310 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:47:10.074310 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:47:10.074310 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:47:10.081997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:47:10.083014 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:47:10.086047 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:47:10.087045 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:47:10.091024 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:47:10.092042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.092042 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:47:10.093047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.122619 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.122619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.122619 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:47:10.122619 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:47:10.122619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.122619 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:47:10.122619 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.139044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.139044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:47:10.139044 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.139044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:47:10.139044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.139044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:47:10.139044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.139044 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:47:10.139044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:47:10.139044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:47:10.139044 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.139044 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:47:10.154083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB15EB1F0>]}
[0m13:47:10.154083 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.06s]
[0m13:47:10.154083 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:47:10.154083 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:47:10.156870 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:47:10.157884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:47:10.157884 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:47:10.160880 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.161900 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:47:10.165883 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.166911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.167874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:47:10.167874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.202563 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.203564 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.203564 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:47:10.205630 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:47:10.205630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.205630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:47:10.205630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.205630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.205630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:47:10.205630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.205630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:47:10.205630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.205630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:47:10.205630 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.221358 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:47:10.221358 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:47:10.221358 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:47:10.221358 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.221358 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:47:10.221358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB148B400>]}
[0m13:47:10.221358 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:47:10.221358 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:47:10.221358 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:47:10.230774 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:47:10.230774 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:47:10.231779 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:47:10.235809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.237422 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:47:10.241459 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.242440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.242440 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:47:10.243437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.278481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.279473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.279473 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:47:10.285491 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:47:10.288557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.288557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:47:10.288557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.288557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.288557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:47:10.288557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.288557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:47:10.288557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.288557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:47:10.288557 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.298061 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:47:10.298061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:47:10.298061 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:47:10.298061 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.304566 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:47:10.304566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FAFEBA580>]}
[0m13:47:10.304566 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:47:10.304566 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:47:10.304566 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:47:10.308362 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:47:10.309380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:47:10.310378 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:47:10.313381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.314381 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:47:10.318388 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.319389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.320647 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:47:10.320647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.470665 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.470665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.470665 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:47:10.480674 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:47:10.486910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.486910 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:47:10.486910 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.486910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.486910 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:47:10.486910 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.486910 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:47:10.486910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.486910 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:47:10.486910 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.498437 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:47:10.498437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:47:10.498437 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:47:10.501946 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.501946 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:47:10.501946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB14EA040>]}
[0m13:47:10.501946 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.19s]
[0m13:47:10.501946 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:47:10.501946 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:47:10.509394 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:47:10.510399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:47:10.511072 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:47:10.511072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.511072 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:47:10.519580 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.521084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.521084 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:47:10.522114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.556553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.557687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.557687 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:47:10.568263 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:47:10.568263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.568263 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:47:10.568263 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.568263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.568263 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:47:10.568263 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.568263 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:47:10.582792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.582792 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:47:10.582792 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.582792 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:47:10.582792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:47:10.582792 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:47:10.582792 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.582792 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:47:10.582792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB1650220>]}
[0m13:47:10.582792 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.07s]
[0m13:47:10.582792 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:47:10.582792 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:47:10.597831 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:47:10.598346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:47:10.599353 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:47:10.603362 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.604352 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:47:10.609002 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.611241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.611241 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:47:10.611241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.642999 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.642999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.642999 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:47:10.659336 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:47:10.659336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.659336 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:47:10.659336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.659336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.659336 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:47:10.659336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.668881 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:47:10.668881 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.668881 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:47:10.668881 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.668881 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:47:10.674481 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:47:10.674481 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:47:10.674481 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.674481 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:47:10.674481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB164A070>]}
[0m13:47:10.674481 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:47:10.674481 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:47:10.674481 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:47:10.682894 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:47:10.683899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:47:10.683899 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:47:10.687925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.687925 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:47:10.693333 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.695495 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.696069 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:47:10.697245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.829556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.844630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.844630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:47:10.844630 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:47:10.844630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.844630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:47:10.844630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.860955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.860955 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:47:10.860955 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.860955 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:47:10.860955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.860955 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:47:10.860955 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.860955 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:47:10.860955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:47:10.870493 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:47:10.870493 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.870493 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:47:10.870493 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADD85430>]}
[0m13:47:10.876000 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.19s]
[0m13:47:10.876000 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:47:10.876000 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:47:10.876000 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:47:10.879141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:47:10.880159 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:47:10.883177 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.884216 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:47:10.888192 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.890214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.890214 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:47:10.891187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:10.921308 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:10.921308 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.921308 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:47:10.921308 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:47:10.936945 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.936945 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:47:10.938628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.938628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.938628 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:47:10.938628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:10.943244 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:47:10.943244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.943244 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:47:10.943244 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:10.943244 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:47:10.943244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:47:10.943244 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:47:10.952749 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:10.952749 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:47:10.952749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB163DE50>]}
[0m13:47:10.952749 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:47:10.952749 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:47:10.958646 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:47:10.958646 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:47:10.959653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:47:10.959653 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:47:10.963658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:10.964672 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:47:10.969657 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:10.971653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:10.971653 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:47:10.972663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:47:11.003607 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:47:11.003607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:11.003607 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
  );
  
[0m13:47:11.003607 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:47:11.019455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:11.019455 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:47:11.019455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:11.019455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:11.019455 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:47:11.019455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:47:11.019455 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:47:11.029468 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:11.029468 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:47:11.029468 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:47:11.029468 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:47:11.029468 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:47:11.029468 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:47:11.035666 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:47:11.035666 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:47:11.035666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f59ab0ab-a6b6-4701-b748-cedb4a40e121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB1642460>]}
[0m13:47:11.035666 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.08s]
[0m13:47:11.035666 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:47:11.043145 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:11.044152 [debug] [MainThread]: On master: BEGIN
[0m13:47:11.044152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:47:11.079594 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:47:11.079594 [debug] [MainThread]: On master: COMMIT
[0m13:47:11.080592 [debug] [MainThread]: Using postgres connection "master"
[0m13:47:11.080592 [debug] [MainThread]: On master: COMMIT
[0m13:47:11.080592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:47:11.081594 [debug] [MainThread]: On master: Close
[0m13:47:11.082595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:11.082595 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:47:11.082595 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:47:11.083593 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:47:11.083593 [info ] [MainThread]: 
[0m13:47:11.084608 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m13:47:11.086607 [debug] [MainThread]: Command end result
[0m13:47:11.116721 [info ] [MainThread]: 
[0m13:47:11.117723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:11.118228 [info ] [MainThread]: 
[0m13:47:11.119234 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:47:11.120234 [debug] [MainThread]: Command `dbt run` succeeded at 13:47:11.120234 after 2.59 seconds
[0m13:47:11.120234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FADEC2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FAE3B8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FB0761DF0>]}
[0m13:47:11.121233 [debug] [MainThread]: Flushing usage events
[0m13:49:10.936897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D941ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DBE73CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DBE733A0>]}


============================== 13:49:10.954532 | 97cf5647-ea6e-4030-9044-2621d28e3017 ==============================
[0m13:49:10.954532 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:49:10.954532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:11.018618 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:49:11.018618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D92F31C0>]}
[0m13:49:11.018618 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:49:11.023070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D92F31F0>]}
[0m13:49:11.133069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D9D9A850>]}
[0m13:49:11.179654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DBD4A070>]}
[0m13:49:11.181651 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:49:11.189648 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:49:11.331613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:11.332614 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:49:11.514030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:49:11.532431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC5D6F10>]}
[0m13:49:11.624191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC5BCBE0>]}
[0m13:49:11.624191 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:49:11.624191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC5E7070>]}
[0m13:49:11.630443 [info ] [MainThread]: 
[0m13:49:11.631415 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:11.636423 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:49:11.694516 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:49:11.695088 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:49:11.695708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:11.740483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:49:11.740483 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:49:11.740483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:49:11.740483 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:49:11.740483 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:49:11.740483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:11.772293 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:49:11.772293 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:49:11.772293 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:11.772293 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:49:11.787948 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:49:11.787948 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:49:11.787948 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:11.787948 [debug] [MainThread]: On master: BEGIN
[0m13:49:11.787948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:11.826999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:11.827977 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:11.827977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:11.830026 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:49:11.830026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D9124B80>]}
[0m13:49:11.830026 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:11.830026 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:11.830026 [debug] [MainThread]: On master: BEGIN
[0m13:49:11.830026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:11.830026 [debug] [MainThread]: On master: COMMIT
[0m13:49:11.830026 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:11.830026 [debug] [MainThread]: On master: COMMIT
[0m13:49:11.830026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:49:11.830026 [debug] [MainThread]: On master: Close
[0m13:49:11.830026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:11.844635 [info ] [MainThread]: 
[0m13:49:11.847774 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:49:11.848776 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:49:11.849775 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:49:11.849775 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:49:11.858304 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:49:11.859306 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:49:11.895352 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:49:11.896313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:11.896313 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:49:11.896313 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:49:11.925139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:11.925139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:11.925139 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:49:11.930651 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:49:11.930651 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:11.930651 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:49:11.930651 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:11.978258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:11.978258 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:49:11.978258 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:11.993981 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:49:11.993981 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:11.993981 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:49:11.993981 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.009749 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:49:12.009749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:12.009749 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:49:12.019837 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.019837 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:49:12.019837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC9F5640>]}
[0m13:49:12.019837 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:49:12.025348 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:49:12.026573 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:49:12.026573 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:49:12.028585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:49:12.028585 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:49:12.033589 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:49:12.034587 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:49:12.041599 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:49:12.042601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.043615 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:49:12.043615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.073274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.073274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.073274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:49:12.073274 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:49:12.073274 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.073274 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:49:12.073274 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.089642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.089642 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:49:12.089642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.089642 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:49:12.089642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.089642 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:49:12.089642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.089642 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:49:12.089642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:12.089642 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:49:12.089642 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.104677 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:49:12.104677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCA02640>]}
[0m13:49:12.104677 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.08s]
[0m13:49:12.104677 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:49:12.104677 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:49:12.108527 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:49:12.109531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:49:12.109531 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:49:12.112532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.113554 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:49:12.117626 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.119788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.119788 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:49:12.120628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.154285 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.154285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.154285 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:49:12.159824 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:49:12.162848 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.163819 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:49:12.164959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.167829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.167829 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:49:12.168827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.170830 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:49:12.170830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.170830 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:49:12.172825 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.175353 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:49:12.175353 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:12.176381 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:49:12.180203 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.181194 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:49:12.182202 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCA026D0>]}
[0m13:49:12.182202 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:49:12.183219 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:49:12.184194 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:49:12.184194 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:49:12.185195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:49:12.185195 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:49:12.188223 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:49:12.189219 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:49:12.195221 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:49:12.196203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.196203 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:49:12.197203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.229064 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.230076 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.230076 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:49:12.236765 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:49:12.240772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.240772 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:49:12.241776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.244785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.244785 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:49:12.245786 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.247806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:49:12.247806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.248783 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:49:12.249933 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.251938 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:49:12.252938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:12.252938 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:49:12.256668 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.257682 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:49:12.258698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC5F64F0>]}
[0m13:49:12.258698 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:49:12.260674 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:49:12.260674 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:49:12.261675 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:49:12.262674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:49:12.262674 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:49:12.265703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:49:12.266696 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:49:12.270190 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:49:12.271202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.271202 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:49:12.272203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.425718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.425718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.425718 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:49:12.425718 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:49:12.425718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.425718 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:49:12.425718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.425718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.441373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:49:12.441373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.441373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:49:12.441373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.441373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:49:12.441373 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.441373 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:49:12.441373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:12.441373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:49:12.441373 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.441373 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:49:12.441373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC425700>]}
[0m13:49:12.441373 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.18s]
[0m13:49:12.456388 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:49:12.456388 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:49:12.457498 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:49:12.458500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:49:12.458500 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:49:12.462522 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.462522 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:49:12.466522 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.468054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.468054 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:49:12.469068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.615203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.615203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.615203 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:49:12.615203 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:49:12.625231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.625231 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:49:12.625231 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.625231 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.625231 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:49:12.630740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.630740 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:49:12.630740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.630740 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:49:12.630740 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.630740 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:49:12.630740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:12.630740 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:49:12.630740 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.630740 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:49:12.630740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC40A1F0>]}
[0m13:49:12.630740 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.17s]
[0m13:49:12.630740 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:49:12.630740 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:49:12.645565 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:49:12.646570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:49:12.646570 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:49:12.649570 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.650588 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:49:12.656579 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.657116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.658122 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:49:12.658122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.805605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.805605 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.806606 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:49:12.813151 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:49:12.816158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.816158 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:49:12.817179 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.820184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.821174 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:49:12.821174 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.823154 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:49:12.824153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.824153 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:49:12.825151 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.827151 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:49:12.828655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:12.828655 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:49:12.831544 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.832550 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:49:12.833550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC5FE730>]}
[0m13:49:12.834549 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.19s]
[0m13:49:12.835558 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:49:12.835558 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:12.836562 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:49:12.837561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:49:12.837561 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:12.840558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.841560 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:12.845733 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.846732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.847741 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:49:12.847741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.882072 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.882072 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.883069 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:49:12.893822 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:49:12.897797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.897797 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:49:12.898797 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.902804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.902804 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:49:12.903804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.905800 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:49:12.905800 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.906799 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:49:12.907935 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.910660 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:49:12.910660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:12.911688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:49:12.913517 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.913517 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:49:12.913517 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCB6F190>]}
[0m13:49:12.913517 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:49:12.913517 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:12.913517 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:12.913517 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:49:12.913517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:49:12.920093 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:12.922643 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.923666 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:12.927642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.928643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.929635 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:49:12.929635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:12.962449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:12.962449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.962449 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:49:12.969963 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:49:12.977992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.977992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:49:12.977992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.977992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.977992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:49:12.977992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:12.977992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:49:12.977992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.977992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:49:12.977992 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:12.977992 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:49:12.977992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:12.977992 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:49:12.993672 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:12.993672 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:49:12.993672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC9F52E0>]}
[0m13:49:12.993672 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:49:12.993672 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:12.993672 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:12.999129 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:49:13.000156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:49:13.001146 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:13.005148 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.006144 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:13.012145 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.014149 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.015153 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:49:13.016145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:13.045187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:13.045187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.045187 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:49:13.060880 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:49:13.060880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.060880 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:49:13.066889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.066889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.066889 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:49:13.066889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.066889 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:49:13.066889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.066889 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:49:13.066889 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:13.066889 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:49:13.076962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:13.076962 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:49:13.076962 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:13.076962 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:49:13.076962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC676CD0>]}
[0m13:49:13.076962 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:49:13.076962 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:13.076962 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:13.085336 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:49:13.086356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:49:13.086356 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:13.090422 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.091363 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:13.097395 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.098410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.099428 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:49:13.099428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:13.137012 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:13.137012 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.138013 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:49:13.145038 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:49:13.150027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.150027 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:49:13.151107 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.154034 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.154034 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:49:13.155032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.157532 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:49:13.157532 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.157532 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:49:13.159399 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:13.161444 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:49:13.162430 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:13.162430 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:49:13.165800 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:13.166827 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:49:13.167834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCBB0670>]}
[0m13:49:13.168801 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.08s]
[0m13:49:13.169803 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:13.170801 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:13.170801 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:49:13.171801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:49:13.172801 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:13.175809 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.177064 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:13.181550 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.182571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.182571 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:49:13.183567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:13.211896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:13.211896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.211896 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:49:13.211896 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:49:13.227630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.227630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:49:13.227630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.227630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.227630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:49:13.227630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.227630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:49:13.227630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.227630 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:49:13.237644 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:13.237644 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:49:13.237644 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:13.237644 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:49:13.243658 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:13.243658 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:49:13.243658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DC676CD0>]}
[0m13:49:13.243658 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:49:13.243658 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:13.243658 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:13.249899 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:49:13.250907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:49:13.250907 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:13.254906 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.255905 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:13.260489 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.262463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.262463 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:49:13.262463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:13.303736 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:13.303736 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.303736 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
order by month asc
  );
  
[0m13:49:13.319502 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:49:13.319502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.319502 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:49:13.329546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.329546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.329546 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:49:13.329546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:13.335854 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:49:13.335854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.335854 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:49:13.335854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:13.335854 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:49:13.335854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:13.335854 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:49:13.335854 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:13.335854 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:49:13.335854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97cf5647-ea6e-4030-9044-2621d28e3017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCBD74F0>]}
[0m13:49:13.335854 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.08s]
[0m13:49:13.335854 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:13.349640 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:13.349640 [debug] [MainThread]: On master: BEGIN
[0m13:49:13.350689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:13.383060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:13.384059 [debug] [MainThread]: On master: COMMIT
[0m13:49:13.384059 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:13.384059 [debug] [MainThread]: On master: COMMIT
[0m13:49:13.385053 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:49:13.385053 [debug] [MainThread]: On master: Close
[0m13:49:13.386053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:13.386053 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:49:13.386053 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:49:13.387054 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:49:13.387054 [info ] [MainThread]: 
[0m13:49:13.388061 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m13:49:13.390053 [debug] [MainThread]: Command end result
[0m13:49:13.419747 [info ] [MainThread]: 
[0m13:49:13.420744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:13.421720 [info ] [MainThread]: 
[0m13:49:13.421720 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:49:13.423230 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:13.423230 after 2.51 seconds
[0m13:49:13.424258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1D941ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DB9F4E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1DCB65FD0>]}
[0m13:49:13.424258 [debug] [MainThread]: Flushing usage events
[0m13:49:40.579453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC96DECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC147A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACA05A790>]}


============================== 13:49:40.579453 | e50d4a63-4b48-4d2c-8422-b2b252b58828 ==============================
[0m13:49:40.579453 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:49:40.579453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m13:49:40.644232 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:49:40.644232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC95B0190>]}
[0m13:49:40.649905 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:49:40.650914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC95B01C0>]}
[0m13:49:40.764467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC132D90>]}
[0m13:49:40.811529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC95C78E0>]}
[0m13:49:40.813516 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:49:40.821713 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:49:40.965300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:40.965414 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:49:41.136182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:49:41.149377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC896EE0>]}
[0m13:49:41.240316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC86E100>]}
[0m13:49:41.240316 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:49:41.240316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC87D850>]}
[0m13:49:41.250571 [info ] [MainThread]: 
[0m13:49:41.250571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:41.256574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:49:41.302787 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:49:41.302787 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:49:41.302787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:41.350397 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:49:41.350397 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:49:41.350397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:49:41.350397 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:49:41.350397 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:49:41.350397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:41.381143 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.381143 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:49:41.381143 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:41.397747 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:49:41.397747 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:49:41.397747 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:49:41.397747 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:41.397747 [debug] [MainThread]: On master: BEGIN
[0m13:49:41.397747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:41.556159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.556159 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:41.556159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:41.565670 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:49:41.565670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC86E5E0>]}
[0m13:49:41.565670 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:41.565670 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:41.565670 [debug] [MainThread]: On master: BEGIN
[0m13:49:41.565670 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.565670 [debug] [MainThread]: On master: COMMIT
[0m13:49:41.565670 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:41.565670 [debug] [MainThread]: On master: COMMIT
[0m13:49:41.565670 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:49:41.565670 [debug] [MainThread]: On master: Close
[0m13:49:41.565670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:41.571174 [info ] [MainThread]: 
[0m13:49:41.575834 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:49:41.576833 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:49:41.577191 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:49:41.577191 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:49:41.585232 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:49:41.586202 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:49:41.621740 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:49:41.622747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.622747 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:49:41.622747 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:49:41.644828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.644828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.644828 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:49:41.660496 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:49:41.660496 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.660496 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:49:41.670500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.708443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.708443 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:49:41.708443 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.724026 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:49:41.724026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.724026 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:49:41.724026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:41.724026 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:49:41.739665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:49:41.739665 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:49:41.739665 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:41.739665 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:49:41.739665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCF5610>]}
[0m13:49:41.739665 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:49:41.739665 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:49:41.739665 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:49:41.752163 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:49:41.752163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:49:41.753170 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:49:41.757168 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:49:41.758168 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:49:41.762168 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:49:41.763168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.764168 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:49:41.764168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:41.799138 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.800155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.800155 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:49:41.807153 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:49:41.810155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.810155 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:49:41.811154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.814155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.814155 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:49:41.815154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.816028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:49:41.816028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.816028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:49:41.816028 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:41.816028 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:49:41.816028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:49:41.816028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:49:41.816028 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:41.826043 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:49:41.826043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCF50D0>]}
[0m13:49:41.826043 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:49:41.826043 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:49:41.829935 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:49:41.829935 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:49:41.830973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:49:41.831942 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:49:41.833965 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.834964 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:49:41.838942 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.840940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.840940 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:49:41.840940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:41.874952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.875962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.875962 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:49:41.879959 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:49:41.879959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.879959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:49:41.879959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.879959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.879959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:49:41.879959 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.879959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:49:41.879959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.879959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:49:41.879959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:41.879959 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:49:41.895620 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:49:41.896126 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:49:41.896126 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:41.896126 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:49:41.896126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCDAB250>]}
[0m13:49:41.896126 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:49:41.896126 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:49:41.896126 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:49:41.904150 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:49:41.905168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:49:41.905168 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:49:41.909167 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:49:41.910169 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:49:41.915169 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:49:41.916170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.917170 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:49:41.917170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:41.967333 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:41.967333 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.967333 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:49:41.973425 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:49:41.973425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.973425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:49:41.973425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.973425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.973425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:49:41.973425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:41.973425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:49:41.973425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.973425 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:49:41.988938 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:41.988938 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:49:41.988938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:49:41.988938 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:49:41.988938 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:41.996454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:49:41.996454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCDAB280>]}
[0m13:49:41.996454 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.09s]
[0m13:49:41.996454 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:49:41.996454 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:49:42.000696 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:49:42.001703 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:49:42.001703 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:49:42.005709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:49:42.005709 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:49:42.010713 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:49:42.011709 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.011709 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:49:42.011709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.045516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.045516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.045516 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:49:42.045516 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:49:42.045516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.045516 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:49:42.045516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.045516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.045516 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:49:42.045516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.061292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:49:42.061292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.061292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:49:42.061292 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.061292 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:49:42.061292 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:49:42.061292 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:49:42.061292 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.071323 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:49:42.071323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCFF940>]}
[0m13:49:42.071323 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:49:42.071323 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:49:42.071323 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:49:42.075884 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:49:42.076891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:49:42.076891 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:49:42.080891 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.080891 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:49:42.084932 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.086905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.086905 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:49:42.087923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.121876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.121876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.121876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:49:42.121876 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:49:42.121876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.121876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:49:42.121876 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.121876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.121876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:49:42.137555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.137555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:49:42.137555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.137555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:49:42.137555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.137555 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:49:42.137555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:49:42.137555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:49:42.137555 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.137555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:49:42.137555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCFFCA0>]}
[0m13:49:42.137555 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:49:42.137555 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:49:42.137555 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:49:42.151716 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:49:42.152723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:49:42.152723 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:49:42.155722 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.156722 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:49:42.162722 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.163723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.164725 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:49:42.164725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.198524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.199549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.199549 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:49:42.204531 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:49:42.205621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.205621 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:49:42.205621 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.205621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.205621 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:49:42.205621 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.205621 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:49:42.215223 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.215223 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:49:42.216703 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.218709 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:49:42.219708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:49:42.219708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:49:42.222710 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.223708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:49:42.223708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCDA5A60>]}
[0m13:49:42.225215 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:49:42.225847 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:49:42.225847 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:42.225847 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:49:42.225847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:49:42.225847 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:42.225847 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.225847 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:42.237735 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.238739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.239664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:49:42.239664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.275249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.275249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.275249 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:49:42.275249 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:49:42.275249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.275249 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:49:42.275249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.290885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.290885 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:49:42.290885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.296393 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:49:42.296393 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.296393 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:49:42.296393 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.296393 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:49:42.296393 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:49:42.296393 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:49:42.296393 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.296393 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:49:42.307112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCE2B160>]}
[0m13:49:42.307112 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m13:49:42.307112 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:49:42.307112 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:42.310301 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:49:42.311317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:49:42.311317 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:42.315320 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.315320 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:42.319854 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.320857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.321856 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:49:42.321856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.355351 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.356376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.356376 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:49:42.358424 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:49:42.358424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.358424 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:49:42.358424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.374216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.374216 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:49:42.374216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.374216 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:49:42.374216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.374216 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:49:42.374216 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.374216 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:49:42.374216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:49:42.374216 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:49:42.384222 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.384222 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:49:42.384222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC6E4730>]}
[0m13:49:42.384222 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.07s]
[0m13:49:42.390414 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:49:42.390414 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:42.391417 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:49:42.392423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:49:42.392423 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:42.397095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.398123 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:42.402130 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.403108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.404099 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:49:42.404099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.438624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.439653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.439653 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:49:42.447820 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:49:42.447820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.447820 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:49:42.447820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.447820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.447820 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:49:42.447820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.447820 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:49:42.447820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.447820 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:49:42.447820 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.463742 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:49:42.463742 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:49:42.463742 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:49:42.463742 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.463742 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:49:42.463742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCE19C40>]}
[0m13:49:42.463742 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m13:49:42.463742 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:49:42.463742 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:42.473206 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:49:42.474234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:49:42.474234 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:42.478240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.479263 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:42.483283 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.484298 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.485282 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:49:42.485282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.520316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.520316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.521345 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:49:42.524423 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:49:42.524423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.524423 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:49:42.524423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.524423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.524423 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:49:42.524423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.524423 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:49:42.524423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.524423 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:49:42.524423 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.540077 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:49:42.540077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:49:42.540077 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:49:42.540077 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.540077 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:49:42.540077 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCDB310>]}
[0m13:49:42.540077 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.07s]
[0m13:49:42.540077 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:49:42.540077 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:42.550813 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:49:42.551834 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:49:42.552536 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:42.552536 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.552536 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:42.560001 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.561996 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.561996 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:49:42.563031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.597098 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.598128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.598128 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:49:42.604751 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:49:42.607817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.607817 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:49:42.607817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.607817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.607817 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:49:42.607817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:49:42.607817 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:49:42.607817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.607817 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:49:42.607817 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.607817 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:49:42.607817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:49:42.607817 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:49:42.623575 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:49:42.623575 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:49:42.623575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACCCDB310>]}
[0m13:49:42.623575 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:49:42.623575 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:49:42.623575 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:42.629032 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:49:42.630042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:49:42.631044 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:42.634600 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:42.635604 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:42.639630 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:42.640637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:42.641613 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:49:42.641613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:42.671609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.671609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:49:42.671609 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
group by supplier_name
order by month asc
  );
  
[0m13:49:42.671609 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15:     imsr.month,
             ^

[0m13:49:42.671609 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m13:49:42.671609 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:49:42.678624 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     imsr.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:49:42.678624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e50d4a63-4b48-4d2c-8422-b2b252b58828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC86EEB0>]}
[0m13:49:42.678624 [error] [Thread-1  ]: 13 of 13 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m13:49:42.678624 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:49:42.683145 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:42.684151 [debug] [MainThread]: On master: BEGIN
[0m13:49:42.684151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:42.717595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:49:42.717595 [debug] [MainThread]: On master: COMMIT
[0m13:49:42.718568 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:42.718568 [debug] [MainThread]: On master: COMMIT
[0m13:49:42.718568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:49:42.719568 [debug] [MainThread]: On master: Close
[0m13:49:42.719568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:42.720568 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:49:42.720568 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:49:42.720568 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:49:42.721576 [info ] [MainThread]: 
[0m13:49:42.721576 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m13:49:42.723580 [debug] [MainThread]: Command end result
[0m13:49:42.753773 [info ] [MainThread]: 
[0m13:49:42.755037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:49:42.755037 [info ] [MainThread]: 
[0m13:49:42.756052 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     imsr.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:49:42.757064 [info ] [MainThread]: 
[0m13:49:42.757064 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:49:42.759068 [debug] [MainThread]: Command `dbt run` failed at 13:49:42.758049 after 2.22 seconds
[0m13:49:42.759068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC96DECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC757A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ACC936850>]}
[0m13:49:42.759068 [debug] [MainThread]: Flushing usage events
[0m13:50:55.326091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C12ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5EB82CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5EB823A0>]}


============================== 13:50:55.326091 | 8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b ==============================
[0m13:50:55.326091 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:50:55.326091 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'profiles_dir': './', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:55.392204 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:50:55.392204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C0031C0>]}
[0m13:50:55.396165 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:50:55.397170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C0031F0>]}
[0m13:50:55.510246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5CAAA850>]}
[0m13:50:55.556602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5EA5A070>]}
[0m13:50:55.558574 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:50:55.565003 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:50:55.705006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:55.705006 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:50:55.875811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:50:55.895015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F2E7F10>]}
[0m13:50:55.974614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F2CEBE0>]}
[0m13:50:55.974614 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:50:55.974614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F2F7070>]}
[0m13:50:55.988643 [info ] [MainThread]: 
[0m13:50:55.989659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:55.995663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:50:56.046947 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:50:56.046947 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:50:56.046947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:56.093989 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:50:56.093989 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:50:56.093989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:50:56.093989 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:50:56.093989 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:50:56.093989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:56.124759 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.124759 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:50:56.124759 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:56.124759 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:50:56.140396 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:50:56.140396 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:50:56.140396 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:56.140396 [debug] [MainThread]: On master: BEGIN
[0m13:50:56.140396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:56.297707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.297707 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:56.297707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:56.297707 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:50:56.297707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F158A30>]}
[0m13:50:56.297707 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:56.297707 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:56.297707 [debug] [MainThread]: On master: BEGIN
[0m13:50:56.297707 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.297707 [debug] [MainThread]: On master: COMMIT
[0m13:50:56.297707 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:56.313509 [debug] [MainThread]: On master: COMMIT
[0m13:50:56.313509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.313509 [debug] [MainThread]: On master: Close
[0m13:50:56.313509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:56.313509 [info ] [MainThread]: 
[0m13:50:56.319168 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:50:56.320153 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:50:56.321153 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:50:56.321153 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:50:56.329273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:50:56.330252 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:50:56.366678 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:50:56.367679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.368655 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:50:56.368655 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:50:56.398528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.399108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.399108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:50:56.399108 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:50:56.399108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.399108 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:50:56.399108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.446509 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.446509 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:50:56.446509 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.462400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:50:56.462400 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.462400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:50:56.472485 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.478087 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:50:56.478087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:50:56.478087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:50:56.478087 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.478087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:50:56.478087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F742640>]}
[0m13:50:56.478087 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:50:56.478087 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:50:56.478087 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:50:56.492201 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:50:56.493207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:50:56.493207 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:50:56.496311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:50:56.497362 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:50:56.501383 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:50:56.502384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.502384 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:50:56.503366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.537170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.537170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.538103 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:50:56.543444 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:50:56.546484 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.547472 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:50:56.547472 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.550472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.550472 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:50:56.551449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.552179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:50:56.552179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.552179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:50:56.552179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.552179 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:50:56.552179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:50:56.552179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:50:56.552179 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.552179 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:50:56.552179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F309CD0>]}
[0m13:50:56.552179 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m13:50:56.552179 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:50:56.552179 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:50:56.567748 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:50:56.568753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:50:56.568753 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:50:56.571775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.572889 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:50:56.577450 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.578480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.579462 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:50:56.579462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.612051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.612051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.613075 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:50:56.615139 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:50:56.615139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.615139 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:50:56.615139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.624685 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.624685 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:50:56.625697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.625697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:50:56.625697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.625697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:50:56.625697 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.630738 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:50:56.630738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:50:56.630738 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:50:56.630738 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.630738 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:50:56.630738 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F385280>]}
[0m13:50:56.630738 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m13:50:56.630738 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:50:56.630738 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:50:56.640659 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:50:56.641676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:50:56.641676 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:50:56.644673 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:50:56.645690 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:50:56.650675 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:50:56.651692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.652674 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:50:56.652674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.688212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.689230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.689230 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:50:56.696493 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:50:56.699918 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.700482 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:50:56.701043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.703782 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.704334 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:50:56.704880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.706546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:50:56.706546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.706546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:50:56.706546 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.706546 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:50:56.706546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:50:56.706546 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:50:56.714697 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.714697 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:50:56.714697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F7F32E0>]}
[0m13:50:56.714697 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:50:56.714697 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:50:56.714697 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:50:56.719763 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:50:56.720769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:50:56.720769 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:50:56.723775 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:50:56.724791 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:50:56.728709 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:50:56.730707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.731708 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:50:56.731708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.770806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.770806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.770806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:50:56.777675 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:50:56.777675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.777675 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:50:56.777675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.777675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.777675 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:50:56.777675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.792760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:50:56.792760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.792760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:50:56.792760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.792760 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:50:56.792760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:50:56.792760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:50:56.792760 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.792760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:50:56.792760 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F7F32B0>]}
[0m13:50:56.792760 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:50:56.792760 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:50:56.792760 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:50:56.792760 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:50:56.806555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:50:56.807560 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:50:56.812591 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.813578 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:50:56.819084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.820097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.820097 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:50:56.820097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:56.851710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:56.851710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.851710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:50:56.851710 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:50:56.851710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.851710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:50:56.851710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.851710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.851710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:50:56.867372 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:56.868167 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:50:56.868167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.868167 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:50:56.868167 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:56.868167 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:50:56.868167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:50:56.868167 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:50:56.868167 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:56.877695 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:50:56.877695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F133880>]}
[0m13:50:56.877695 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:50:56.877695 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:50:56.877695 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:50:56.881639 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:50:56.882646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:50:56.882646 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:50:56.886673 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:50:56.887644 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:50:56.892652 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:50:56.893644 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:56.893644 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:50:56.894655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.046406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.046406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:57.046406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:50:57.046406 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:50:57.046406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:57.046406 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:50:57.046406 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.062095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:57.062244 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:50:57.062244 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.062244 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:50:57.062244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:57.062244 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:50:57.062244 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.062244 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:50:57.062244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:50:57.062244 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:50:57.072317 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.072317 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:50:57.072317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5EF09A60>]}
[0m13:50:57.072317 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.19s]
[0m13:50:57.076836 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:50:57.076836 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:50:57.077849 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:50:57.078885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:50:57.079855 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:50:57.082842 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.083850 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:50:57.088293 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.089783 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.089783 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:50:57.090858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.226174 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.226174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.226174 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:50:57.240237 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:50:57.240237 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.240237 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:50:57.240237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.256085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.256085 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:50:57.256085 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.256085 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:50:57.256085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.256085 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:50:57.256085 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.256085 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:50:57.266176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:50:57.266176 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:50:57.266176 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.266176 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:50:57.266176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F87B070>]}
[0m13:50:57.271685 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.19s]
[0m13:50:57.272343 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:50:57.272343 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:50:57.274335 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:50:57.275343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:50:57.275343 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:50:57.279353 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.280347 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:50:57.284349 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.285352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.285352 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:50:57.286345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.422062 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.422062 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.422062 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:50:57.439290 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:50:57.443275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.443275 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:50:57.444266 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.448271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.448271 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:50:57.449273 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.451272 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:50:57.451272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.452277 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:50:57.453277 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.454818 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:50:57.454818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:50:57.454818 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:50:57.454818 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.454818 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:50:57.454818 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F87F1F0>]}
[0m13:50:57.454818 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.18s]
[0m13:50:57.454818 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:50:57.464113 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:50:57.465011 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:50:57.465558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:50:57.466101 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:50:57.471222 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.472861 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:50:57.480704 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.481715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.482716 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:50:57.483718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.522672 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.523193 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.523735 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:50:57.537393 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:50:57.540744 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.541313 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:50:57.541857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.545674 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.545674 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:50:57.546762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.548480 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:50:57.548994 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.549511 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:50:57.550611 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.553291 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:50:57.554383 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:50:57.554383 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:50:57.557148 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.559870 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:50:57.561950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F7F4E50>]}
[0m13:50:57.563016 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.10s]
[0m13:50:57.564653 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:50:57.565710 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:50:57.566776 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:50:57.568439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:50:57.568992 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:50:57.573323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.574924 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:50:57.581271 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.582939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.584021 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:50:57.584021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.626936 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.627479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.628019 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:50:57.635079 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:50:57.639636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.640635 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:50:57.641637 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.644657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.644657 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:50:57.645655 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.647627 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:50:57.647627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.648636 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:50:57.649627 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.652634 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:50:57.652634 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:50:57.653635 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:50:57.656635 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.657657 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:50:57.657657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F7EC760>]}
[0m13:50:57.658635 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.09s]
[0m13:50:57.659635 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:50:57.659635 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:50:57.660635 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:50:57.661639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:50:57.661639 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:50:57.664656 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.665662 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:50:57.669637 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.671627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.671627 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:50:57.672628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.805963 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.806969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.806969 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:50:57.815220 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:50:57.815969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.815969 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:50:57.815969 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.822907 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.822907 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:50:57.824433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:50:57.825451 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:50:57.826970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.826970 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:50:57.827976 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.830865 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:50:57.831880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:50:57.832881 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:50:57.834996 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:50:57.836936 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:50:57.836936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F8ED3A0>]}
[0m13:50:57.836936 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.18s]
[0m13:50:57.836936 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:50:57.836936 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:50:57.836936 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:50:57.836936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:50:57.836936 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:50:57.843802 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:50:57.844824 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:50:57.848832 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:50:57.849835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:50:57.850808 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:50:57.850808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:57.886345 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.886345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:50:57.887361 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
group by supplier_name,
  );
  
[0m13:50:57.888342 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 21:   );
           ^

[0m13:50:57.888342 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m13:50:57.888342 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:50:57.891345 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  syntax error at or near ")"
  LINE 21:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:50:57.892343 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e28cb75-8a94-4219-b1cf-4c73c3ca5d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5F130AF0>]}
[0m13:50:57.892343 [error] [Thread-1  ]: 13 of 13 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.06s]
[0m13:50:57.893437 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:50:57.894465 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:57.895481 [debug] [MainThread]: On master: BEGIN
[0m13:50:57.895481 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:57.930053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:50:57.930053 [debug] [MainThread]: On master: COMMIT
[0m13:50:57.931052 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:57.931052 [debug] [MainThread]: On master: COMMIT
[0m13:50:57.931052 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:50:57.932049 [debug] [MainThread]: On master: Close
[0m13:50:57.932049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:57.933053 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:50:57.933053 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:50:57.933053 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:50:57.933053 [info ] [MainThread]: 
[0m13:50:57.934054 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m13:50:57.938051 [debug] [MainThread]: Command end result
[0m13:50:57.973043 [info ] [MainThread]: 
[0m13:50:57.974051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:50:57.975044 [info ] [MainThread]: 
[0m13:50:57.975044 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  syntax error at or near ")"
  LINE 21:   );
             ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:50:57.976052 [info ] [MainThread]: 
[0m13:50:57.977044 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:50:57.979043 [debug] [MainThread]: Command `dbt run` failed at 13:50:57.979043 after 2.69 seconds
[0m13:50:57.979043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5C12ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5EA5A070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD5E129130>]}
[0m13:50:57.979043 [debug] [MainThread]: Flushing usage events
[0m13:51:10.717336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F4EECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C41F58A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3FE6A790>]}


============================== 13:51:10.721861 | c4a42647-87e3-47e3-8ff5-5ff38f65fad3 ==============================
[0m13:51:10.721861 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:51:10.722861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:10.789179 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:51:10.790937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F3C3190>]}
[0m13:51:10.790937 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:51:10.791942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F3C31C0>]}
[0m13:51:10.907446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C41F42D90>]}
[0m13:51:10.946233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F3D68E0>]}
[0m13:51:10.946233 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:51:10.963127 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:51:11.099243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:11.100246 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:51:11.289601 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:51:11.303600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C426A7EE0>]}
[0m13:51:11.397284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42679100>]}
[0m13:51:11.398284 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:51:11.399285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C4268F850>]}
[0m13:51:11.400285 [info ] [MainThread]: 
[0m13:51:11.401284 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:11.406299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:51:11.464660 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:51:11.464660 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:51:11.466168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:11.491140 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:51:11.491140 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:51:11.491140 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:51:11.507855 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:51:11.507855 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:51:11.507855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:11.538511 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.538511 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:51:11.538511 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:11.547018 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:51:11.547018 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:51:11.547018 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:51:11.554523 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:11.554523 [debug] [MainThread]: On master: BEGIN
[0m13:51:11.554523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:11.586381 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.586381 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:11.586381 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:11.601897 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:51:11.601897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C426795E0>]}
[0m13:51:11.601897 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:11.601897 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:11.601897 [debug] [MainThread]: On master: BEGIN
[0m13:51:11.601897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.601897 [debug] [MainThread]: On master: COMMIT
[0m13:51:11.601897 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:11.601897 [debug] [MainThread]: On master: COMMIT
[0m13:51:11.601897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:51:11.601897 [debug] [MainThread]: On master: Close
[0m13:51:11.601897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:11.601897 [info ] [MainThread]: 
[0m13:51:11.612497 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:51:11.613503 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:51:11.614497 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:51:11.614497 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:51:11.622512 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:51:11.623510 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:51:11.661155 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:51:11.662166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.662166 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:51:11.663138 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:51:11.690775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.690775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.690775 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:51:11.701663 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:51:11.708683 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.708683 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:51:11.709683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.754710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.754710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:51:11.755726 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.772870 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:51:11.772870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.772870 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:51:11.774862 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:11.781282 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:51:11.784304 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:51:11.785275 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:51:11.788973 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:11.788973 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:51:11.788973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42AC0610>]}
[0m13:51:11.788973 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.18s]
[0m13:51:11.788973 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:51:11.788973 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:51:11.795522 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:51:11.796536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:51:11.797535 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:51:11.799533 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:51:11.800552 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:51:11.805535 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:51:11.807534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.807534 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:51:11.807534 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:11.836987 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.836987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.836987 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:51:11.847503 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:51:11.847503 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.847503 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:51:11.847503 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.853009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.853009 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:51:11.853009 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.853009 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:51:11.853009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.853009 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:51:11.853009 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:11.853009 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:51:11.853009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:51:11.853009 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:51:11.853009 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:11.853009 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:51:11.853009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42AFACA0>]}
[0m13:51:11.853009 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m13:51:11.868837 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:51:11.868837 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:51:11.870463 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:51:11.871480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:51:11.872469 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:51:11.875542 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.876477 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:51:11.880065 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.882117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.882117 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:51:11.882117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:11.920073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:11.920073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.921087 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:51:11.925726 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:51:11.926872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.926872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:51:11.926872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.926872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.926872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:51:11.933880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:11.936053 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:51:11.936053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.936053 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:51:11.938030 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:11.941037 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:51:11.942057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:51:11.942057 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:51:11.945037 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:11.946052 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:51:11.946052 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42744D90>]}
[0m13:51:11.947557 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:51:11.947951 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:51:11.948952 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:51:11.949960 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:51:11.950959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:51:11.950959 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:51:11.953975 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:51:11.954952 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:51:11.959974 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:51:11.960977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:11.961952 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:51:11.961952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.099636 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.099636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:12.099636 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:51:12.106757 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:51:12.107732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:12.107732 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:51:12.107732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.107732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:12.107732 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:51:12.107732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.107732 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:51:12.107732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:12.107732 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:51:12.117751 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.117751 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:51:12.117751 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:51:12.117751 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:51:12.122772 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.122772 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:51:12.122772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42745430>]}
[0m13:51:12.122772 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.17s]
[0m13:51:12.122772 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:51:12.122772 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:51:12.129830 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:51:12.130837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:51:12.130837 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:51:12.133872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:51:12.134862 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:51:12.139861 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:51:12.140861 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.141863 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:51:12.141863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.170630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.170630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.170630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:51:12.179162 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:51:12.179162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.179162 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:51:12.186667 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.190117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.191123 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:51:12.192115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.193116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:51:12.194114 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.194114 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:51:12.195504 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.197816 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:51:12.197816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:51:12.197816 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:51:12.197816 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.197816 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:51:12.197816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42ACC940>]}
[0m13:51:12.204839 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:51:12.205351 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:51:12.206365 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:51:12.207362 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:51:12.207362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:51:12.208365 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:51:12.211381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.211381 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:51:12.216362 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.216362 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.217380 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:51:12.217380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.253929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.253929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.254953 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:51:12.260800 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:51:12.263800 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.264799 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:51:12.264799 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.268798 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.268798 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:51:12.269807 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.271799 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:51:12.271799 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.271799 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:51:12.273799 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.274258 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:51:12.277287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:51:12.277287 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:51:12.277287 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.281327 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:51:12.282356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C414EA6A0>]}
[0m13:51:12.282356 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m13:51:12.283374 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:51:12.284334 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:51:12.284334 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:51:12.285341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:51:12.285341 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:51:12.288339 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.289356 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:51:12.294356 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.295340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.296342 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:51:12.296342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.330184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.330184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.331178 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:51:12.336704 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:51:12.336704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.336704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:51:12.336704 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.336704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.336704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:51:12.336704 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.336704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:51:12.336704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.336704 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:51:12.347760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.347760 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:51:12.347760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:51:12.347760 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:51:12.352772 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.352772 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:51:12.352772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42B27700>]}
[0m13:51:12.352772 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:51:12.352772 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:51:12.358527 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:51:12.358527 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:51:12.359545 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:51:12.359545 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:51:12.362540 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.363554 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:51:12.367532 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.369537 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.370555 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:51:12.371540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.399585 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.399585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.399585 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:51:12.399585 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:51:12.415923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.415923 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:51:12.415923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.415923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.415923 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:51:12.415923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.415923 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:51:12.415923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.415923 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:51:12.425446 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.425446 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:51:12.425446 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:51:12.425446 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:51:12.431047 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.431047 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:51:12.431047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42BB5790>]}
[0m13:51:12.431047 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.07s]
[0m13:51:12.431047 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:51:12.431047 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:51:12.437039 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:51:12.438056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:51:12.438056 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:51:12.442075 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.442075 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:51:12.447070 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.448044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.448044 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:51:12.448044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.482958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.482958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.484024 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:51:12.484024 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:51:12.484024 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.484024 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:51:12.499649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.501122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.501122 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:51:12.501122 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.501122 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:51:12.501122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.501122 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:51:12.501122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.501122 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:51:12.501122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:51:12.501122 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:51:12.501122 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.501122 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:51:12.515896 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42C3C1C0>]}
[0m13:51:12.515896 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:51:12.515896 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:51:12.518678 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:51:12.518678 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:51:12.519685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:51:12.520684 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:51:12.524707 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.526212 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:51:12.532218 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.533221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.534234 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:51:12.534234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.566660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.566660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.566660 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:51:12.573174 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:51:12.573174 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.573174 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:51:12.582691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.582691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.582691 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:51:12.582691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.582691 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:51:12.582691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.582691 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:51:12.582691 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.582691 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:51:12.582691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:51:12.582691 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:51:12.582691 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.582691 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:51:12.582691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C414EA6A0>]}
[0m13:51:12.582691 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.06s]
[0m13:51:12.598324 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:51:12.600166 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:51:12.601175 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:51:12.602175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:51:12.602175 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:51:12.606636 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.606636 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:51:12.612636 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.613772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.614626 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:51:12.614626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.752889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.752889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.752889 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:51:12.768530 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:51:12.768530 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.768530 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:51:12.768530 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.778574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.778574 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:51:12.778574 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.778574 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:51:12.778574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.778574 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:51:12.784087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.784087 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:51:12.784087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:51:12.784087 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:51:12.784087 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.784087 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:51:12.784087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C424F30D0>]}
[0m13:51:12.784087 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.18s]
[0m13:51:12.784087 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:51:12.784087 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:51:12.795462 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:51:12.796481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:51:12.797479 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:51:12.800479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.800479 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:51:12.804488 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.806479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.806479 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:51:12.807482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:12.843674 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:12.844686 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.844686 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:51:12.852021 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:51:12.855048 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.855048 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:51:12.856050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.857664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.857664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:51:12.857664 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:51:12.857664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:51:12.857664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.857664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:51:12.857664 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:51:12.857664 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:51:12.857664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:51:12.857664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:51:12.857664 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:51:12.857664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:51:12.857664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42CBC5E0>]}
[0m13:51:12.857664 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.06s]
[0m13:51:12.873275 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:51:12.873275 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:51:12.874487 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:51:12.875502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:51:12.875502 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:51:12.879506 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:51:12.879506 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:51:12.884030 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:51:12.885057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:51:12.886045 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:51:12.886045 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:51:13.025677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:51:13.025677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:51:13.025677 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
group by supplier_name
  );
  
[0m13:51:13.025677 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15:     imsr.month,
             ^

[0m13:51:13.025677 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m13:51:13.025677 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:51:13.025677 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     imsr.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:51:13.025677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4a42647-87e3-47e3-8ff5-5ff38f65fad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42AC0250>]}
[0m13:51:13.025677 [error] [Thread-1  ]: 13 of 13 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.15s]
[0m13:51:13.025677 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:51:13.035310 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:13.035310 [debug] [MainThread]: On master: BEGIN
[0m13:51:13.036324 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:13.067375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:51:13.068411 [debug] [MainThread]: On master: COMMIT
[0m13:51:13.068411 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:13.068411 [debug] [MainThread]: On master: COMMIT
[0m13:51:13.069375 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:51:13.069375 [debug] [MainThread]: On master: Close
[0m13:51:13.070381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:13.070381 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:51:13.070381 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:51:13.071379 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:51:13.071379 [info ] [MainThread]: 
[0m13:51:13.072375 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m13:51:13.075375 [debug] [MainThread]: Command end result
[0m13:51:13.104518 [info ] [MainThread]: 
[0m13:51:13.105387 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:51:13.106375 [info ] [MainThread]: 
[0m13:51:13.107501 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.month" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     imsr.month,
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:51:13.108538 [info ] [MainThread]: 
[0m13:51:13.108538 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:51:13.110545 [debug] [MainThread]: Command `dbt run` failed at 13:51:13.110545 after 2.44 seconds
[0m13:51:13.110545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C3F4EECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C42567A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C426C7B80>]}
[0m13:51:13.110545 [debug] [MainThread]: Flushing usage events
[0m13:52:12.926416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C492E1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4BD7CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4BD7CD60>]}


============================== 13:52:12.930414 | 9d7518a8-a30b-44ea-bf70-718a3590581f ==============================
[0m13:52:12.930414 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:52:12.930414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:12.994846 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:52:12.995861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C491B3160>]}
[0m13:52:12.995861 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:52:12.996846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C491B3190>]}
[0m13:52:13.108515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C491A7490>]}
[0m13:52:13.155743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4B2DB670>]}
[0m13:52:13.157095 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:52:13.165109 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:52:13.302029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:52:13.302029 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:52:13.485758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:52:13.499247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C496EB0>]}
[0m13:52:13.579620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C469B50>]}
[0m13:52:13.579620 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:52:13.579620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C496850>]}
[0m13:52:13.592291 [info ] [MainThread]: 
[0m13:52:13.594307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:13.598811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:52:13.651011 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:52:13.651011 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:52:13.651011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:13.698386 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:52:13.698386 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:52:13.698386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:52:13.698386 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:52:13.698386 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:52:13.698386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:13.741683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:52:13.741683 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:52:13.741683 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:52:13.750143 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:52:13.752166 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:52:13.753274 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:52:13.762282 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.762282 [debug] [MainThread]: On master: BEGIN
[0m13:52:13.763295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:13.794476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:13.795475 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.795475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:13.801888 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:52:13.801888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C4478B0>]}
[0m13:52:13.801888 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:13.801888 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.801888 [debug] [MainThread]: On master: BEGIN
[0m13:52:13.801888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:13.801888 [debug] [MainThread]: On master: COMMIT
[0m13:52:13.801888 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:13.801888 [debug] [MainThread]: On master: COMMIT
[0m13:52:13.801888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:13.801888 [debug] [MainThread]: On master: Close
[0m13:52:13.801888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:13.801888 [info ] [MainThread]: 
[0m13:52:13.813665 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:52:13.814685 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:52:13.815656 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:52:13.816658 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:52:13.826216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:52:13.827249 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:52:13.857394 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:52:13.857394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.857394 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:52:13.857394 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:52:13.889491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:13.889491 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.889491 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:52:13.889491 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:52:13.904534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.904534 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:52:13.904534 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:13.941740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.941740 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:52:13.941740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:13.953012 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:52:13.968126 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.968126 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:52:13.968869 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:13.968869 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:52:13.978466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:52:13.978466 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:52:13.978466 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:13.984750 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:52:13.985820 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C8F25E0>]}
[0m13:52:13.986851 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.17s]
[0m13:52:13.987774 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:52:13.988769 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:52:13.988769 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:52:13.989770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:52:13.990764 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:52:13.993763 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:52:13.994788 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:52:13.999766 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:52:14.001758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.001758 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:52:14.002785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.041998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.041998 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.041998 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:52:14.047017 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:52:14.047017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.047017 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:52:14.047017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.047017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.047017 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:52:14.047017 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.047017 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:52:14.047017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.047017 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:52:14.047017 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.062847 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:52:14.062847 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:52:14.062847 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:52:14.062847 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.062847 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:52:14.062847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA03970>]}
[0m13:52:14.062847 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:52:14.072940 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:52:14.072940 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:52:14.072940 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:52:14.075208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:52:14.076221 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:52:14.079236 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.080212 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:52:14.083239 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.084649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.085623 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:52:14.086630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.121016 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.121016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.122116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:52:14.122116 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:52:14.122116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.122116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:52:14.122116 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.122116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.122116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:52:14.122116 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.122116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:52:14.122116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.122116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:52:14.137743 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.137743 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:52:14.142257 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:52:14.142257 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:52:14.142257 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.142257 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:52:14.142257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C536280>]}
[0m13:52:14.142257 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:52:14.142257 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:52:14.142257 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:52:14.150810 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:52:14.151816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:52:14.151816 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:52:14.155453 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:52:14.156436 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:52:14.161453 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:52:14.163430 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.163430 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:52:14.163430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.197949 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.199028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.199028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:52:14.199028 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:52:14.199028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.199028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:52:14.199028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.199028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.199028 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:52:14.199028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.214832 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:52:14.214832 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.214832 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:52:14.214832 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.214832 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:52:14.214832 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:52:14.214832 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:52:14.224848 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.224848 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:52:14.224848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C4B8340>]}
[0m13:52:14.224848 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.07s]
[0m13:52:14.224848 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:52:14.229928 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:52:14.229928 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:52:14.230938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:52:14.231941 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:52:14.234942 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:52:14.235942 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:52:14.239944 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:52:14.240945 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.240945 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:52:14.240945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.275460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.275460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.275460 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:52:14.275460 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:52:14.275460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.275460 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:52:14.275460 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.294641 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.295640 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:52:14.296639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.297630 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:52:14.299132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.299132 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:52:14.300143 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.303032 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:52:14.304036 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:52:14.305045 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:52:14.308036 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.309047 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:52:14.310043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C4B8340>]}
[0m13:52:14.311338 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.08s]
[0m13:52:14.312344 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:52:14.312344 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:52:14.313351 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:52:14.314351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:52:14.314351 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:52:14.317411 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.318737 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:52:14.323743 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.325742 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.326743 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:52:14.326743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.364268 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.364268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.365293 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:52:14.370904 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:52:14.374930 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.374930 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:52:14.375930 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.379459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.379459 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:52:14.380440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.382454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:52:14.382454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.382454 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:52:14.384439 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.386430 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:52:14.387439 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:52:14.388453 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:52:14.390102 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.392452 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:52:14.392452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA0DFD0>]}
[0m13:52:14.393445 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.08s]
[0m13:52:14.394446 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:52:14.395445 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:52:14.395445 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:52:14.396446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:52:14.396446 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:52:14.399446 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.400447 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:52:14.406458 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.407457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.407457 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:52:14.407457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.442609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.442609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.442609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:52:14.442609 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:52:14.442609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.442609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:52:14.442609 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.457302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.457302 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:52:14.457302 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.457302 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:52:14.457302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.457302 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:52:14.457302 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.457302 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:52:14.457302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:52:14.457302 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:52:14.467333 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.467333 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:52:14.467333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C4B26D0>]}
[0m13:52:14.472839 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:52:14.472839 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:52:14.475269 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:52:14.475269 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:52:14.476287 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:52:14.477283 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:52:14.480298 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.481302 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:52:14.486439 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.487424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.487424 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:52:14.488440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.525426 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.525426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.526442 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:52:14.531007 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:52:14.537788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.537788 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:52:14.537788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.542654 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.544154 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:52:14.544154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.546940 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:52:14.546940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.546940 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:52:14.546940 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.546940 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:52:14.546940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:52:14.546940 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:52:14.546940 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.546940 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:52:14.546940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C9A35E0>]}
[0m13:52:14.546940 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.07s]
[0m13:52:14.546940 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:52:14.546940 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:52:14.560521 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:52:14.561528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:52:14.562603 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:52:14.566529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.568529 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:52:14.575044 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.577051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.577051 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:52:14.578124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.607998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.607998 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.607998 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:52:14.623753 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:52:14.623753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.623753 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:52:14.623753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.633829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.633829 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:52:14.633829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.633829 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:52:14.633829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.633829 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:52:14.633829 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.639432 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:52:14.639432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:52:14.642965 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:52:14.642965 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.642965 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:52:14.642965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C9A39A0>]}
[0m13:52:14.642965 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m13:52:14.642965 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:52:14.642965 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:52:14.651621 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:52:14.652628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:52:14.653648 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:52:14.659709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.660634 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:52:14.668634 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.669833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.670637 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:52:14.670637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.698166 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.698166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.698166 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:52:14.714079 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:52:14.714079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.714079 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:52:14.714079 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.724114 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.724114 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:52:14.724114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.724114 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:52:14.729688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.729688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:52:14.729688 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.729688 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:52:14.729688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:52:14.729688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:52:14.729688 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.729688 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:52:14.729688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA277F0>]}
[0m13:52:14.729688 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m13:52:14.729688 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:52:14.743208 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:52:14.743553 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:52:14.744565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:52:14.745580 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:52:14.749596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.750643 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:52:14.754588 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.755560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.755560 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:52:14.756567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.788778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.788778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.788778 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:52:14.788778 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:52:14.788778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.788778 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:52:14.788778 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.804995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.804995 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:52:14.804995 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.804995 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:52:14.804995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.804995 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:52:14.804995 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.804995 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:52:14.804995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:52:14.804995 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:52:14.804995 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.804995 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:52:14.804995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA277F0>]}
[0m13:52:14.804995 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.06s]
[0m13:52:14.804995 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:52:14.820715 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:52:14.821503 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:52:14.822518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:52:14.823192 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:52:14.823801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.823801 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:52:14.831711 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.832759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.833802 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:52:14.833802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.871740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.872745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.873744 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:52:14.880990 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:52:14.880990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.880990 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:52:14.880990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.880990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.880990 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:52:14.894507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:52:14.894507 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:52:14.894507 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.894507 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:52:14.894507 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:52:14.894507 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:52:14.894507 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:52:14.894507 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:52:14.894507 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:52:14.894507 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:52:14.910254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA9F370>]}
[0m13:52:14.910254 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.09s]
[0m13:52:14.910254 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:52:14.910254 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:52:14.913588 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:52:14.914595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:52:14.915595 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:52:14.918606 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:52:14.919606 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:52:14.924149 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:52:14.925142 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:52:14.925142 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:52:14.926145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:52:14.961960 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:52:14.961960 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:52:14.961960 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
group by supplier_name, imsr.month
order by month
  );
  
[0m13:52:14.961960 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "imsr.total_gross_revenue" must appear in the GROUP BY clause or be used in an aggregate function
LINE 16:     imsr.total_gross_revenue
             ^

[0m13:52:14.961960 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: ROLLBACK
[0m13:52:14.961960 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:52:14.967497 [debug] [Thread-1  ]: Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.total_gross_revenue" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 16:     imsr.total_gross_revenue
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:52:14.967497 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d7518a8-a30b-44ea-bf70-718a3590581f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4CA0DFD0>]}
[0m13:52:14.967497 [error] [Thread-1  ]: 13 of 13 ERROR creating sql table model public.datamart_monthly_supplier_gross_revenue  [[31mERROR[0m in 0.05s]
[0m13:52:14.967497 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:52:14.972048 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:14.972048 [debug] [MainThread]: On master: BEGIN
[0m13:52:14.973061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:15.005061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:52:15.006550 [debug] [MainThread]: On master: COMMIT
[0m13:52:15.006550 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:15.006550 [debug] [MainThread]: On master: COMMIT
[0m13:52:15.007562 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:52:15.007562 [debug] [MainThread]: On master: Close
[0m13:52:15.008562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:15.008562 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:52:15.008562 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:52:15.009561 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:52:15.009561 [info ] [MainThread]: 
[0m13:52:15.010561 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m13:52:15.013754 [debug] [MainThread]: Command end result
[0m13:52:15.047477 [info ] [MainThread]: 
[0m13:52:15.048592 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:52:15.049600 [info ] [MainThread]: 
[0m13:52:15.050602 [error] [MainThread]:   Database Error in model datamart_monthly_supplier_gross_revenue (models\marts\datamart_monthly_supplier_gross_revenue.sql)
  column "imsr.total_gross_revenue" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 16:     imsr.total_gross_revenue
               ^
  compiled Code at target\run\dbt_dskola_project\models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:52:15.051598 [info ] [MainThread]: 
[0m13:52:15.051598 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m13:52:15.054018 [debug] [MainThread]: Command `dbt run` failed at 13:52:15.054018 after 2.17 seconds
[0m13:52:15.055027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C492E1C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4C3B5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C4B8B5EB0>]}
[0m13:52:15.055027 [debug] [MainThread]: Flushing usage events
[0m13:54:58.984118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361B3D2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361BD17AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361DE37D00>]}


============================== 13:54:58.984118 | 91aed640-d447-44c1-b86e-41b05bebe6a4 ==============================
[0m13:54:58.984118 [info ] [MainThread]: Running with dbt=1.8.2
[0m13:54:58.984118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:59.046933 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:54:59.046933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361B2A3160>]}
[0m13:54:59.046933 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m13:54:59.046933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361B2A3190>]}
[0m13:54:59.154439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361BD391F0>]}
[0m13:54:59.202673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361DE2D730>]}
[0m13:54:59.202673 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m13:54:59.211705 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m13:54:59.341442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:59.357095 [debug] [MainThread]: Partial parsing: updated file: dbt_dskola_project://models\marts\datamart_monthly_supplier_gross_revenue.sql
[0m13:54:59.530707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m13:54:59.554003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E586E20>]}
[0m13:54:59.643876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E56D6A0>]}
[0m13:54:59.643876 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m13:54:59.643876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E1CDA90>]}
[0m13:54:59.650691 [info ] [MainThread]: 
[0m13:54:59.651706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:59.657697 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m13:54:59.716713 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m13:54:59.716713 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m13:54:59.716713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:59.741801 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:54:59.753844 [debug] [ThreadPool]: On list_db_project_2: Close
[0m13:54:59.753844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m13:54:59.753844 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:54:59.753844 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m13:54:59.753844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:59.785246 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:54:59.785246 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m13:54:59.785246 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:59.785246 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m13:54:59.800902 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m13:54:59.800902 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m13:54:59.806915 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.806915 [debug] [MainThread]: On master: BEGIN
[0m13:54:59.806915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:59.832657 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:59.832657 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.832657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:59.848297 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:54:59.848297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361DCEE130>]}
[0m13:54:59.848297 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:59.848297 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.848297 [debug] [MainThread]: On master: BEGIN
[0m13:54:59.848297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:54:59.848297 [debug] [MainThread]: On master: COMMIT
[0m13:54:59.848297 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.848297 [debug] [MainThread]: On master: COMMIT
[0m13:54:59.848297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:54:59.848297 [debug] [MainThread]: On master: Close
[0m13:54:59.848297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:59.848297 [info ] [MainThread]: 
[0m13:54:59.863034 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m13:54:59.864130 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m13:54:59.865027 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m13:54:59.865027 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m13:54:59.873022 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m13:54:59.874550 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m13:54:59.908776 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m13:54:59.909770 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:54:59.910888 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m13:54:59.910888 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m13:54:59.928427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:54:59.928427 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:54:59.928427 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m13:54:59.944827 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m13:54:59.944827 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:54:59.944827 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m13:54:59.944827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:54:59.991409 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:54:59.991409 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m13:54:59.991409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.007555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:55:00.007555 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:55:00.007555 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m13:55:00.017654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.023229 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m13:55:00.023229 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m13:55:00.023229 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m13:55:00.023229 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.023229 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m13:55:00.023229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E9A1550>]}
[0m13:55:00.023229 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.16s]
[0m13:55:00.023229 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m13:55:00.023229 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m13:55:00.023229 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m13:55:00.037951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m13:55:00.038960 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m13:55:00.042957 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m13:55:00.043957 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m13:55:00.047957 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m13:55:00.049957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.049957 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m13:55:00.049957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.087253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.087253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.087253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m13:55:00.087253 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m13:55:00.087253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.087253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m13:55:00.087253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.087253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.087253 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m13:55:00.087253 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.103557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:55:00.103557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.103557 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m13:55:00.103557 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.107569 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m13:55:00.107569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m13:55:00.107569 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m13:55:00.107569 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.107569 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m13:55:00.107569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EA949D0>]}
[0m13:55:00.107569 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.07s]
[0m13:55:00.107569 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m13:55:00.118921 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m13:55:00.118921 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m13:55:00.120924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m13:55:00.120924 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m13:55:00.124922 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.125921 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m13:55:00.130429 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.131429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.132430 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m13:55:00.133430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.162969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.162969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.162969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m13:55:00.179691 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m13:55:00.179691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.179691 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m13:55:00.179691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.188706 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.188706 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m13:55:00.188706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.188706 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:55:00.194213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.194213 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m13:55:00.194213 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.194213 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m13:55:00.194213 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m13:55:00.194213 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m13:55:00.194213 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.194213 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m13:55:00.194213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E5AE850>]}
[0m13:55:00.194213 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.07s]
[0m13:55:00.207720 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m13:55:00.207720 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m13:55:00.208872 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m13:55:00.210561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m13:55:00.210561 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m13:55:00.214591 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m13:55:00.215580 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m13:55:00.222095 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m13:55:00.223089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.223089 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m13:55:00.223089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.267491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.268053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.268053 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m13:55:00.269171 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m13:55:00.269171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.269171 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:55:00.269171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.282707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.283618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:55:00.283618 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.283618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:55:00.283618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.283618 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m13:55:00.283618 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.293151 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m13:55:00.293151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m13:55:00.293151 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m13:55:00.298888 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.299470 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m13:55:00.299470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EA949D0>]}
[0m13:55:00.299470 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.09s]
[0m13:55:00.299470 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m13:55:00.299470 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m13:55:00.303627 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m13:55:00.304651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m13:55:00.305644 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m13:55:00.308305 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m13:55:00.309311 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m13:55:00.314390 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m13:55:00.316330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.316330 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m13:55:00.317333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.352053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.352053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.352053 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m13:55:00.352053 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m13:55:00.352053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.352053 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:55:00.352053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.367936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.367936 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:55:00.367936 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.367936 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:55:00.367936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.367936 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m13:55:00.367936 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.367936 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m13:55:00.367936 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m13:55:00.367936 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m13:55:00.377949 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.377949 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m13:55:00.377949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E3C1520>]}
[0m13:55:00.377949 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m13:55:00.377949 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m13:55:00.383453 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m13:55:00.385253 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m13:55:00.386253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m13:55:00.386253 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m13:55:00.389280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.390279 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m13:55:00.394294 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.395276 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.395276 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m13:55:00.396293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.431360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.431360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.431360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m13:55:00.437390 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m13:55:00.440419 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.441414 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m13:55:00.441414 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.442488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.442488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m13:55:00.442488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.442488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:55:00.442488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.442488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m13:55:00.442488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.442488 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m13:55:00.442488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m13:55:00.442488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m13:55:00.442488 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.442488 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m13:55:00.442488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EAA8A60>]}
[0m13:55:00.442488 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m13:55:00.458259 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m13:55:00.458778 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m13:55:00.459996 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:55:00.461003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m13:55:00.462006 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m13:55:00.465003 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.466025 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m13:55:00.472541 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.473540 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.474523 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m13:55:00.474523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.508900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.509937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.509937 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m13:55:00.510971 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m13:55:00.510971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.510971 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:55:00.510971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.510971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.510971 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:55:00.510971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.510971 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:55:00.510971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.510971 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m13:55:00.510971 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.526908 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m13:55:00.526908 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m13:55:00.526908 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m13:55:00.526908 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.526908 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m13:55:00.526908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E981640>]}
[0m13:55:00.526908 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.07s]
[0m13:55:00.526908 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m13:55:00.526908 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:55:00.536939 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m13:55:00.537983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m13:55:00.537983 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:55:00.540986 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.542987 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:55:00.546999 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.547988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.548988 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m13:55:00.548988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.584651 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.585667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.585667 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m13:55:00.593749 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m13:55:00.593749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.593749 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m13:55:00.593749 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.593749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.593749 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m13:55:00.593749 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.593749 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:55:00.593749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.593749 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m13:55:00.608011 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.609583 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m13:55:00.609583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m13:55:00.609583 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m13:55:00.609583 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.609583 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m13:55:00.609583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E627AC0>]}
[0m13:55:00.618089 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.07s]
[0m13:55:00.618089 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m13:55:00.618089 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:55:00.620630 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m13:55:00.621638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m13:55:00.622657 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m13:55:00.625635 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.626649 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m13:55:00.631653 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.632649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.632649 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m13:55:00.632649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.669525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.670549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.670549 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m13:55:00.683978 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m13:55:00.687009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.688003 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m13:55:00.688003 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.690842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.690842 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m13:55:00.690842 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.690842 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:55:00.690842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.690842 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m13:55:00.690842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.690842 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m13:55:00.690842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m13:55:00.690842 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m13:55:00.690842 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.690842 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m13:55:00.690842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E627AC0>]}
[0m13:55:00.690842 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.07s]
[0m13:55:00.690842 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m13:55:00.690842 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:55:00.706187 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m13:55:00.707308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m13:55:00.707830 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:55:00.712279 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.713358 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:55:00.718263 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.719288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.719288 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m13:55:00.719288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.753404 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.753474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.753474 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m13:55:00.753474 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:55:00.753474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.753474 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m13:55:00.753474 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.769264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.769264 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m13:55:00.769264 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.769264 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:55:00.769264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.769264 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m13:55:00.769264 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.769264 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m13:55:00.769264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m13:55:00.769264 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m13:55:00.779359 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.779359 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m13:55:00.779359 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361E627AC0>]}
[0m13:55:00.779359 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m13:55:00.784877 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m13:55:00.784877 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:55:00.786459 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m13:55:00.786459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m13:55:00.787473 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:55:00.791550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.791550 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:55:00.795930 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.797929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.797929 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m13:55:00.797929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:00.931271 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:00.931271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.931271 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m13:55:00.947508 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:55:00.947508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.947508 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m13:55:00.947508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.947508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.947508 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m13:55:00.947508 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:00.947508 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:55:00.947508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.947508 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m13:55:00.947508 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:00.947508 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m13:55:00.963190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m13:55:00.963190 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m13:55:00.963190 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:00.963190 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m13:55:00.963190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EB37130>]}
[0m13:55:00.963190 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.18s]
[0m13:55:00.963190 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m13:55:00.963190 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:55:00.972176 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m13:55:00.972176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m13:55:00.973682 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:55:00.976712 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:00.977687 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:55:00.981711 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:00.982717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:00.983695 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m13:55:00.983695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:01.010380 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:01.010380 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:01.010380 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m13:55:01.020389 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m13:55:01.025923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:01.025923 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m13:55:01.025923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:01.025923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:01.025923 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m13:55:01.025923 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:01.025923 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:55:01.025923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:01.025923 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m13:55:01.025923 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:01.025923 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m13:55:01.025923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m13:55:01.025923 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m13:55:01.025923 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:01.041575 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m13:55:01.041575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EB37130>]}
[0m13:55:01.041575 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m13:55:01.041575 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m13:55:01.041575 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:55:01.045762 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m13:55:01.046769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m13:55:01.046769 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:55:01.049767 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.050767 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:55:01.055768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.056853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.057769 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m13:55:01.057769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:01.086551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:55:01.086551 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.086551 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
order by company_name desc,  month asc
  );
  
[0m13:55:01.086551 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m13:55:01.086551 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.086551 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:55:01.086551 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:01.102234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.102234 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m13:55:01.102234 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:55:01.102234 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:55:01.102234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.102234 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m13:55:01.108262 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m13:55:01.108262 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m13:55:01.108262 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m13:55:01.108262 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m13:55:01.108262 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:55:01.108262 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m13:55:01.108262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91aed640-d447-44c1-b86e-41b05bebe6a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361EB88430>]}
[0m13:55:01.108262 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.06s]
[0m13:55:01.108262 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m13:55:01.119148 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.120154 [debug] [MainThread]: On master: BEGIN
[0m13:55:01.120154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:01.154617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:55:01.155649 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.155649 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.155649 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.156644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:55:01.156644 [debug] [MainThread]: On master: Close
[0m13:55:01.157645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:01.157645 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m13:55:01.158625 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m13:55:01.158625 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m13:55:01.158625 [info ] [MainThread]: 
[0m13:55:01.159624 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m13:55:01.161617 [debug] [MainThread]: Command end result
[0m13:55:01.196159 [info ] [MainThread]: 
[0m13:55:01.197160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:01.198287 [info ] [MainThread]: 
[0m13:55:01.198414 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m13:55:01.199431 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:01.199431 after 2.26 seconds
[0m13:55:01.200416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361B3D2BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361DE2D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001361D9A4B50>]}
[0m13:55:01.200416 [debug] [MainThread]: Flushing usage events
[0m14:04:29.572110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E745A2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77007AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E770078E0>]}


============================== 14:04:29.572110 | e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db ==============================
[0m14:04:29.572110 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:04:29.577639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'profiles_dir': './', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:04:29.634920 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:04:29.634920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E74473160>]}
[0m14:04:29.634920 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:04:29.640949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E74473190>]}
[0m14:04:29.736416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E76FE9520>]}
[0m14:04:29.783960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77011340>]}
[0m14:04:29.783960 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m14:04:29.802059 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:04:29.935729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:04:29.935729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:04:29.935729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m14:04:29.975277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E775BB130>]}
[0m14:04:30.069093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E765530D0>]}
[0m14:04:30.070098 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m14:04:30.070098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7758E9A0>]}
[0m14:04:30.072350 [info ] [MainThread]: 
[0m14:04:30.073351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:04:30.078887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m14:04:30.135819 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m14:04:30.135819 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m14:04:30.135819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:30.168034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:04:30.178069 [debug] [ThreadPool]: On list_db_project_2: Close
[0m14:04:30.179114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m14:04:30.183654 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m14:04:30.183654 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m14:04:30.183654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:30.215031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.215031 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m14:04:30.215031 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:04:30.225043 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m14:04:30.225043 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m14:04:30.225043 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m14:04:30.231725 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:30.231725 [debug] [MainThread]: On master: BEGIN
[0m14:04:30.231725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:30.262563 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.262563 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:30.262563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:04:30.272568 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:04:30.272568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E76EBEDC0>]}
[0m14:04:30.272568 [debug] [MainThread]: On master: ROLLBACK
[0m14:04:30.272568 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:30.272568 [debug] [MainThread]: On master: BEGIN
[0m14:04:30.272568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.272568 [debug] [MainThread]: On master: COMMIT
[0m14:04:30.278105 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:30.278105 [debug] [MainThread]: On master: COMMIT
[0m14:04:30.278105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.279134 [debug] [MainThread]: On master: Close
[0m14:04:30.279134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:30.279134 [info ] [MainThread]: 
[0m14:04:30.284185 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m14:04:30.285176 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m14:04:30.286184 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m14:04:30.286184 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m14:04:30.293200 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m14:04:30.295200 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m14:04:30.331384 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m14:04:30.332379 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.333395 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m14:04:30.333395 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:04:30.352094 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.352094 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.352094 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m14:04:30.367953 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m14:04:30.379022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.379022 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories" rename to "stg_categories__dbt_backup"
[0m14:04:30.379022 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.379022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.379022 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m14:04:30.383565 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.399266 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m14:04:30.399266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.399266 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m14:04:30.399266 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.399266 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m14:04:30.399266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m14:04:30.399266 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m14:04:30.399266 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:30.415090 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m14:04:30.415090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77A44F70>]}
[0m14:04:30.415090 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.13s]
[0m14:04:30.415090 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m14:04:30.415090 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m14:04:30.421029 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m14:04:30.422045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m14:04:30.422045 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m14:04:30.425567 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m14:04:30.425567 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m14:04:30.430571 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m14:04:30.432582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.432582 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m14:04:30.433585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:30.467826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.467826 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.467826 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m14:04:30.471829 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m14:04:30.479342 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.479342 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees" rename to "stg_employees__dbt_backup"
[0m14:04:30.483360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.483360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.483360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m14:04:30.483360 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.483360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m14:04:30.483360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.483360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m14:04:30.483360 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.483360 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m14:04:30.483360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m14:04:30.483360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m14:04:30.483360 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:30.483360 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m14:04:30.483360 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77B4FF10>]}
[0m14:04:30.498998 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m14:04:30.498998 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m14:04:30.498998 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m14:04:30.502272 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m14:04:30.503279 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m14:04:30.503279 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m14:04:30.507341 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.507341 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m14:04:30.511310 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.512303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.513309 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m14:04:30.513309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:30.640876 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.640876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.640876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m14:04:30.640876 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m14:04:30.657207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.657207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details" rename to "stg_order_details__dbt_backup"
[0m14:04:30.657207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.690666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.690666 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m14:04:30.690666 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.690666 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m14:04:30.690666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.690666 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m14:04:30.704177 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.704177 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m14:04:30.704177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m14:04:30.704177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m14:04:30.704177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:30.704177 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m14:04:30.704177 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77BB6700>]}
[0m14:04:30.704177 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.20s]
[0m14:04:30.704177 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m14:04:30.704177 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m14:04:30.704177 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m14:04:30.717799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m14:04:30.717799 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m14:04:30.721449 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m14:04:30.722450 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m14:04:30.726450 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m14:04:30.727450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.727450 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m14:04:30.728451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:30.767005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.767005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.767987 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m14:04:30.773988 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m14:04:30.777519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.778570 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:04:30.778570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.781190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.781190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:04:30.781190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.781190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m14:04:30.781190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.781190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m14:04:30.781190 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.781190 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m14:04:30.781190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m14:04:30.781190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m14:04:30.781190 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:30.781190 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m14:04:30.781190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77A59FD0>]}
[0m14:04:30.781190 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.06s]
[0m14:04:30.796878 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m14:04:30.796878 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m14:04:30.798812 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m14:04:30.799831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m14:04:30.799831 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m14:04:30.804830 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m14:04:30.805830 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m14:04:30.809833 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m14:04:30.810829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.810829 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m14:04:30.811832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:30.961691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:30.961691 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.961691 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m14:04:30.971698 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m14:04:30.977226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.977226 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:04:30.977226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.980243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.980243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:04:30.980243 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:30.980243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m14:04:30.980243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.980243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m14:04:30.980243 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:30.980243 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m14:04:30.980243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m14:04:30.980243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m14:04:30.980243 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:30.980243 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m14:04:30.993259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77A59FD0>]}
[0m14:04:30.993259 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.19s]
[0m14:04:30.993259 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m14:04:30.993259 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m14:04:30.993259 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m14:04:30.997266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m14:04:30.998274 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m14:04:31.001272 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.002371 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m14:04:31.006285 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.007271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.007271 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m14:04:31.007271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.041834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.042821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.042821 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m14:04:31.048164 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m14:04:31.051225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.051225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers" rename to "stg_shippers__dbt_backup"
[0m14:04:31.051225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.051225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.051225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m14:04:31.051225 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.051225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m14:04:31.051225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.051225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m14:04:31.051225 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.051225 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m14:04:31.051225 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m14:04:31.051225 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m14:04:31.068600 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.069628 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m14:04:31.069628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77A59FD0>]}
[0m14:04:31.070633 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m14:04:31.071605 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m14:04:31.072599 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m14:04:31.073606 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m14:04:31.073606 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m14:04:31.074599 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m14:04:31.077102 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.078107 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m14:04:31.082620 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.083621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.084621 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m14:04:31.084621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.119608 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.120609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.120794 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m14:04:31.124806 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m14:04:31.124806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.124806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m14:04:31.124806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.124806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.124806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m14:04:31.124806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.124806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m14:04:31.136474 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.136991 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m14:04:31.136991 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.136991 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m14:04:31.136991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m14:04:31.136991 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m14:04:31.136991 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.136991 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m14:04:31.136991 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77B4FF10>]}
[0m14:04:31.136991 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.06s]
[0m14:04:31.136991 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m14:04:31.150261 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:04:31.150577 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m14:04:31.151584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m14:04:31.152585 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:04:31.157582 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.158583 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:04:31.163582 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.164582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.165582 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m14:04:31.165582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.202650 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.203649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.203649 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m14:04:31.210990 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m14:04:31.210990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.210990 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue" rename to "int_monthly_employee_revenue__dbt_backup"
[0m14:04:31.210990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.210990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.210990 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m14:04:31.210990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.210990 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m14:04:31.210990 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.210990 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m14:04:31.210990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.227429 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m14:04:31.227429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:04:31.227429 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m14:04:31.227429 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.227429 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m14:04:31.227429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77B4FF10>]}
[0m14:04:31.227429 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.08s]
[0m14:04:31.236935 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:04:31.236935 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m14:04:31.238217 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m14:04:31.238835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m14:04:31.239849 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m14:04:31.242887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.243927 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m14:04:31.247846 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.248865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.249841 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m14:04:31.249841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.285624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.285624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.286628 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m14:04:31.298792 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m14:04:31.301830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.301830 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales" rename to "int_monthly_category_sales__dbt_backup"
[0m14:04:31.301830 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.301830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.301830 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m14:04:31.301830 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.301830 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m14:04:31.301830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.301830 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m14:04:31.301830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.301830 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m14:04:31.301830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:04:31.301830 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m14:04:31.317619 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.317619 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m14:04:31.317619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77B4FF10>]}
[0m14:04:31.317619 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.08s]
[0m14:04:31.317619 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m14:04:31.317619 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:04:31.324396 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m14:04:31.325428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m14:04:31.325428 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:04:31.328939 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.330009 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:04:31.334935 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.336939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.336939 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m14:04:31.337942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.374204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.374204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.374204 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m14:04:31.388590 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m14:04:31.388590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.388590 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue" rename to "int_monthly_supplier_revenue__dbt_backup"
[0m14:04:31.388590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.388590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.388590 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m14:04:31.388590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.388590 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m14:04:31.388590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.388590 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m14:04:31.388590 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.403630 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m14:04:31.403630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:04:31.403630 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m14:04:31.403630 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.403630 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m14:04:31.403630 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77C0E520>]}
[0m14:04:31.403630 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.08s]
[0m14:04:31.403630 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:04:31.403630 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:04:31.413767 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m14:04:31.414792 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m14:04:31.414792 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:04:31.417779 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.418920 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:04:31.422772 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.423773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.424782 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m14:04:31.424782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.460321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.461322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.461322 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m14:04:31.469590 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m14:04:31.472587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.473587 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee" rename to "datamart_monthly_best_employee__dbt_backup"
[0m14:04:31.473587 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.476164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.476164 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m14:04:31.476164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.476164 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m14:04:31.476164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.476164 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m14:04:31.481297 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.481811 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m14:04:31.481811 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:04:31.481811 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m14:04:31.481811 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.481811 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m14:04:31.481811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77C07A60>]}
[0m14:04:31.481811 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.07s]
[0m14:04:31.491878 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:04:31.493614 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:04:31.493614 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m14:04:31.494631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m14:04:31.495789 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:04:31.498817 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.499812 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:04:31.503796 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.504789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.504789 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m14:04:31.504789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.539365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.540367 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.540367 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m14:04:31.547413 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m14:04:31.551466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold" rename to "datamart_monthly_category_sold__dbt_backup"
[0m14:04:31.551466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.551466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m14:04:31.551466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m14:04:31.551466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m14:04:31.551466 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.551466 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m14:04:31.551466 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m14:04:31.551466 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.551466 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m14:04:31.567210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E775E24F0>]}
[0m14:04:31.567715 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m14:04:31.567715 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:04:31.567715 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:04:31.570805 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m14:04:31.571823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m14:04:31.572502 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:04:31.572502 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.572502 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:04:31.580083 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.581080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.582476 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m14:04:31.582476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:04:31.621601 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.622602 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.622602 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
order by company_name desc,  month asc
  );
  
[0m14:04:31.629374 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m14:04:31.633943 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.633943 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue" rename to "datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m14:04:31.635016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.635016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.635016 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m14:04:31.635016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:04:31.635016 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m14:04:31.635016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.635016 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m14:04:31.635016 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.635016 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m14:04:31.635016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:04:31.635016 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m14:04:31.635016 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m14:04:31.635016 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m14:04:31.650665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e43f03c3-ccd1-4654-8b7a-f9f8b2fb30db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E77BFDB20>]}
[0m14:04:31.651157 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.08s]
[0m14:04:31.653171 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:04:31.654157 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:31.655194 [debug] [MainThread]: On master: BEGIN
[0m14:04:31.655477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:04:31.783561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:04:31.783561 [debug] [MainThread]: On master: COMMIT
[0m14:04:31.783561 [debug] [MainThread]: Using postgres connection "master"
[0m14:04:31.783561 [debug] [MainThread]: On master: COMMIT
[0m14:04:31.783561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:04:31.783561 [debug] [MainThread]: On master: Close
[0m14:04:31.783561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:31.783561 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m14:04:31.783561 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m14:04:31.783561 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m14:04:31.783561 [info ] [MainThread]: 
[0m14:04:31.783561 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:04:31.798678 [debug] [MainThread]: Command end result
[0m14:04:31.827228 [info ] [MainThread]: 
[0m14:04:31.827228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:31.828214 [info ] [MainThread]: 
[0m14:04:31.828214 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m14:04:31.830238 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:31.830238 after 2.30 seconds
[0m14:04:31.831212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E745A2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7440BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E775E14F0>]}
[0m14:04:31.831212 [debug] [MainThread]: Flushing usage events
[0m14:11:32.635192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B80DAECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8383BD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B8383BF40>]}


============================== 14:11:32.640374 | 5416b767-ee11-41cb-bb23-02c03eb90e1e ==============================
[0m14:11:32.640374 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:11:32.640374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:32.704219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:32.705442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B80C81370>]}
[0m14:11:32.706452 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:32.707455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B80C813A0>]}
[0m14:11:32.841623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B838DD7F0>]}
[0m14:11:32.878437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B833A6280>]}
[0m14:11:32.878437 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m14:11:32.898248 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:11:33.030628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:33.030628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:33.037148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m14:11:33.068248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83DBE130>]}
[0m14:11:33.093179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83DEAB50>]}
[0m14:11:33.094180 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m14:11:33.094180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83DEAAC0>]}
[0m14:11:33.096374 [info ] [MainThread]: 
[0m14:11:33.097184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:33.102187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m14:11:33.156551 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m14:11:33.156551 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m14:11:33.156551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:33.187945 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:11:33.187945 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m14:11:33.203588 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:33.203588 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m14:11:33.203588 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m14:11:33.203588 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m14:11:33.203588 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:33.203588 [debug] [MainThread]: On master: BEGIN
[0m14:11:33.203588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:33.235646 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:33.235646 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:33.235646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:33.251157 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m14:11:33.251157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5416b767-ee11-41cb-bb23-02c03eb90e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83DEAD30>]}
[0m14:11:33.251157 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:33.251157 [debug] [MainThread]: On master: Close
[0m14:11:33.251157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:33.251157 [info ] [MainThread]: 
[0m14:11:33.267044 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m14:11:33.267906 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m14:11:33.267906 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m14:11:33.274906 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m14:11:33.275906 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m14:11:33.275906 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m14:11:33.277411 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m14:11:33.277411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m14:11:33.278417 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m14:11:33.281417 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m14:11:33.282501 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m14:11:33.283456 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m14:11:33.284485 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m14:11:33.284485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m14:11:33.284485 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m14:11:33.288504 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m14:11:33.290429 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m14:11:33.290429 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m14:11:33.291432 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m14:11:33.292429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m14:11:33.292429 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m14:11:33.295424 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m14:11:33.296426 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m14:11:33.296426 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m14:11:33.297440 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m14:11:33.297440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m14:11:33.298447 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m14:11:33.301427 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m14:11:33.302428 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m14:11:33.303424 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m14:11:33.303424 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m14:11:33.304440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m14:11:33.304440 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m14:11:33.307441 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m14:11:33.308428 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m14:11:33.309450 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m14:11:33.309450 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m14:11:33.309450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m14:11:33.310440 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m14:11:33.313568 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m14:11:33.313568 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m14:11:33.314416 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m14:11:33.314416 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:11:33.315444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m14:11:33.315444 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:11:33.318446 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m14:11:33.319438 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:11:33.319438 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m14:11:33.320441 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m14:11:33.320441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m14:11:33.320441 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m14:11:33.324027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m14:11:33.324027 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m14:11:33.324027 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m14:11:33.324027 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:11:33.324027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m14:11:33.324027 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:11:33.324027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m14:11:33.324027 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:11:33.324027 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m14:11:33.324027 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:11:33.324027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m14:11:33.324027 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:11:33.333277 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m14:11:33.333277 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:11:33.333277 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m14:11:33.333277 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:11:33.333277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m14:11:33.333277 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:11:33.339856 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m14:11:33.339856 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:11:33.339856 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m14:11:33.339856 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:11:33.339856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m14:11:33.339856 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:11:33.339856 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m14:11:33.339856 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:11:33.339856 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m14:11:33.339856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:33.339856 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m14:11:33.339856 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m14:11:33.339856 [debug] [MainThread]: Command end result
[0m14:11:33.580241 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:11:33.580241 [info ] [MainThread]: Building catalog
[0m14:11:33.592403 [debug] [ThreadPool]: Acquiring new postgres connection 'db_project_2.information_schema'
[0m14:11:33.599454 [debug] [ThreadPool]: Using postgres connection "db_project_2.information_schema"
[0m14:11:33.600471 [debug] [ThreadPool]: On db_project_2.information_schema: BEGIN
[0m14:11:33.600471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:33.632998 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:11:33.633514 [debug] [ThreadPool]: Using postgres connection "db_project_2.information_schema"
[0m14:11:33.633514 [debug] [ThreadPool]: On db_project_2.information_schema: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "db_project_2.information_schema"} */

    
    

    select
        'db_project_2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('employees')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_shippers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_monthly_employee_revenue')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_details')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('datamart_monthly_category_sold')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_details')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('datamart_monthly_supplier_gross_revenue')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_monthly_supplier_revenue')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('shippers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('categories')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_monthly_category_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_categories')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_employees')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('datamart_monthly_best_employee')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:11:33.640648 [debug] [ThreadPool]: SQL status: SELECT 110 in 0.0 seconds
[0m14:11:33.642720 [debug] [ThreadPool]: On db_project_2.information_schema: ROLLBACK
[0m14:11:33.642720 [debug] [ThreadPool]: On db_project_2.information_schema: Close
[0m14:11:33.721055 [info ] [MainThread]: Catalog written to E:\Projek\dbt\dbt_project\mini_project_2\dbt_dskola_project\target\catalog.json
[0m14:11:33.723047 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:11:33.723047 after 1.13 seconds
[0m14:11:33.724047 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:11:33.724047 [debug] [MainThread]: Connection 'db_project_2.information_schema' was properly closed.
[0m14:11:33.724047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B80DAECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83BFF250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B83BFF2E0>]}
[0m14:11:33.725047 [debug] [MainThread]: Flushing usage events
[0m14:11:55.652079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2A9AEECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC58ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC58AD30>]}


============================== 14:11:55.658634 | cfc2f703-4002-41eb-9ac8-f2603fc8b93a ==============================
[0m14:11:55.658634 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:11:55.659345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:55.725592 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:55.726574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cfc2f703-4002-41eb-9ac8-f2603fc8b93a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2A99C0220>]}
[0m14:11:55.726574 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:11:55.727571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cfc2f703-4002-41eb-9ac8-f2603fc8b93a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2A99C0250>]}
[0m14:11:55.844245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfc2f703-4002-41eb-9ac8-f2603fc8b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC55DB50>]}
[0m14:11:55.890656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfc2f703-4002-41eb-9ac8-f2603fc8b93a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2ABAB3490>]}
[0m14:13:58.376420 [error] [MainThread]: Encountered an error:

[0m14:13:58.429775 [error] [MainThread]: Traceback (most recent call last):
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
  File "c:\users\acer\appdata\local\programs\python\python39\lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "c:\users\acer\appdata\local\programs\python\python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "c:\users\acer\appdata\local\programs\python\python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m14:13:58.434110 [debug] [MainThread]: Command `dbt docs serve` failed at 14:13:58.434110 after 122.82 seconds
[0m14:13:58.435100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2A9AEECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC985970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E2AC9856A0>]}
[0m14:13:58.435100 [debug] [MainThread]: Flushing usage events
[0m21:00:01.741620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EF1ED00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B219B6D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B219B6CD0>]}


============================== 21:00:01.748873 | 04a8c165-0a97-4c0b-a506-2cf0c9026ffe ==============================
[0m21:00:01.748873 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:00:01.749850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir ./ --project-dir dbt_dskola_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:01.776859 [info ] [MainThread]: dbt version: 1.8.2
[0m21:00:01.777866 [info ] [MainThread]: python version: 3.9.0
[0m21:00:01.779371 [info ] [MainThread]: python path: c:\users\acer\appdata\local\programs\python\python39\python.exe
[0m21:00:01.780388 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m21:00:01.865203 [info ] [MainThread]: Using profiles dir at ./
[0m21:00:01.865203 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m21:00:01.866204 [info ] [MainThread]: Using dbt_project.yml file at dbt_dskola_project\dbt_project.yml
[0m21:00:01.868201 [info ] [MainThread]: adapter type: postgres
[0m21:00:01.869204 [info ] [MainThread]: adapter version: 1.8.1
[0m21:00:01.874729 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:00:01.875727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '04a8c165-0a97-4c0b-a506-2cf0c9026ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EE82190>]}
[0m21:00:01.876727 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:00:01.877720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '04a8c165-0a97-4c0b-a506-2cf0c9026ffe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EE821C0>]}
[0m21:00:01.959103 [info ] [MainThread]: Configuration:
[0m21:00:01.959103 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:00:01.959103 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:00:01.959103 [info ] [MainThread]: Required dependencies:
[0m21:00:01.965615 [debug] [MainThread]: Executing "git --help"
[0m21:00:02.005019 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:00:02.005019 [debug] [MainThread]: STDERR: "b''"
[0m21:00:02.006113 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:00:02.007013 [info ] [MainThread]: Connection:
[0m21:00:02.007013 [info ] [MainThread]:   host: localhost
[0m21:00:02.008020 [info ] [MainThread]:   port: 5432
[0m21:00:02.008020 [info ] [MainThread]:   user: postgres
[0m21:00:02.009022 [info ] [MainThread]:   database: db_project_2
[0m21:00:02.009022 [info ] [MainThread]:   schema: public
[0m21:00:02.010020 [info ] [MainThread]:   connect_timeout: 10
[0m21:00:02.011020 [info ] [MainThread]:   role: None
[0m21:00:02.011020 [info ] [MainThread]:   search_path: None
[0m21:00:02.011020 [info ] [MainThread]:   keepalives_idle: 0
[0m21:00:02.012019 [info ] [MainThread]:   sslmode: None
[0m21:00:02.012019 [info ] [MainThread]:   sslcert: None
[0m21:00:02.013023 [info ] [MainThread]:   sslkey: None
[0m21:00:02.014026 [info ] [MainThread]:   sslrootcert: None
[0m21:00:02.014026 [info ] [MainThread]:   application_name: dbt
[0m21:00:02.015023 [info ] [MainThread]:   retries: 1
[0m21:00:02.015023 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m21:00:02.016537 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:00:03.766404 [debug] [MainThread]: Using postgres connection "debug"
[0m21:00:03.766404 [debug] [MainThread]: On debug: select 1 as id
[0m21:00:03.766404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:03.800636 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:00:03.800636 [debug] [MainThread]: On debug: Close
[0m21:00:03.800636 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:00:03.800636 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:00:03.816429 [debug] [MainThread]: Command `dbt debug` succeeded at 21:00:03.816429 after 2.12 seconds
[0m21:00:03.817744 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:00:03.818753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EF1ED00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EE39F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B1EE82D60>]}
[0m21:00:03.818753 [debug] [MainThread]: Flushing usage events
[0m21:00:13.511252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEF31C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C19CBE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C19CBD60>]}


============================== 21:00:13.521290 | 8c0765c5-065c-4ea8-8902-ba0c868ea683 ==============================
[0m21:00:13.521290 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:00:13.521290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:13.585135 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:00:13.585135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEE01160>]}
[0m21:00:13.585135 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:00:13.588065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEE01190>]}
[0m21:00:13.701165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEDF7490>]}
[0m21:00:13.748581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C0F2B670>]}
[0m21:00:13.748581 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m21:00:13.760713 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:00:13.908495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:13.908495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:13.918512 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m21:00:13.950984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C1F4B130>]}
[0m21:00:14.043919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C1F73880>]}
[0m21:00:14.043919 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m21:00:14.043919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C1F675B0>]}
[0m21:00:14.049765 [info ] [MainThread]: 
[0m21:00:14.050787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:00:14.056783 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m21:00:14.114613 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m21:00:14.114613 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m21:00:14.114613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:14.145826 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:00:14.145826 [debug] [ThreadPool]: On list_db_project_2: Close
[0m21:00:14.157840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m21:00:14.161996 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:00:14.161996 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m21:00:14.161996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:14.193191 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.193191 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:00:14.193191 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:00:14.193191 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:00:14.193191 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m21:00:14.193191 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m21:00:14.208923 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.208923 [debug] [MainThread]: On master: BEGIN
[0m21:00:14.208923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:14.240120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.240120 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.240120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:00:14.240120 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:00:14.240120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEE463A0>]}
[0m21:00:14.240120 [debug] [MainThread]: On master: ROLLBACK
[0m21:00:14.240120 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.240120 [debug] [MainThread]: On master: BEGIN
[0m21:00:14.240120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.240120 [debug] [MainThread]: On master: COMMIT
[0m21:00:14.240120 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.240120 [debug] [MainThread]: On master: COMMIT
[0m21:00:14.240120 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:14.240120 [debug] [MainThread]: On master: Close
[0m21:00:14.240120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:00:14.255726 [info ] [MainThread]: 
[0m21:00:14.262504 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m21:00:14.262504 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m21:00:14.263511 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m21:00:14.264511 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m21:00:14.273020 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m21:00:14.275020 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m21:00:14.312103 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m21:00:14.313107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:00:14.314032 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m21:00:14.314032 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:00:14.336688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.336688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:00:14.336688 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m21:00:14.336688 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.categories" does not exist
LINE 16:     from "db_project_2"."public"."categories"
                  ^

[0m21:00:14.336688 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: ROLLBACK
[0m21:00:14.352331 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m21:00:14.357838 [debug] [Thread-1  ]: Database Error in model stg_categories (models\staging\stg_categories.sql)
  relation "public.categories" does not exist
  LINE 16:     from "db_project_2"."public"."categories"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m21:00:14.357838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C2396F10>]}
[0m21:00:14.357838 [error] [Thread-1  ]: 1 of 13 ERROR creating sql table model public.stg_categories ................... [[31mERROR[0m in 0.09s]
[0m21:00:14.357838 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m21:00:14.357838 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m21:00:14.357838 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m21:00:14.366126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m21:00:14.366126 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m21:00:14.369874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m21:00:14.370871 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m21:00:14.373872 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m21:00:14.374872 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:00:14.375872 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m21:00:14.375872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.510969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.510969 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:00:14.510969 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m21:00:14.510969 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.employees" does not exist
LINE 18:     from "db_project_2"."public"."employees"
                  ^

[0m21:00:14.520990 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: ROLLBACK
[0m21:00:14.520990 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m21:00:14.520990 [debug] [Thread-1  ]: Database Error in model stg_employees (models\staging\stg_employees.sql)
  relation "public.employees" does not exist
  LINE 18:     from "db_project_2"."public"."employees"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m21:00:14.520990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C2544550>]}
[0m21:00:14.520990 [error] [Thread-1  ]: 2 of 13 ERROR creating sql table model public.stg_employees .................... [[31mERROR[0m in 0.15s]
[0m21:00:14.520990 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m21:00:14.520990 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m21:00:14.526157 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m21:00:14.527172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m21:00:14.527172 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m21:00:14.530173 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m21:00:14.531172 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m21:00:14.536174 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m21:00:14.538164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:00:14.538164 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m21:00:14.539178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.666760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.676305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:00:14.676305 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m21:00:14.676305 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.order_details" does not exist
LINE 20:     from "db_project_2"."public"."order_details"
                  ^

[0m21:00:14.676305 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: ROLLBACK
[0m21:00:14.676305 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m21:00:14.676305 [debug] [Thread-1  ]: Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  relation "public.order_details" does not exist
  LINE 20:     from "db_project_2"."public"."order_details"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m21:00:14.676305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C256BB80>]}
[0m21:00:14.676305 [error] [Thread-1  ]: 3 of 13 ERROR creating sql table model public.stg_order_details ................ [[31mERROR[0m in 0.15s]
[0m21:00:14.681935 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m21:00:14.682450 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m21:00:14.682668 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m21:00:14.683691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m21:00:14.683691 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m21:00:14.687701 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m21:00:14.688683 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m21:00:14.693686 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m21:00:14.694679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:00:14.695686 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m21:00:14.695686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.738786 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.739802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:00:14.739802 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m21:00:14.740776 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.orders" does not exist
LINE 19:     from "db_project_2"."public"."orders"
                  ^

[0m21:00:14.740776 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: ROLLBACK
[0m21:00:14.741784 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m21:00:14.742777 [debug] [Thread-1  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  relation "public.orders" does not exist
  LINE 19:     from "db_project_2"."public"."orders"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m21:00:14.742777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEDDDD30>]}
[0m21:00:14.743782 [error] [Thread-1  ]: 4 of 13 ERROR creating sql table model public.stg_orders ....................... [[31mERROR[0m in 0.06s]
[0m21:00:14.744858 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m21:00:14.746105 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m21:00:14.746105 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m21:00:14.747115 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m21:00:14.747115 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m21:00:14.751111 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m21:00:14.752121 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m21:00:14.756110 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m21:00:14.757110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:00:14.758623 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m21:00:14.759921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.799041 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.800058 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:00:14.800058 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m21:00:14.801060 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.products" does not exist
LINE 21:     from "db_project_2"."public"."products"
                  ^

[0m21:00:14.801060 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: ROLLBACK
[0m21:00:14.802059 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m21:00:14.803041 [debug] [Thread-1  ]: Database Error in model stg_products (models\staging\stg_products.sql)
  relation "public.products" does not exist
  LINE 21:     from "db_project_2"."public"."products"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m21:00:14.804044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C253B310>]}
[0m21:00:14.805042 [error] [Thread-1  ]: 5 of 13 ERROR creating sql table model public.stg_products ..................... [[31mERROR[0m in 0.06s]
[0m21:00:14.805042 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m21:00:14.806169 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m21:00:14.806921 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m21:00:14.807934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m21:00:14.807934 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m21:00:14.810937 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m21:00:14.811958 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m21:00:14.814938 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m21:00:14.816459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:00:14.817478 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m21:00:14.817478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.859648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.859648 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:00:14.860645 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m21:00:14.860645 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.shippers" does not exist
LINE 16:     from "db_project_2"."public"."shippers"
                  ^

[0m21:00:14.861644 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: ROLLBACK
[0m21:00:14.861644 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m21:00:14.863648 [debug] [Thread-1  ]: Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  relation "public.shippers" does not exist
  LINE 16:     from "db_project_2"."public"."shippers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m21:00:14.863648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEDDDD30>]}
[0m21:00:14.864653 [error] [Thread-1  ]: 6 of 13 ERROR creating sql table model public.stg_shippers ..................... [[31mERROR[0m in 0.06s]
[0m21:00:14.865650 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m21:00:14.865650 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m21:00:14.866644 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m21:00:14.867688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m21:00:14.868744 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m21:00:14.870853 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m21:00:14.871854 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m21:00:14.875830 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m21:00:14.876840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:00:14.877831 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m21:00:14.877831 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:00:14.923057 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.924073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:00:14.924073 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m21:00:14.925615 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.suppliers" does not exist
LINE 16:     from "db_project_2"."public"."suppliers"
                  ^

[0m21:00:14.926627 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: ROLLBACK
[0m21:00:14.926627 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m21:00:14.928631 [debug] [Thread-1  ]: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  relation "public.suppliers" does not exist
  LINE 16:     from "db_project_2"."public"."suppliers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m21:00:14.928631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c0765c5-065c-4ea8-8902-ba0c868ea683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7C2532730>]}
[0m21:00:14.929634 [error] [Thread-1  ]: 7 of 13 ERROR creating sql table model public.stg_suppliers .................... [[31mERROR[0m in 0.06s]
[0m21:00:14.930631 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m21:00:14.931620 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:00:14.932533 [info ] [Thread-1  ]: 8 of 13 SKIP relation public.int_monthly_employee_revenue ...................... [[33mSKIP[0m]
[0m21:00:14.933539 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:00:14.933539 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:00:14.934539 [info ] [Thread-1  ]: 9 of 13 SKIP relation public.int_monthly_category_sales ........................ [[33mSKIP[0m]
[0m21:00:14.935547 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:00:14.935547 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:00:14.936550 [info ] [Thread-1  ]: 10 of 13 SKIP relation public.int_monthly_supplier_revenue ..................... [[33mSKIP[0m]
[0m21:00:14.937547 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:00:14.937547 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:00:14.937547 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m21:00:14.938548 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:00:14.939551 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:00:14.939551 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m21:00:14.940553 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:00:14.941552 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:00:14.941552 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m21:00:14.942552 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:00:14.943546 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.944559 [debug] [MainThread]: On master: BEGIN
[0m21:00:14.944559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:00:14.991217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:00:14.991217 [debug] [MainThread]: On master: COMMIT
[0m21:00:14.992245 [debug] [MainThread]: Using postgres connection "master"
[0m21:00:14.992245 [debug] [MainThread]: On master: COMMIT
[0m21:00:14.993207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:00:14.993207 [debug] [MainThread]: On master: Close
[0m21:00:14.994198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:14.994198 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m21:00:14.994198 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m21:00:14.995213 [debug] [MainThread]: Connection 'model.dbt_dskola_project.stg_suppliers' was properly closed.
[0m21:00:14.995213 [info ] [MainThread]: 
[0m21:00:14.996697 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m21:00:14.998703 [debug] [MainThread]: Command end result
[0m21:00:15.089946 [info ] [MainThread]: 
[0m21:00:15.089946 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m21:00:15.089946 [info ] [MainThread]: 
[0m21:00:15.094848 [error] [MainThread]:   Database Error in model stg_categories (models\staging\stg_categories.sql)
  relation "public.categories" does not exist
  LINE 16:     from "db_project_2"."public"."categories"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m21:00:15.095860 [info ] [MainThread]: 
[0m21:00:15.096869 [error] [MainThread]:   Database Error in model stg_employees (models\staging\stg_employees.sql)
  relation "public.employees" does not exist
  LINE 18:     from "db_project_2"."public"."employees"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m21:00:15.097941 [info ] [MainThread]: 
[0m21:00:15.099127 [error] [MainThread]:   Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  relation "public.order_details" does not exist
  LINE 20:     from "db_project_2"."public"."order_details"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m21:00:15.100439 [info ] [MainThread]: 
[0m21:00:15.101446 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  relation "public.orders" does not exist
  LINE 19:     from "db_project_2"."public"."orders"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m21:00:15.101446 [info ] [MainThread]: 
[0m21:00:15.102892 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  relation "public.products" does not exist
  LINE 21:     from "db_project_2"."public"."products"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m21:00:15.103910 [info ] [MainThread]: 
[0m21:00:15.104902 [error] [MainThread]:   Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  relation "public.shippers" does not exist
  LINE 16:     from "db_project_2"."public"."shippers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m21:00:15.107910 [info ] [MainThread]: 
[0m21:00:15.108908 [error] [MainThread]:   Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  relation "public.suppliers" does not exist
  LINE 16:     from "db_project_2"."public"."suppliers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m21:00:15.109900 [info ] [MainThread]: 
[0m21:00:15.111911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=6 TOTAL=13
[0m21:00:15.113973 [debug] [MainThread]: Command `dbt run` failed at 21:00:15.112962 after 1.64 seconds
[0m21:00:15.114968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEF31C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEDDDDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7BEDDD820>]}
[0m21:00:15.114968 [debug] [MainThread]: Flushing usage events
[0m21:53:26.227737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC1EECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AEC58A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243ACB6A790>]}


============================== 21:53:26.227737 | b6de55d9-be30-43fb-a7a6-ba8aa6a19cca ==============================
[0m21:53:26.227737 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:53:26.243385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'version_check': 'True', 'profiles_dir': './', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:53:26.311967 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:53:26.311967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC0C0190>]}
[0m21:53:26.311967 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:53:26.318238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC0C01C0>]}
[0m21:53:26.442848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AEC42D90>]}
[0m21:53:26.488219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC0D58E0>]}
[0m21:53:26.490046 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m21:53:26.498248 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:53:26.627505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:26.627505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:26.643145 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m21:53:26.675469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF20B130>]}
[0m21:53:26.772793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF232250>]}
[0m21:53:26.772793 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m21:53:26.772793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF227670>]}
[0m21:53:26.779347 [info ] [MainThread]: 
[0m21:53:26.780369 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:53:26.787360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m21:53:26.849930 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m21:53:26.849930 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m21:53:26.849930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:26.881391 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:53:26.897029 [debug] [ThreadPool]: On list_db_project_2: Close
[0m21:53:26.897775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m21:53:26.897775 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:53:26.897775 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m21:53:26.897775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:26.928534 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:53:26.928534 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:53:26.928534 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:53:26.928534 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m21:53:26.944165 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m21:53:26.944165 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m21:53:26.944165 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:26.944165 [debug] [MainThread]: On master: BEGIN
[0m21:53:26.944165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:53:26.975549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:26.975549 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:26.975549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:53:26.991185 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:53:26.991185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AEB10130>]}
[0m21:53:26.991185 [debug] [MainThread]: On master: ROLLBACK
[0m21:53:26.991185 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:26.991185 [debug] [MainThread]: On master: BEGIN
[0m21:53:26.991185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:26.991185 [debug] [MainThread]: On master: COMMIT
[0m21:53:26.991185 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:26.991185 [debug] [MainThread]: On master: COMMIT
[0m21:53:26.991185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:53:26.991185 [debug] [MainThread]: On master: Close
[0m21:53:26.991185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:53:26.991185 [info ] [MainThread]: 
[0m21:53:27.003434 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m21:53:27.003434 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m21:53:27.004432 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m21:53:27.004432 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m21:53:27.012160 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m21:53:27.013156 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m21:53:27.048677 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m21:53:27.049676 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:53:27.049676 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m21:53:27.050680 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:53:27.079609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.079609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:53:27.079609 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m21:53:27.095850 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m21:53:27.101423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:53:27.102428 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m21:53:27.103434 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.119455 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m21:53:27.119455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:53:27.119455 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m21:53:27.121498 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.126970 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m21:53:27.130988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:53:27.130988 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m21:53:27.132035 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.133976 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m21:53:27.135976 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF6ABE80>]}
[0m21:53:27.135976 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.13s]
[0m21:53:27.136976 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m21:53:27.137977 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m21:53:27.138990 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m21:53:27.138990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m21:53:27.139977 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m21:53:27.142989 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m21:53:27.143988 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m21:53:27.149977 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m21:53:27.150976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:53:27.151990 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m21:53:27.151990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.178394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.178394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:53:27.178394 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m21:53:27.194020 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m21:53:27.194020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:53:27.194020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m21:53:27.194020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.194020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m21:53:27.194020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:53:27.194020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m21:53:27.194020 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.194020 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m21:53:27.194020 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:53:27.194020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m21:53:27.194020 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.194020 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m21:53:27.194020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF6AB2E0>]}
[0m21:53:27.194020 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m21:53:27.210275 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m21:53:27.210275 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m21:53:27.211350 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m21:53:27.212356 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m21:53:27.213356 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m21:53:27.213610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.213610 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m21:53:27.221073 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.222061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.222061 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m21:53:27.223075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.256670 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.257700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.257700 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m21:53:27.261837 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m21:53:27.261837 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.261837 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m21:53:27.261837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.269400 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m21:53:27.270419 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.270419 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m21:53:27.271921 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.273953 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m21:53:27.274959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:53:27.274959 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m21:53:27.274959 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.276948 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m21:53:27.276948 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF7D41F0>]}
[0m21:53:27.277932 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m21:53:27.278947 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m21:53:27.278947 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m21:53:27.279933 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m21:53:27.280935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m21:53:27.280935 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m21:53:27.283951 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m21:53:27.284932 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m21:53:27.326886 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m21:53:27.326886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:53:27.326886 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m21:53:27.326886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.377931 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.377931 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:53:27.377931 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m21:53:27.383465 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m21:53:27.383465 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:53:27.383465 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:53:27.383465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.383465 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m21:53:27.383465 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:53:27.383465 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m21:53:27.383465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.383465 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m21:53:27.383465 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:53:27.383465 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m21:53:27.383465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.399124 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m21:53:27.399124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF7E8880>]}
[0m21:53:27.399124 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.12s]
[0m21:53:27.399124 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m21:53:27.399124 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m21:53:27.403360 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m21:53:27.404369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m21:53:27.404369 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m21:53:27.407393 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m21:53:27.408365 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m21:53:27.412417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m21:53:27.413399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:53:27.413399 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m21:53:27.413399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.450172 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.450172 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:53:27.451196 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m21:53:27.457241 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m21:53:27.460276 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:53:27.461270 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:53:27.461270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.463247 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m21:53:27.464278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:53:27.464278 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m21:53:27.465538 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.467574 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m21:53:27.468566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:53:27.468566 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m21:53:27.469542 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.470544 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m21:53:27.471543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AE1E96A0>]}
[0m21:53:27.471543 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.07s]
[0m21:53:27.472552 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m21:53:27.473581 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m21:53:27.473581 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m21:53:27.474580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m21:53:27.474580 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m21:53:27.478591 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.479589 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m21:53:27.483604 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.484582 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.484582 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m21:53:27.485582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.520704 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.520704 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.521718 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m21:53:27.527265 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m21:53:27.531422 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.531422 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m21:53:27.532409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.533430 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m21:53:27.534408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.534408 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m21:53:27.535712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.537717 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m21:53:27.538717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:53:27.538717 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m21:53:27.539531 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.539531 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m21:53:27.539531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF61F970>]}
[0m21:53:27.539531 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.06s]
[0m21:53:27.539531 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m21:53:27.539531 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m21:53:27.539531 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m21:53:27.539531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m21:53:27.539531 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m21:53:27.548489 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.549487 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m21:53:27.553492 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.554486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.554486 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m21:53:27.555482 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.588101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.588101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.588101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m21:53:27.588101 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m21:53:27.588101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.588101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m21:53:27.588101 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.588101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m21:53:27.588101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.588101 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m21:53:27.603116 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.603116 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m21:53:27.603116 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:53:27.603116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m21:53:27.603116 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.603116 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m21:53:27.603116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF7E8880>]}
[0m21:53:27.603116 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.06s]
[0m21:53:27.603116 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m21:53:27.603116 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:53:27.613985 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m21:53:27.614992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m21:53:27.614992 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:53:27.619177 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.619706 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:53:27.623722 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.624753 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.625722 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m21:53:27.625722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.660542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.661551 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.661551 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m21:53:27.664684 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m21:53:27.664684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.664684 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m21:53:27.664684 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.664684 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m21:53:27.664684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.664684 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m21:53:27.680524 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.680524 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m21:53:27.680524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m21:53:27.680524 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m21:53:27.680524 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.680524 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m21:53:27.680524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF799AF0>]}
[0m21:53:27.680524 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.07s]
[0m21:53:27.680524 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:53:27.689234 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:53:27.689234 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m21:53:27.690771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m21:53:27.691789 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m21:53:27.695786 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.696776 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m21:53:27.701878 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.702785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.703788 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m21:53:27.703788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.727741 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.727741 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.727741 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m21:53:27.743421 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m21:53:27.743421 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.743421 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m21:53:27.743421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.743421 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m21:53:27.743421 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.743421 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m21:53:27.743421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.758520 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m21:53:27.758520 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m21:53:27.758520 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m21:53:27.758520 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.758520 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m21:53:27.758520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF7E5C10>]}
[0m21:53:27.758520 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.07s]
[0m21:53:27.758520 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:53:27.758520 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:53:27.766760 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m21:53:27.767767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m21:53:27.768775 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:53:27.769154 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.769154 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:53:27.777710 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.779784 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.780718 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m21:53:27.780718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.814809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.815825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.815825 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m21:53:27.818377 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m21:53:27.828111 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.828111 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m21:53:27.828111 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.828111 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m21:53:27.828111 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.828111 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m21:53:27.834121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.834121 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m21:53:27.834121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m21:53:27.834121 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m21:53:27.834121 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.834121 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m21:53:27.834121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF7E5C10>]}
[0m21:53:27.834121 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m21:53:27.834121 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:53:27.834121 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:53:27.842895 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m21:53:27.843905 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m21:53:27.845011 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:53:27.848130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.849131 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:53:27.856135 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.857132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.858134 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m21:53:27.858134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.879905 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.879905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.879905 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m21:53:27.894916 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:53:27.894916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.894916 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m21:53:27.894916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.894916 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m21:53:27.894916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.894916 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m21:53:27.894916 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.894916 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m21:53:27.894916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m21:53:27.894916 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m21:53:27.910757 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.910757 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m21:53:27.910757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF2D5B20>]}
[0m21:53:27.910757 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.07s]
[0m21:53:27.910757 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:53:27.915073 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:53:27.915073 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m21:53:27.916107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m21:53:27.917079 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:53:27.920101 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.921106 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:53:27.924308 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.926268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.926268 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m21:53:27.926268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:27.956925 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:27.956925 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.956925 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m21:53:27.966953 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m21:53:27.966953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.966953 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m21:53:27.966953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:27.972472 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m21:53:27.972472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.972472 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m21:53:27.972472 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:27.972472 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m21:53:27.972472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m21:53:27.972472 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m21:53:27.972472 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:27.972472 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m21:53:27.972472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AEB091C0>]}
[0m21:53:27.972472 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.06s]
[0m21:53:27.972472 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:53:27.982642 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:53:27.982642 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m21:53:27.983651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m21:53:27.984366 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:53:27.985021 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:27.985021 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:53:27.994842 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:27.996838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:27.996838 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m21:53:27.996838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:28.034535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:53:28.034535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:28.035534 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
order by company_name desc,  month asc
  );
  
[0m21:53:28.040591 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m21:53:28.040591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:28.040591 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m21:53:28.040591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:53:28.040591 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m21:53:28.040591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:28.040591 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m21:53:28.040591 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m21:53:28.040591 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m21:53:28.040591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m21:53:28.040591 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m21:53:28.040591 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m21:53:28.040591 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m21:53:28.056353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6de55d9-be30-43fb-a7a6-ba8aa6a19cca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF838BE0>]}
[0m21:53:28.056353 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.06s]
[0m21:53:28.056353 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:53:28.058798 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:28.059805 [debug] [MainThread]: On master: BEGIN
[0m21:53:28.059805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:53:28.094553 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:53:28.095553 [debug] [MainThread]: On master: COMMIT
[0m21:53:28.095553 [debug] [MainThread]: Using postgres connection "master"
[0m21:53:28.095553 [debug] [MainThread]: On master: COMMIT
[0m21:53:28.096561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:53:28.096561 [debug] [MainThread]: On master: Close
[0m21:53:28.097553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:28.097553 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m21:53:28.097553 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m21:53:28.097553 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m21:53:28.098553 [info ] [MainThread]: 
[0m21:53:28.098553 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m21:53:28.101560 [debug] [MainThread]: Command end result
[0m21:53:28.131500 [info ] [MainThread]: 
[0m21:53:28.132525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:53:28.133513 [info ] [MainThread]: 
[0m21:53:28.133513 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m21:53:28.135508 [debug] [MainThread]: Command `dbt run` succeeded at 21:53:28.135508 after 1.94 seconds
[0m21:53:28.136503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC1EECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AC058AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243AF822F40>]}
[0m21:53:28.136503 [debug] [MainThread]: Flushing usage events
[0m21:54:37.411732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49A081C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49CB1BE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49CB1BD60>]}


============================== 21:54:37.415507 | d8aed2e2-6ae6-4431-8142-c4c8d7a1e416 ==============================
[0m21:54:37.415507 [info ] [MainThread]: Running with dbt=1.8.2
[0m21:54:37.415507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': './', 'log_path': 'dbt_dskola_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:37.478719 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:54:37.479706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F53160>]}
[0m21:54:37.480737 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m21:54:37.480737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F53190>]}
[0m21:54:37.607452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F47490>]}
[0m21:54:37.653555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49C07B670>]}
[0m21:54:37.655558 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m21:54:37.667556 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m21:54:37.781362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:37.781362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:37.797686 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m21:54:37.832538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D09B130>]}
[0m21:54:37.915384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D0C3880>]}
[0m21:54:37.915384 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m21:54:37.915384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D0B75B0>]}
[0m21:54:37.922780 [info ] [MainThread]: 
[0m21:54:37.923791 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:54:37.929356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m21:54:37.980726 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m21:54:37.980726 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m21:54:37.980726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:38.022217 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:54:38.027753 [debug] [ThreadPool]: On list_db_project_2: Close
[0m21:54:38.027753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m21:54:38.031792 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:54:38.031792 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m21:54:38.031792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:38.059546 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.059546 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m21:54:38.059546 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:54:38.069556 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:54:38.069556 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m21:54:38.069556 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m21:54:38.075567 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.075567 [debug] [MainThread]: On master: BEGIN
[0m21:54:38.075567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:38.106935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.106935 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.106935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:54:38.117503 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:54:38.117503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F963A0>]}
[0m21:54:38.117503 [debug] [MainThread]: On master: ROLLBACK
[0m21:54:38.117503 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.117503 [debug] [MainThread]: On master: BEGIN
[0m21:54:38.117503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.122515 [debug] [MainThread]: On master: COMMIT
[0m21:54:38.122515 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.122515 [debug] [MainThread]: On master: COMMIT
[0m21:54:38.122515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:38.122515 [debug] [MainThread]: On master: Close
[0m21:54:38.122515 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:54:38.122515 [info ] [MainThread]: 
[0m21:54:38.129170 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m21:54:38.129170 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m21:54:38.130160 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m21:54:38.131165 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m21:54:38.139689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m21:54:38.140722 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m21:54:38.177937 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m21:54:38.179498 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:54:38.179498 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m21:54:38.179498 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:54:38.195159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.195159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m21:54:38.210956 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m21:54:38.210956 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.categories" does not exist
LINE 16:     from "db_project_2"."public"."categories"
                  ^

[0m21:54:38.210956 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: ROLLBACK
[0m21:54:38.210956 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m21:54:38.220967 [debug] [Thread-1  ]: Database Error in model stg_categories (models\staging\stg_categories.sql)
  relation "public.categories" does not exist
  LINE 16:     from "db_project_2"."public"."categories"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m21:54:38.227140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D4E6F10>]}
[0m21:54:38.227140 [error] [Thread-1  ]: 1 of 13 ERROR creating sql table model public.stg_categories ................... [[31mERROR[0m in 0.09s]
[0m21:54:38.227140 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m21:54:38.227140 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m21:54:38.229455 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m21:54:38.229455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m21:54:38.230460 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m21:54:38.233077 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m21:54:38.233891 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m21:54:38.237904 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m21:54:38.237904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:54:38.238895 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m21:54:38.238895 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.276710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.276710 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m21:54:38.276710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m21:54:38.276710 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.employees" does not exist
LINE 18:     from "db_project_2"."public"."employees"
                  ^

[0m21:54:38.276710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: ROLLBACK
[0m21:54:38.276710 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m21:54:38.276710 [debug] [Thread-1  ]: Database Error in model stg_employees (models\staging\stg_employees.sql)
  relation "public.employees" does not exist
  LINE 18:     from "db_project_2"."public"."employees"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m21:54:38.276710 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D694550>]}
[0m21:54:38.276710 [error] [Thread-1  ]: 2 of 13 ERROR creating sql table model public.stg_employees .................... [[31mERROR[0m in 0.05s]
[0m21:54:38.276710 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m21:54:38.283546 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m21:54:38.283546 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m21:54:38.284560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m21:54:38.285552 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m21:54:38.288560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m21:54:38.289883 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m21:54:38.293891 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m21:54:38.295379 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:54:38.296384 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m21:54:38.296384 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.432368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.432368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m21:54:38.432368 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m21:54:38.432368 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.order_details" does not exist
LINE 20:     from "db_project_2"."public"."order_details"
                  ^

[0m21:54:38.432368 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: ROLLBACK
[0m21:54:38.432368 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m21:54:38.443879 [debug] [Thread-1  ]: Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  relation "public.order_details" does not exist
  LINE 20:     from "db_project_2"."public"."order_details"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m21:54:38.444445 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D6BAB80>]}
[0m21:54:38.444445 [error] [Thread-1  ]: 3 of 13 ERROR creating sql table model public.stg_order_details ................ [[31mERROR[0m in 0.16s]
[0m21:54:38.444445 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m21:54:38.444445 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m21:54:38.447244 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m21:54:38.448270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m21:54:38.448270 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m21:54:38.451299 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m21:54:38.452298 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m21:54:38.457299 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m21:54:38.458315 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:54:38.459299 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m21:54:38.459299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.491653 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.491653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m21:54:38.491653 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m21:54:38.491653 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.orders" does not exist
LINE 19:     from "db_project_2"."public"."orders"
                  ^

[0m21:54:38.491653 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: ROLLBACK
[0m21:54:38.491653 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m21:54:38.491653 [debug] [Thread-1  ]: Database Error in model stg_orders (models\staging\stg_orders.sql)
  relation "public.orders" does not exist
  LINE 19:     from "db_project_2"."public"."orders"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m21:54:38.491653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F2CD30>]}
[0m21:54:38.491653 [error] [Thread-1  ]: 4 of 13 ERROR creating sql table model public.stg_orders ....................... [[31mERROR[0m in 0.04s]
[0m21:54:38.491653 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m21:54:38.491653 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m21:54:38.500870 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m21:54:38.501875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m21:54:38.501875 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m21:54:38.504882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m21:54:38.505906 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m21:54:38.508903 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m21:54:38.509876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:54:38.509876 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m21:54:38.510910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.544953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.545970 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m21:54:38.545970 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m21:54:38.546945 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.products" does not exist
LINE 21:     from "db_project_2"."public"."products"
                  ^

[0m21:54:38.546945 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: ROLLBACK
[0m21:54:38.546945 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m21:54:38.546945 [debug] [Thread-1  ]: Database Error in model stg_products (models\staging\stg_products.sql)
  relation "public.products" does not exist
  LINE 21:     from "db_project_2"."public"."products"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m21:54:38.546945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D68C310>]}
[0m21:54:38.546945 [error] [Thread-1  ]: 5 of 13 ERROR creating sql table model public.stg_products ..................... [[31mERROR[0m in 0.05s]
[0m21:54:38.546945 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m21:54:38.546945 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m21:54:38.551860 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m21:54:38.552866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m21:54:38.552866 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m21:54:38.555896 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m21:54:38.556887 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m21:54:38.560869 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m21:54:38.561870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:54:38.562874 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m21:54:38.562874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.596331 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.597356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m21:54:38.597356 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m21:54:38.598358 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.shippers" does not exist
LINE 16:     from "db_project_2"."public"."shippers"
                  ^

[0m21:54:38.599354 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: ROLLBACK
[0m21:54:38.599354 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m21:54:38.600354 [debug] [Thread-1  ]: Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  relation "public.shippers" does not exist
  LINE 16:     from "db_project_2"."public"."shippers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m21:54:38.601337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F2CD30>]}
[0m21:54:38.602337 [error] [Thread-1  ]: 6 of 13 ERROR creating sql table model public.stg_shippers ..................... [[31mERROR[0m in 0.05s]
[0m21:54:38.602337 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m21:54:38.603393 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m21:54:38.603770 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m21:54:38.604782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m21:54:38.604782 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m21:54:38.607783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m21:54:38.608782 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m21:54:38.611783 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m21:54:38.612783 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:54:38.613791 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m21:54:38.614289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:38.644447 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.644447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m21:54:38.644447 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m21:54:38.644447 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.suppliers" does not exist
LINE 16:     from "db_project_2"."public"."suppliers"
                  ^

[0m21:54:38.644447 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: ROLLBACK
[0m21:54:38.644447 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m21:54:38.644447 [debug] [Thread-1  ]: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  relation "public.suppliers" does not exist
  LINE 16:     from "db_project_2"."public"."suppliers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m21:54:38.644447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8aed2e2-6ae6-4431-8142-c4c8d7a1e416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49D689F70>]}
[0m21:54:38.644447 [error] [Thread-1  ]: 7 of 13 ERROR creating sql table model public.stg_suppliers .................... [[31mERROR[0m in 0.04s]
[0m21:54:38.644447 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m21:54:38.644447 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:54:38.654258 [info ] [Thread-1  ]: 8 of 13 SKIP relation public.int_monthly_employee_revenue ...................... [[33mSKIP[0m]
[0m21:54:38.655266 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m21:54:38.655266 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:54:38.655266 [info ] [Thread-1  ]: 9 of 13 SKIP relation public.int_monthly_category_sales ........................ [[33mSKIP[0m]
[0m21:54:38.657274 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m21:54:38.657274 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:54:38.658265 [info ] [Thread-1  ]: 10 of 13 SKIP relation public.int_monthly_supplier_revenue ..................... [[33mSKIP[0m]
[0m21:54:38.658265 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m21:54:38.659273 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:54:38.660265 [info ] [Thread-1  ]: 11 of 13 SKIP relation public.datamart_monthly_best_employee ................... [[33mSKIP[0m]
[0m21:54:38.661275 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m21:54:38.662264 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:54:38.663264 [info ] [Thread-1  ]: 12 of 13 SKIP relation public.datamart_monthly_category_sold ................... [[33mSKIP[0m]
[0m21:54:38.663264 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m21:54:38.664264 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:54:38.665268 [info ] [Thread-1  ]: 13 of 13 SKIP relation public.datamart_monthly_supplier_gross_revenue .......... [[33mSKIP[0m]
[0m21:54:38.666264 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m21:54:38.667274 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.668271 [debug] [MainThread]: On master: BEGIN
[0m21:54:38.668271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:54:38.706647 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:54:38.707716 [debug] [MainThread]: On master: COMMIT
[0m21:54:38.707716 [debug] [MainThread]: Using postgres connection "master"
[0m21:54:38.707716 [debug] [MainThread]: On master: COMMIT
[0m21:54:38.707716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:54:38.707716 [debug] [MainThread]: On master: Close
[0m21:54:38.707716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:38.707716 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m21:54:38.707716 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m21:54:38.707716 [debug] [MainThread]: Connection 'model.dbt_dskola_project.stg_suppliers' was properly closed.
[0m21:54:38.707716 [info ] [MainThread]: 
[0m21:54:38.707716 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m21:54:38.713851 [debug] [MainThread]: Command end result
[0m21:54:38.786656 [info ] [MainThread]: 
[0m21:54:38.787639 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m21:54:38.788640 [info ] [MainThread]: 
[0m21:54:38.789866 [error] [MainThread]:   Database Error in model stg_categories (models\staging\stg_categories.sql)
  relation "public.categories" does not exist
  LINE 16:     from "db_project_2"."public"."categories"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_categories.sql
[0m21:54:38.790868 [info ] [MainThread]: 
[0m21:54:38.790868 [error] [MainThread]:   Database Error in model stg_employees (models\staging\stg_employees.sql)
  relation "public.employees" does not exist
  LINE 18:     from "db_project_2"."public"."employees"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_employees.sql
[0m21:54:38.793064 [info ] [MainThread]: 
[0m21:54:38.793064 [error] [MainThread]:   Database Error in model stg_order_details (models\staging\stg_order_details.sql)
  relation "public.order_details" does not exist
  LINE 20:     from "db_project_2"."public"."order_details"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_order_details.sql
[0m21:54:38.794063 [info ] [MainThread]: 
[0m21:54:38.795057 [error] [MainThread]:   Database Error in model stg_orders (models\staging\stg_orders.sql)
  relation "public.orders" does not exist
  LINE 19:     from "db_project_2"."public"."orders"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_orders.sql
[0m21:54:38.796056 [info ] [MainThread]: 
[0m21:54:38.797057 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  relation "public.products" does not exist
  LINE 21:     from "db_project_2"."public"."products"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_products.sql
[0m21:54:38.798059 [info ] [MainThread]: 
[0m21:54:38.799219 [error] [MainThread]:   Database Error in model stg_shippers (models\staging\stg_shippers.sql)
  relation "public.shippers" does not exist
  LINE 16:     from "db_project_2"."public"."shippers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_shippers.sql
[0m21:54:38.802279 [info ] [MainThread]: 
[0m21:54:38.804280 [error] [MainThread]:   Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  relation "public.suppliers" does not exist
  LINE 16:     from "db_project_2"."public"."suppliers"
                    ^
  compiled Code at target\run\dbt_dskola_project\models\staging\stg_suppliers.sql
[0m21:54:38.808279 [info ] [MainThread]: 
[0m21:54:38.810722 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=6 TOTAL=13
[0m21:54:38.813722 [debug] [MainThread]: Command `dbt run` failed at 21:54:38.813722 after 1.45 seconds
[0m21:54:38.815718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F49A081C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F2CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F499F2C820>]}
[0m21:54:38.817183 [debug] [MainThread]: Flushing usage events
[0m23:27:22.995869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18782ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A297A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1881AA790>]}


============================== 23:27:23.006064 | a0ef5c21-f063-49a0-ae35-b4d9005f9c45 ==============================
[0m23:27:23.006064 [info ] [MainThread]: Running with dbt=1.8.2
[0m23:27:23.006064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dbt_dskola_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ./ --project-dir dbt_dskola_project', 'send_anonymous_usage_stats': 'True'}
[0m23:27:23.072744 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:27:23.072744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F187701190>]}
[0m23:27:23.072744 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m23:27:23.079579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1877011C0>]}
[0m23:27:23.236171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A282D90>]}
[0m23:27:23.277004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1877178E0>]}
[0m23:27:23.277004 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m23:27:23.290408 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m23:27:23.453354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:23.453354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:23.453354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.dbt_dskola_project
- snapshots.dbt_dskola_project
[0m23:27:23.494194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A84B130>]}
[0m23:27:23.595818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A873250>]}
[0m23:27:23.595818 [info ] [MainThread]: Found 13 models, 7 sources, 413 macros
[0m23:27:23.595818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A867670>]}
[0m23:27:23.605825 [info ] [MainThread]: 
[0m23:27:23.606842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:27:23.612841 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2'
[0m23:27:23.715896 [debug] [ThreadPool]: Using postgres connection "list_db_project_2"
[0m23:27:23.715896 [debug] [ThreadPool]: On list_db_project_2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2"} */

    select distinct nspname from pg_namespace
  
[0m23:27:23.715896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:23.747057 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m23:27:23.747057 [debug] [ThreadPool]: On list_db_project_2: Close
[0m23:27:23.762805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_project_2_public'
[0m23:27:23.762805 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m23:27:23.762805 [debug] [ThreadPool]: On list_db_project_2_public: BEGIN
[0m23:27:23.762805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:27:23.796048 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m23:27:23.796048 [debug] [ThreadPool]: Using postgres connection "list_db_project_2_public"
[0m23:27:23.796048 [debug] [ThreadPool]: On list_db_project_2_public: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "list_db_project_2_public"} */
select
      'db_project_2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'db_project_2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:27:23.796048 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m23:27:23.796048 [debug] [ThreadPool]: On list_db_project_2_public: ROLLBACK
[0m23:27:23.796048 [debug] [ThreadPool]: On list_db_project_2_public: Close
[0m23:27:23.815523 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:23.815523 [debug] [MainThread]: On master: BEGIN
[0m23:27:23.815523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:23.834257 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:23.834257 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:23.834257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:27:23.850626 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m23:27:23.850626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A14F130>]}
[0m23:27:23.850626 [debug] [MainThread]: On master: ROLLBACK
[0m23:27:23.850626 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:23.850626 [debug] [MainThread]: On master: BEGIN
[0m23:27:23.850626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:23.850626 [debug] [MainThread]: On master: COMMIT
[0m23:27:23.850626 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:23.850626 [debug] [MainThread]: On master: COMMIT
[0m23:27:23.850626 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:27:23.850626 [debug] [MainThread]: On master: Close
[0m23:27:23.850626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:27:23.850626 [info ] [MainThread]: 
[0m23:27:23.865494 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_categories
[0m23:27:23.865494 [info ] [Thread-1  ]: 1 of 13 START sql table model public.stg_categories ............................ [RUN]
[0m23:27:23.866410 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_dskola_project.stg_categories'
[0m23:27:23.867409 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_categories
[0m23:27:23.874394 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_categories"
[0m23:27:23.874394 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_categories
[0m23:27:23.909591 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_categories"
[0m23:27:23.909591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m23:27:23.909591 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: BEGIN
[0m23:27:23.909591 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:27:23.941336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:23.941336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m23:27:23.941336 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */

  
    

  create  table "db_project_2"."public"."stg_categories__dbt_tmp"
  
  
    as
  
  (
    with raw_categories as (
    select
        category_id,
        category_name
    from "db_project_2"."public"."categories"
)
select * from raw_categories
  );
  
[0m23:27:23.941336 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0.0 seconds
[0m23:27:23.941336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m23:27:23.941336 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
alter table "db_project_2"."public"."stg_categories__dbt_tmp" rename to "stg_categories"
[0m23:27:23.941336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:23.967136 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m23:27:23.967136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m23:27:23.967136 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: COMMIT
[0m23:27:23.967136 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:23.972712 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_categories__dbt_backup"
[0m23:27:23.972712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_categories"
[0m23:27:23.972712 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_categories"} */
drop table if exists "db_project_2"."public"."stg_categories__dbt_backup" cascade
[0m23:27:23.972712 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:23.972712 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_categories: Close
[0m23:27:23.972712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18ACEBE80>]}
[0m23:27:23.972712 [info ] [Thread-1  ]: 1 of 13 OK created sql table model public.stg_categories ....................... [[32mSELECT 8[0m in 0.11s]
[0m23:27:23.972712 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_categories
[0m23:27:23.972712 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_employees
[0m23:27:23.988722 [info ] [Thread-1  ]: 2 of 13 START sql table model public.stg_employees ............................. [RUN]
[0m23:27:23.989733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_categories, now model.dbt_dskola_project.stg_employees)
[0m23:27:23.990733 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_employees
[0m23:27:23.993746 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_employees"
[0m23:27:23.993746 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_employees
[0m23:27:23.998281 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_employees"
[0m23:27:23.999282 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m23:27:24.000258 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: BEGIN
[0m23:27:24.000258 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.034806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.034806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m23:27:24.034806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */

  
    

  create  table "db_project_2"."public"."stg_employees__dbt_tmp"
  
  
    as
  
  (
    with raw_employees as (
    select
        employee_id,
        first_name,
        last_name,
        (first_name || ' ' || last_name) as employee_name
    from "db_project_2"."public"."employees"
)
select * from raw_employees
  );
  
[0m23:27:24.034806 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.0 seconds
[0m23:27:24.034806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m23:27:24.034806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
alter table "db_project_2"."public"."stg_employees__dbt_tmp" rename to "stg_employees"
[0m23:27:24.034806 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.034806 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m23:27:24.050457 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m23:27:24.051272 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: COMMIT
[0m23:27:24.051272 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.051272 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_employees__dbt_backup"
[0m23:27:24.051272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_employees"
[0m23:27:24.051272 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_employees"} */
drop table if exists "db_project_2"."public"."stg_employees__dbt_backup" cascade
[0m23:27:24.051272 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.051272 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_employees: Close
[0m23:27:24.051272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18ACEB2B0>]}
[0m23:27:24.051272 [info ] [Thread-1  ]: 2 of 13 OK created sql table model public.stg_employees ........................ [[32mSELECT 9[0m in 0.06s]
[0m23:27:24.051272 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_employees
[0m23:27:24.051272 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_order_details
[0m23:27:24.061195 [info ] [Thread-1  ]: 3 of 13 START sql table model public.stg_order_details ......................... [RUN]
[0m23:27:24.062203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_employees, now model.dbt_dskola_project.stg_order_details)
[0m23:27:24.062203 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_order_details
[0m23:27:24.065207 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.066922 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_order_details
[0m23:27:24.069926 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.071927 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.071927 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: BEGIN
[0m23:27:24.071927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.107011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.107011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.108050 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */

  
    

  create  table "db_project_2"."public"."stg_order_details__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_order_details.sql
with raw_order_details as (
    select
        order_id,
        product_id,
        unit_price,
        quantity,
        discount
    from "db_project_2"."public"."order_details"
)
select * from raw_order_details
  );
  
[0m23:27:24.113743 [debug] [Thread-1  ]: SQL status: SELECT 2155 in 0.0 seconds
[0m23:27:24.116741 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.116741 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
alter table "db_project_2"."public"."stg_order_details__dbt_tmp" rename to "stg_order_details"
[0m23:27:24.117822 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.117822 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m23:27:24.117822 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.117822 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: COMMIT
[0m23:27:24.117822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.122350 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_order_details__dbt_backup"
[0m23:27:24.122350 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_order_details"
[0m23:27:24.122350 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_order_details"} */
drop table if exists "db_project_2"."public"."stg_order_details__dbt_backup" cascade
[0m23:27:24.122350 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.122350 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_order_details: Close
[0m23:27:24.122350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18AE141F0>]}
[0m23:27:24.122350 [info ] [Thread-1  ]: 3 of 13 OK created sql table model public.stg_order_details .................... [[32mSELECT 2155[0m in 0.06s]
[0m23:27:24.122350 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_order_details
[0m23:27:24.122350 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_orders
[0m23:27:24.129618 [info ] [Thread-1  ]: 4 of 13 START sql table model public.stg_orders ................................ [RUN]
[0m23:27:24.130633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_order_details, now model.dbt_dskola_project.stg_orders)
[0m23:27:24.130633 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_orders
[0m23:27:24.134658 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_orders"
[0m23:27:24.134658 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_orders
[0m23:27:24.180170 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_orders"
[0m23:27:24.180170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m23:27:24.180170 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: BEGIN
[0m23:27:24.180170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.339003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.339003 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m23:27:24.340014 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */

  
    

  create  table "db_project_2"."public"."stg_orders__dbt_tmp"
  
  
    as
  
  (
    with raw_orders as (
    select
        order_id,
        customer_id,
        employee_id,
        order_date,
        freight
    from "db_project_2"."public"."orders"
)
select * from raw_orders
  );
  
[0m23:27:24.347207 [debug] [Thread-1  ]: SQL status: SELECT 830 in 0.0 seconds
[0m23:27:24.347207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m23:27:24.347207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
alter table "db_project_2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:27:24.347207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.347207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m23:27:24.347207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m23:27:24.347207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: COMMIT
[0m23:27:24.347207 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.347207 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_orders__dbt_backup"
[0m23:27:24.347207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_orders"
[0m23:27:24.347207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_orders"} */
drop table if exists "db_project_2"."public"."stg_orders__dbt_backup" cascade
[0m23:27:24.347207 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.347207 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_orders: Close
[0m23:27:24.347207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18AE27880>]}
[0m23:27:24.347207 [info ] [Thread-1  ]: 4 of 13 OK created sql table model public.stg_orders ........................... [[32mSELECT 830[0m in 0.22s]
[0m23:27:24.347207 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_orders
[0m23:27:24.347207 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_products
[0m23:27:24.362554 [info ] [Thread-1  ]: 5 of 13 START sql table model public.stg_products .............................. [RUN]
[0m23:27:24.363493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_orders, now model.dbt_dskola_project.stg_products)
[0m23:27:24.363493 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_products
[0m23:27:24.366494 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_products"
[0m23:27:24.367496 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_products
[0m23:27:24.371493 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_products"
[0m23:27:24.373026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m23:27:24.373026 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: BEGIN
[0m23:27:24.374035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.407243 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.408251 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m23:27:24.408251 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */

  
    

  create  table "db_project_2"."public"."stg_products__dbt_tmp"
  
  
    as
  
  (
    -- models/staging/stg_products.sql
with raw_products as (
    select
        product_id,
        product_name,
        supplier_id,
        category_id,
        unit_price,
        units_in_stock
    from "db_project_2"."public"."products"
)
select * from raw_products
  );
  
[0m23:27:24.410334 [debug] [Thread-1  ]: SQL status: SELECT 77 in 0.0 seconds
[0m23:27:24.410334 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m23:27:24.410334 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
alter table "db_project_2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m23:27:24.410334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.419840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m23:27:24.419840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m23:27:24.419840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: COMMIT
[0m23:27:24.419840 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.419840 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_products__dbt_backup"
[0m23:27:24.419840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_products"
[0m23:27:24.419840 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_products"} */
drop table if exists "db_project_2"."public"."stg_products__dbt_backup" cascade
[0m23:27:24.419840 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.426345 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_products: Close
[0m23:27:24.426345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1898296A0>]}
[0m23:27:24.426345 [info ] [Thread-1  ]: 5 of 13 OK created sql table model public.stg_products ......................... [[32mSELECT 77[0m in 0.06s]
[0m23:27:24.426345 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_products
[0m23:27:24.426345 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_shippers
[0m23:27:24.430340 [info ] [Thread-1  ]: 6 of 13 START sql table model public.stg_shippers .............................. [RUN]
[0m23:27:24.431345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_products, now model.dbt_dskola_project.stg_shippers)
[0m23:27:24.431345 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_shippers
[0m23:27:24.435368 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.436367 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_shippers
[0m23:27:24.440361 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.442352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.442352 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: BEGIN
[0m23:27:24.442352 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.471909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.471909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.471909 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */

  
    

  create  table "db_project_2"."public"."stg_shippers__dbt_tmp"
  
  
    as
  
  (
    with raw_shippers as (
    select
        shipper_id,
        company_name
    from "db_project_2"."public"."shippers"
)
select * from raw_shippers
  );
  
[0m23:27:24.471909 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.0 seconds
[0m23:27:24.471909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.471909 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
alter table "db_project_2"."public"."stg_shippers__dbt_tmp" rename to "stg_shippers"
[0m23:27:24.471909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.488088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m23:27:24.488088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.488088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: COMMIT
[0m23:27:24.488088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.488088 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_shippers__dbt_backup"
[0m23:27:24.488088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_shippers"
[0m23:27:24.488088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_shippers"} */
drop table if exists "db_project_2"."public"."stg_shippers__dbt_backup" cascade
[0m23:27:24.488088 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.488088 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_shippers: Close
[0m23:27:24.497603 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F189EF1070>]}
[0m23:27:24.497603 [info ] [Thread-1  ]: 6 of 13 OK created sql table model public.stg_shippers ......................... [[32mSELECT 3[0m in 0.07s]
[0m23:27:24.497603 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_shippers
[0m23:27:24.497603 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.stg_suppliers
[0m23:27:24.500786 [info ] [Thread-1  ]: 7 of 13 START sql table model public.stg_suppliers ............................. [RUN]
[0m23:27:24.501808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_shippers, now model.dbt_dskola_project.stg_suppliers)
[0m23:27:24.502792 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.stg_suppliers
[0m23:27:24.504799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.505816 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.stg_suppliers
[0m23:27:24.509791 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.510818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.511820 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: BEGIN
[0m23:27:24.511820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.546535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.546535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.547497 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */

  
    

  create  table "db_project_2"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select
        supplier_id,
        company_name
    from "db_project_2"."public"."suppliers"
)
select * from raw_suppliers
  );
  
[0m23:27:24.548592 [debug] [Thread-1  ]: SQL status: SELECT 29 in 0.0 seconds
[0m23:27:24.548592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.548592 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
alter table "db_project_2"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m23:27:24.548592 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.548592 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m23:27:24.548592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.548592 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: COMMIT
[0m23:27:24.548592 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.548592 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."stg_suppliers__dbt_backup"
[0m23:27:24.548592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.stg_suppliers"
[0m23:27:24.548592 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.stg_suppliers"} */
drop table if exists "db_project_2"."public"."stg_suppliers__dbt_backup" cascade
[0m23:27:24.564448 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.564448 [debug] [Thread-1  ]: On model.dbt_dskola_project.stg_suppliers: Close
[0m23:27:24.564448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F189EF1070>]}
[0m23:27:24.564448 [info ] [Thread-1  ]: 7 of 13 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 29[0m in 0.06s]
[0m23:27:24.564448 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.stg_suppliers
[0m23:27:24.564448 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m23:27:24.569193 [info ] [Thread-1  ]: 8 of 13 START sql table model public.int_monthly_employee_revenue .............. [RUN]
[0m23:27:24.570208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.stg_suppliers, now model.dbt_dskola_project.int_monthly_employee_revenue)
[0m23:27:24.570208 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_employee_revenue
[0m23:27:24.573235 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.574771 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_employee_revenue
[0m23:27:24.577775 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.579804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.580776 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: BEGIN
[0m23:27:24.580776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.611107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.611107 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.611107 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_employee_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        o.employee_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
)
select
    employee_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from order_product
group by employee_id, month
order by month asc
  );
  
[0m23:27:24.621148 [debug] [Thread-1  ]: SQL status: SELECT 108 in 0.0 seconds
[0m23:27:24.626664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.626664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
alter table "db_project_2"."public"."int_monthly_employee_revenue__dbt_tmp" rename to "int_monthly_employee_revenue"
[0m23:27:24.626664 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.626664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m23:27:24.626664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.626664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: COMMIT
[0m23:27:24.626664 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.626664 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup"
[0m23:27:24.626664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_employee_revenue"
[0m23:27:24.626664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_employee_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_employee_revenue__dbt_backup" cascade
[0m23:27:24.626664 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.626664 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_employee_revenue: Close
[0m23:27:24.626664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18A90DA00>]}
[0m23:27:24.626664 [info ] [Thread-1  ]: 8 of 13 OK created sql table model public.int_monthly_employee_revenue ......... [[32mSELECT 108[0m in 0.06s]
[0m23:27:24.626664 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_employee_revenue
[0m23:27:24.626664 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_category_sales
[0m23:27:24.640246 [info ] [Thread-1  ]: 9 of 13 START sql table model public.int_monthly_category_sales ................ [RUN]
[0m23:27:24.641261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_employee_revenue, now model.dbt_dskola_project.int_monthly_category_sales)
[0m23:27:24.641261 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_category_sales
[0m23:27:24.645384 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.645384 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_category_sales
[0m23:27:24.650408 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.651384 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.651384 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: BEGIN
[0m23:27:24.652386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.797435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.797435 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.798444 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */

  
    

  create  table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_category_sales.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.quantity
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_category as (
    select
        op.order_id,
        op.order_date,
        p.category_id,
        op.quantity
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    category_id,
    DATE_PART('month', order_date::date) AS month,
    sum(quantity) as total_quantity
from product_category
group by category_id, month
order by month asc
  );
  
[0m23:27:24.798444 [debug] [Thread-1  ]: SQL status: SELECT 96 in 0.0 seconds
[0m23:27:24.814197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.814197 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
alter table "db_project_2"."public"."int_monthly_category_sales__dbt_tmp" rename to "int_monthly_category_sales"
[0m23:27:24.814197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.814197 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m23:27:24.814197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.814197 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: COMMIT
[0m23:27:24.814197 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.814197 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_category_sales__dbt_backup"
[0m23:27:24.814197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_category_sales"
[0m23:27:24.823793 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_category_sales"} */
drop table if exists "db_project_2"."public"."int_monthly_category_sales__dbt_backup" cascade
[0m23:27:24.823793 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.823793 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_category_sales: Close
[0m23:27:24.823793 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18980BE20>]}
[0m23:27:24.823793 [info ] [Thread-1  ]: 9 of 13 OK created sql table model public.int_monthly_category_sales ........... [[32mSELECT 96[0m in 0.18s]
[0m23:27:24.823793 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_category_sales
[0m23:27:24.823793 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m23:27:24.823793 [info ] [Thread-1  ]: 10 of 13 START sql table model public.int_monthly_supplier_revenue ............. [RUN]
[0m23:27:24.830080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_category_sales, now model.dbt_dskola_project.int_monthly_supplier_revenue)
[0m23:27:24.831070 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m23:27:24.834068 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.837075 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m23:27:24.841092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.842068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.842068 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: BEGIN
[0m23:27:24.843068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.874627 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.874627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.874627 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */

  
    

  create  table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/intermediate/int_monthly_supplier_revenue.sql
with order_product as (
    select
        o.order_id,
        o.order_date,
        od.product_id,
        od.unit_price * od.quantity * (1 - od.discount) as gross_revenue
    from "db_project_2"."public"."stg_orders" o
    join "db_project_2"."public"."stg_order_details" od
    on o.order_id = od.order_id
),
product_supplier as (
    select
        op.order_id,
        op.order_date,
        p.supplier_id,
        op.gross_revenue
    from order_product op
    join "db_project_2"."public"."stg_products" p
    on op.product_id = p.product_id
)
select
    supplier_id,
    DATE_PART('month', order_date::date) AS month,
    sum(gross_revenue) as total_gross_revenue
from product_supplier
group by supplier_id, month
order by month asc
  );
  
[0m23:27:24.874627 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m23:27:24.889662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.889662 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
alter table "db_project_2"."public"."int_monthly_supplier_revenue__dbt_tmp" rename to "int_monthly_supplier_revenue"
[0m23:27:24.889662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.889662 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m23:27:24.889662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.889662 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: COMMIT
[0m23:27:24.889662 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.889662 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup"
[0m23:27:24.889662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.int_monthly_supplier_revenue"
[0m23:27:24.889662 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.int_monthly_supplier_revenue"} */
drop table if exists "db_project_2"."public"."int_monthly_supplier_revenue__dbt_backup" cascade
[0m23:27:24.898672 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.898672 [debug] [Thread-1  ]: On model.dbt_dskola_project.int_monthly_supplier_revenue: Close
[0m23:27:24.898672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18AE33CD0>]}
[0m23:27:24.898672 [info ] [Thread-1  ]: 10 of 13 OK created sql table model public.int_monthly_supplier_revenue ........ [[32mSELECT 338[0m in 0.07s]
[0m23:27:24.898672 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.int_monthly_supplier_revenue
[0m23:27:24.898672 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m23:27:24.903139 [info ] [Thread-1  ]: 11 of 13 START sql table model public.datamart_monthly_best_employee ........... [RUN]
[0m23:27:24.904156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.int_monthly_supplier_revenue, now model.dbt_dskola_project.datamart_monthly_best_employee)
[0m23:27:24.904156 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_best_employee
[0m23:27:24.907771 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.908770 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_best_employee
[0m23:27:24.913772 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.915300 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.915300 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: BEGIN
[0m23:27:24.915300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:24.952023 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:24.952023 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.952023 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_best_employee.sql
with employee_ranked as (
    select
        ie.employee_id,
        e.employee_name,
        ie.month,
        ie.total_gross_revenue,
        row_number() over (partition by ie.month order by ie.total_gross_revenue desc) as rank
    from "db_project_2"."public"."int_monthly_employee_revenue" ie
    join "db_project_2"."public"."stg_employees" e
    on ie.employee_id = e.employee_id
)
select
    employee_name,
    month,
    total_gross_revenue
from employee_ranked
where rank = 1
order by month asc
  );
  
[0m23:27:24.952023 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m23:27:24.952023 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.952023 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
alter table "db_project_2"."public"."datamart_monthly_best_employee__dbt_tmp" rename to "datamart_monthly_best_employee"
[0m23:27:24.952023 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:24.952023 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m23:27:24.952023 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.952023 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: COMMIT
[0m23:27:24.967805 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:24.967805 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup"
[0m23:27:24.967805 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_best_employee"
[0m23:27:24.967805 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_best_employee"} */
drop table if exists "db_project_2"."public"."datamart_monthly_best_employee__dbt_backup" cascade
[0m23:27:24.967805 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:24.967805 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_best_employee: Close
[0m23:27:24.967805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18772DF70>]}
[0m23:27:24.967805 [info ] [Thread-1  ]: 11 of 13 OK created sql table model public.datamart_monthly_best_employee ...... [[32mSELECT 12[0m in 0.06s]
[0m23:27:24.967805 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_best_employee
[0m23:27:24.967805 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m23:27:24.976374 [info ] [Thread-1  ]: 12 of 13 START sql table model public.datamart_monthly_category_sold ........... [RUN]
[0m23:27:24.977881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_best_employee, now model.dbt_dskola_project.datamart_monthly_category_sold)
[0m23:27:24.977881 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_category_sold
[0m23:27:24.981895 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:24.982895 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_category_sold
[0m23:27:24.987315 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:24.988318 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:24.989319 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: BEGIN
[0m23:27:24.990321 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:25.024664 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:25.024664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:25.024664 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_category_sold.sql
with category_ranked as (
    select
        ics.category_id,
        c.category_name,
        ics.month,
        ics.total_quantity,
        row_number() over (partition by ics.month order by ics.total_quantity desc) as rank
    from "db_project_2"."public"."int_monthly_category_sales" ics
    join "db_project_2"."public"."stg_categories" c
    on ics.category_id = c.category_id
)
select
    category_name,
    month,
    total_quantity
from category_ranked
where rank = 1
order by month asc
  );
  
[0m23:27:25.030178 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m23:27:25.030178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:25.030178 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
alter table "db_project_2"."public"."datamart_monthly_category_sold__dbt_tmp" rename to "datamart_monthly_category_sold"
[0m23:27:25.030178 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:25.030178 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m23:27:25.030178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:25.030178 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: COMMIT
[0m23:27:25.030178 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:25.030178 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup"
[0m23:27:25.045838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_category_sold"
[0m23:27:25.045838 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_category_sold"} */
drop table if exists "db_project_2"."public"."datamart_monthly_category_sold__dbt_backup" cascade
[0m23:27:25.045838 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:25.045838 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_category_sold: Close
[0m23:27:25.045838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1876F7C10>]}
[0m23:27:25.045838 [info ] [Thread-1  ]: 12 of 13 OK created sql table model public.datamart_monthly_category_sold ...... [[32mSELECT 12[0m in 0.07s]
[0m23:27:25.045838 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_category_sold
[0m23:27:25.051056 [debug] [Thread-1  ]: Began running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m23:27:25.051056 [info ] [Thread-1  ]: 13 of 13 START sql table model public.datamart_monthly_supplier_gross_revenue .. [RUN]
[0m23:27:25.052092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_dskola_project.datamart_monthly_category_sold, now model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue)
[0m23:27:25.053072 [debug] [Thread-1  ]: Began compiling node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m23:27:25.056072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.056072 [debug] [Thread-1  ]: Began executing node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m23:27:25.062063 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.063074 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.064073 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: BEGIN
[0m23:27:25.064073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:27:25.099069 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m23:27:25.099069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.099069 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */

  
    

  create  table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp"
  
  
    as
  
  (
    -- models/marts/datamart_monthly_supplier_gross_revenue.sql
select
    s.company_name as supplier_name,
    imsr.month,
    imsr.total_gross_revenue
from "db_project_2"."public"."int_monthly_supplier_revenue" imsr
join "db_project_2"."public"."stg_suppliers" s
on imsr.supplier_id = s.supplier_id
order by company_name desc,  month asc
  );
  
[0m23:27:25.099069 [debug] [Thread-1  ]: SQL status: SELECT 338 in 0.0 seconds
[0m23:27:25.099069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.099069 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
alter table "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_tmp" rename to "datamart_monthly_supplier_gross_revenue"
[0m23:27:25.099069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:27:25.113203 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m23:27:25.113719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.113719 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: COMMIT
[0m23:27:25.113719 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m23:27:25.113719 [debug] [Thread-1  ]: Applying DROP to: "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup"
[0m23:27:25.113719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"
[0m23:27:25.113719 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "dbt_dskola_project", "target_name": "dev", "node_id": "model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue"} */
drop table if exists "db_project_2"."public"."datamart_monthly_supplier_gross_revenue__dbt_backup" cascade
[0m23:27:25.113719 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m23:27:25.113719 [debug] [Thread-1  ]: On model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue: Close
[0m23:27:25.113719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ef5c21-f063-49a0-ae35-b4d9005f9c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18AE27880>]}
[0m23:27:25.113719 [info ] [Thread-1  ]: 13 of 13 OK created sql table model public.datamart_monthly_supplier_gross_revenue  [[32mSELECT 338[0m in 0.06s]
[0m23:27:25.113719 [debug] [Thread-1  ]: Finished running node model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue
[0m23:27:25.124734 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:25.124734 [debug] [MainThread]: On master: BEGIN
[0m23:27:25.125735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:27:25.158449 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:27:25.159450 [debug] [MainThread]: On master: COMMIT
[0m23:27:25.159450 [debug] [MainThread]: Using postgres connection "master"
[0m23:27:25.159450 [debug] [MainThread]: On master: COMMIT
[0m23:27:25.160456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:27:25.160456 [debug] [MainThread]: On master: Close
[0m23:27:25.161456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:27:25.161456 [debug] [MainThread]: Connection 'list_db_project_2' was properly closed.
[0m23:27:25.161456 [debug] [MainThread]: Connection 'list_db_project_2_public' was properly closed.
[0m23:27:25.162453 [debug] [MainThread]: Connection 'model.dbt_dskola_project.datamart_monthly_supplier_gross_revenue' was properly closed.
[0m23:27:25.162453 [info ] [MainThread]: 
[0m23:27:25.163450 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m23:27:25.165449 [debug] [MainThread]: Command end result
[0m23:27:25.195903 [info ] [MainThread]: 
[0m23:27:25.196581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:27:25.197602 [info ] [MainThread]: 
[0m23:27:25.197602 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m23:27:25.199129 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:25.199129 after 2.24 seconds
[0m23:27:25.199129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18782ECA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18ADB41F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18AE48FD0>]}
[0m23:27:25.199129 [debug] [MainThread]: Flushing usage events
